{"ast":null,"code":"var _jsxFileName = \"/Users/anukumar/Desktop/Spring2025/local-textsimplification/client/src/components/Main/index.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef, useCallback } from \"react\";\nimport styles from \"./styles.module.css\";\nimport { useNavigate } from \"react-router-dom\";\nimport * as pdfjsLib from \"pdfjs-dist/legacy/build/pdf\";\n// import { BrowserRouter as Router, Routes, Route, useNavigate } from \"react-router-dom\";\nimport { jwtDecode } from \"jwt-decode\";\nimport { calcMetrics } from \"../../utils/textMetrics\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\npdfjsLib.GlobalWorkerOptions.workerSrc = `${process.env.PUBLIC_URL}/pdf.worker.mjs`;\nconst prefsToPlain = prefs => {\n  const sections = [];\n\n  /* ----- 1 Output length ----- */\n  if (prefs.maxWords || prefs.reduction) sections.push(`• Limit final output to **${prefs.maxWords || \"⩓\"} words** ` + `(${prefs.reduction ? `${prefs.reduction}% reduction` : \"no reduction\"}).`);\n\n  /* ----- 2 Reading level ----- */\n  if (prefs.readingLevels.length) sections.push(\"• Writing should suit readers who \" + prefs.readingLevels.join(\", \") + \".\");\n\n  /* ----- 3 Tone ----- */\n  if (prefs.tone) sections.push(`• Use a **${prefs.tone}** tone.`);\n\n  /* ----- 4 Sentence structure ----- */\n  if (prefs.structPrefs.length) sections.push(\"• Structural preferences: \" + prefs.structPrefs.join(\", \") + \".\");\n\n  /* ----- 5 Free text ----- */\n  if (prefs.misc.trim()) sections.push(\"• Additional notes: \" + prefs.misc.trim());\n  return sections.length ? sections.join(\"\\n\") : \"\";\n};\nconst Main = () => {\n  _s();\n  const [inputText, setInputText] = useState(\"\");\n  const [outputText, setOutputText] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n  const [isSubmitted, setIsSubmitted] = useState(false);\n  const [isEditable, setIsEditable] = useState(false); // For toggling edit mode\n  const [uploadedFileName, setUploadedFileName] = useState(\"\"); // State for file name\n  const [isSaveButtonVisible, setIsSaveButtonVisible] = useState(true);\n  const [showSurveyPrompt, setShowSurveyPrompt] = useState(false); // State for survey prompt\n\n  const [documents, setDocuments] = useState([]); // Store user documents\n  const [selectedDocument, setSelectedDocument] = useState(null); // Selected doc\n  const [isSidebarVisible, setIsSidebarVisible] = useState(false); // Sidebar toggle\n\n  const navigate = useNavigate();\n  const [isUploading, setIsUploading] = useState(false); // State for showing buffer\n\n  const user = JSON.parse(localStorage.getItem(\"user\"));\n  const email = user === null || user === void 0 ? void 0 : user.email;\n  const [inputWordCount, setInputWordCount] = useState(0);\n  const [inputCharCount, setInputCharCount] = useState(0);\n  const [pdfPageCount, setPdfPageCount] = useState(0);\n  const inputTextSnapshot = useRef(\"\");\n  const [pdfPath, setPdfPath] = useState(\"\");\n  const [prefsOpen, setPrefsOpen] = useState(false);\n  const [customPrefs, setCustomPrefs] = useState({\n    maxWords: \"\",\n    // number or \"\"\n    reduction: \"\",\n    // \"0\" | \"25\" | \"50\" | …\n    readingLevels: [],\n    // array of strings\n    tone: \"\",\n    // single string\n    structPrefs: [],\n    // array of strings\n    misc: \"\" // free text\n  });\n  const [showCustom, setShowCustom] = useState(false); // accordion open/close\n  const [customLen, setCustomLen] = useState(\"\"); // numeric length, if “Custom”\n  const [extraPrefs, setExtraPrefs] = useState(\"\"); // free‑text box\n\n  const handleLogout = () => {\n    localStorage.removeItem(\"token\");\n    navigate(\"/Login\");\n  };\n  const toggleSet = (key, value) => setCustomPrefs(p => {\n    const list = p[key];\n    return {\n      ...p,\n      [key]: list.includes(value) ? list.filter(v => v !== value) : [...list, value]\n    };\n  });\n\n  // Load user's past documents (original texts only)\n  useEffect(() => {\n    if (!email) return;\n    const fetchDocuments = async () => {\n      try {\n        const response = await fetch(`http://localhost:5001/api/simplifications/user/${email}`);\n        const result = await response.json();\n        if (response.ok) {\n          const sortedDocs = result.data.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));\n          setDocuments(sortedDocs);\n        } else {\n          console.error(\"Error fetching documents:\", result.message);\n        }\n      } catch (error) {\n        console.error(\"Error fetching documents:\", error);\n      }\n    };\n    fetchDocuments();\n  }, [email]);\n\n  // Handle document selection from history\n  const handleDocumentClick = doc => {\n    setSelectedDocument(doc);\n    setInputText(doc.inputText);\n  };\n  const handleFileUpload = async event => {\n    const file = event.target.files[0];\n    setPdfPath(`/uploads/${file.name}`);\n    if (!file) return;\n    setIsUploading(true); // Show buffer while processing\n    setUploadedFileName(file.name); // Set file name\n\n    try {\n      //setUploadedFileName(file.name); // Set the uploaded file name\n      const fileReader = new FileReader();\n      fileReader.onload = async function () {\n        const typedArray = new Uint8Array(this.result);\n        const pdf = await pdfjsLib.getDocument(typedArray).promise;\n        setPdfPageCount(pdf.numPages);\n        let text = \"\";\n\n        // Extract text from all pages\n        for (let i = 1; i <= pdf.numPages; i++) {\n          const page = await pdf.getPage(i);\n          const textContent = await page.getTextContent();\n          text += textContent.items.map(item => item.str).join(\" \");\n        }\n        setInputText(text);\n      };\n      fileReader.readAsArrayBuffer(file);\n    } catch (error) {\n      console.error(\"Error reading PDF:\", error);\n      alert(\"Failed to extract text from the PDF.\");\n    } finally {\n      setIsUploading(false); // Hide buffer once done\n    }\n  };\n  const countWordsAndChars = text => {\n    const words = text.trim().split(/\\s+/).filter(Boolean).length;\n    const chars = text.length;\n    return {\n      words,\n      chars\n    };\n  };\n  useEffect(() => {\n    const {\n      words: inputWords,\n      chars: inputChars\n    } = countWordsAndChars(inputText);\n    setInputWordCount(inputWords);\n    setInputCharCount(inputChars);\n  }, [inputText]);\n  const saveInitialSimplification = async (trimmedInput, cleanedOutput) => {\n    const user = JSON.parse(localStorage.getItem(\"user\"));\n    if (!user) return;\n    await fetch(\"http://localhost:5001/api/simplifications\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        userId: user._id,\n        email,\n        inputText: trimmedInput,\n        outputText: cleanedOutput,\n        pdfName: uploadedFileName || null,\n        pdfPath: pdfPath || null\n      })\n    });\n  };\n  const generatePrompt = useCallback(inputText => {\n    const prefsText = prefsToPlain(customPrefs);\n    return `\n\t\t### USER‑SPECIFIC CUSTOMISATIONS (please follow **strictly**)\n\t\t${prefsText || \"• No special preferences.\"}\n\t\t\n\t\tYou are an expert in accessible communication, tasked with transforming complex text into clear, accessible plain language for individuals with Intellectual and Developmental Disabilities (IDD) or those requiring simplified content. Retain all essential information and intent while prioritizing readability, comprehension, and inclusivity.\n\n\t\tText simplification refers to rewriting or adapting text to make it easier to read and understand while keeping the same level of detail and precision. Make sure you focus on simplification and not summarization. The length of generated output text must be similar to that of input text.\n\n\t\tStick to the provided input text and only simplify the language. Don't provide the answer or hallucinate or provide any irrelevant information, not mentioned in the input text. \n\n\t\tGuidelines for Simplification:\n\t\tVocabulary and Terminology:\n\t\tReplace uncommon, technical, or abstract words with simple, everyday language.\n\t\tDefine unavoidable complex terms in plain language within parentheses upon first use (example: “cardiologist (heart doctor)”).\n\t\tAvoid idioms, metaphors, sarcasm, or culturally specific references.\n\n\t\tSentence Structure:\n\t\tUse short sentences (10--15 words max). Break long sentences into 1–2 ideas each.\n\t\tPrefer active voice (example: “The doctor examined the patient” vs. “The patient was examined by the doctor”).\n\t\tAvoid nested clauses, passive voice, and ambiguous pronouns (example: “they,” “it”).\n\n\t\tClarity and Flow:\n\t\tOrganize content logically, using headings/subheadings to group related ideas.\n\t\tUse bullet points or numbered lists for steps, options, or key points.\n\t\tEnsure each paragraph focuses on one main idea.\n\n\t\tTone and Engagement:\n\t\tWrite in a neutral, conversational tone (avoid formal or academic language).\n\t\tAddress the reader directly with “you” or “we” where appropriate.\n\t\tUse consistent terms for concepts (avoid synonyms that may confuse).\n\n\t\tAvoid Exclusionary Elements:\n\t\tRemove jargon, acronyms (unless defined), and expand abbreviations if needed (example: “ASAP” → “as soon as possible”).\n\t\tEliminate metaphors, idioms, or implied meanings (example: “hit the books” → “study”).\n\t\tAvoid double negatives (example: “not uncommon” → “common”).\n\n\t\tStructural Support:\n\t\tAdd clear headings to label sections (example: “How to Apply for Benefits”).\n\t\tUse formatting tools like bold for key terms or warnings.\n\t\tChunk information into short paragraphs with line breaks for visual ease.\n\n\t\tInclusivity Checks:\n\t\tEnsure content is free of bias, stereotypes, or assumptions about the reader.\n\t\tUse gender-neutral language (example: “they” instead of “he/she”).\n\n\n\t\tOutput Requirements:\n\t\tReturn only the simplified text, without markdown, emojis, or images.\n\t\tPreserve original context, facts, and intent. Do not omit critical details.\n\t\tPrioritize clarity over brevity; focus on simplification and not summarization. The length of generated output text should be same or similar to that of input text.\n\t\tDo not simplify already simple text.\n\n\t\tExample Transformation:\n\t\tOriginal: “Individuals experiencing adverse climatic conditions may necessitate relocation to mitigate health risks.”\n\t\tSimplified: “If weather conditions become dangerous, people might need to move to stay safe.”\n\n\t\tFor the provided input text, apply the above guidelines rigorously. Ensure the output is accessible to readers with varied cognitive abilities, emphasizing clarity, simplicity, and logical structure. Verify that the simplified text aligns with plain language standards like WCAG and PlainLanguage.gov.\n\n\t\t\"${inputText}\"\n\t\t`;\n  }, [customPrefs]);\n  // Function to format the prompt with user input\n  // const generatePrompt = (inputText) => {\n  // \treturn `\n  // \tYou are an expert in accessible communication, tasked with transforming complex text into clear, accessible plain language for individuals with Intellectual and Developmental Disabilities (IDD) or those requiring simplified content. Retain all essential information and intent while prioritizing readability, comprehension, and inclusivity.\n\n  // \tText simplification refers to rewriting or adapting text to make it easier to read and understand while keeping the same level of detail and precision. Make sure you focus on simplification and not summarization. The length of generated output text must be similar to that of input text.\n\n  // \tStick to the provided input text and only simplify the language. Don't provide the answer or hallucinate or provide any irrelevant information, not mentioned in the input text. \n\n  // \tGuidelines for Simplification:\n  // \tVocabulary and Terminology:\n  // \tReplace uncommon, technical, or abstract words with simple, everyday language.\n  // \tDefine unavoidable complex terms in plain language within parentheses upon first use (example: “cardiologist (heart doctor)”).\n  // \tAvoid idioms, metaphors, sarcasm, or culturally specific references.\n\n  // \tSentence Structure:\n  // \tUse short sentences (10--15 words max). Break long sentences into 1–2 ideas each.\n  // \tPrefer active voice (example: “The doctor examined the patient” vs. “The patient was examined by the doctor”).\n  // \tAvoid nested clauses, passive voice, and ambiguous pronouns (example: “they,” “it”).\n\n  // \tClarity and Flow:\n  // \tOrganize content logically, using headings/subheadings to group related ideas.\n  // \tUse bullet points or numbered lists for steps, options, or key points.\n  // \tEnsure each paragraph focuses on one main idea.\n\n  // \tTone and Engagement:\n  // \tWrite in a neutral, conversational tone (avoid formal or academic language).\n  // \tAddress the reader directly with “you” or “we” where appropriate.\n  // \tUse consistent terms for concepts (avoid synonyms that may confuse).\n\n  // \tAvoid Exclusionary Elements:\n  // \tRemove jargon, acronyms (unless defined), and expand abbreviations if needed (example: “ASAP” → “as soon as possible”).\n  // \tEliminate metaphors, idioms, or implied meanings (example: “hit the books” → “study”).\n  // \tAvoid double negatives (example: “not uncommon” → “common”).\n\n  // \tStructural Support:\n  // \tAdd clear headings to label sections (example: “How to Apply for Benefits”).\n  // \tUse formatting tools like bold for key terms or warnings.\n  // \tChunk information into short paragraphs with line breaks for visual ease.\n\n  // \tInclusivity Checks:\n  // \tEnsure content is free of bias, stereotypes, or assumptions about the reader.\n  // \tUse gender-neutral language (example: “they” instead of “he/she”).\n\n  // \tOutput Requirements:\n  // \tReturn only the simplified text, without markdown, emojis, or images.\n  // \tPreserve original context, facts, and intent. Do not omit critical details.\n  // \tPrioritize clarity over brevity; focus on simplification and not summarization. The length of generated output text should be same or similar to that of input text.\n  // \tDo not simplify already simple text.\n\n  // \tExample Transformation:\n  // \tOriginal: “Individuals experiencing adverse climatic conditions may necessitate relocation to mitigate health risks.”\n  // \tSimplified: “If weather conditions become dangerous, people might need to move to stay safe.”\n\n  // \tFor the provided input text, apply the above guidelines rigorously. Ensure the output is accessible to readers with varied cognitive abilities, emphasizing clarity, simplicity, and logical structure. Verify that the simplified text aligns with plain language standards like WCAG and PlainLanguage.gov.\n\n  // \t\"${inputText}\"\n  // \t`;\n  //   };\n\n  const splitTextIntoChunks = (text, maxTokens) => {\n    const words = text.split(\" \");\n    let chunks = [];\n    let currentChunk = [];\n    for (let word of words) {\n      if (currentChunk.join(\" \").length + word.length < maxTokens) {\n        currentChunk.push(word);\n      } else {\n        chunks.push(currentChunk.join(\" \"));\n        currentChunk = [word];\n      }\n    }\n    if (currentChunk.length > 0) chunks.push(currentChunk.join(\" \"));\n    return chunks;\n  };\n  const handleSubmit = async () => {\n    // const inputText = document.getElementById('inputText').value;\n    const trimmedInput = inputText.trim();\n    if (!trimmedInput) return;\n\n    // inputTextSnapshot.current = inputText; \n    setIsLoading(true);\n    try {\n      const chunks = splitTextIntoChunks(trimmedInput, 10000);\n      let combinedOutput = \"\";\n      for (let chunk of chunks) {\n        var _data$response;\n        const prompt = generatePrompt(chunk);\n        const response = await fetch(\"http://localhost:5001/api/gpt4\", {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify({\n            prompt\n          })\n        });\n        if (!response.ok) {\n          console.error(`API request failed with status: ${response.status}`);\n          continue; // Skip this chunk if the API request failed\n        }\n        const data = await response.json();\n        console.log(\"Full API Response: \", data);\n        const data1 = (data === null || data === void 0 ? void 0 : (_data$response = data.response) === null || _data$response === void 0 ? void 0 : _data$response.replace(/^\"|\"$/g, \"\")) || \"No response received.\"; // Append results\n        combinedOutput += data1 + \" \";\n      }\n      console.log(\"Final Combined Output: \", combinedOutput);\n      console.log(\"Data: \", combinedOutput);\n      const cleanedResponse = combinedOutput.trim();\n      setOutputText(cleanedResponse);\n      setIsSubmitted(true);\n      await saveInitialSimplification(trimmedInput, cleanedResponse);\n      navigate(\"/review\", {\n        state: {\n          inputText: trimmedInput,\n          outputText: cleanedResponse\n        }\n      });\n      // navigate(\"/review\", { state: { inputText: trimmedInput, outputText: cleanedResponse } });\n    } catch (error) {\n      console.error(\"Error fetching GPT-4o response:\", error);\n      setOutputText(\"An error occurred while simplifying the text.\");\n    }\n    setIsLoading(false);\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"nav\", {\n      className: styles.navbar,\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        onClick: () => window.location.href = \"http://localhost:5001/\",\n        style: {\n          cursor: \"pointer\"\n        } // Makes it look clickable\n        ,\n        children: \"Text Simplification Tool\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 409,\n        columnNumber: 3\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: styles.white_btn,\n        onClick: handleLogout,\n        children: \"Logout\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 414,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 407,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.container,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: `${styles.sidebar} ${isSidebarVisible ? styles.expanded : \"\"}`,\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: styles.historyIcon,\n          onClick: () => setIsSidebarVisible(!isSidebarVisible),\n          children: [\"\\uD83D\\uDD52   \", /*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              fontSize: \"15px\"\n            },\n            children: \" History \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 433,\n            columnNumber: 10\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 429,\n          columnNumber: 4\n        }, this), isSidebarVisible && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.historyContent,\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: styles.closeButton,\n            onClick: () => setIsSidebarVisible(false),\n            children: \"\\u2716\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 440,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n            className: styles.historyList,\n            children: documents.map((doc, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n              onClick: () => handleDocumentClick(doc),\n              className: `${styles.historyItem} ${(selectedDocument === null || selectedDocument === void 0 ? void 0 : selectedDocument._id) === doc._id ? styles.activeDoc : \"\"}`,\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: [\"Document \", documents.length - index]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 452,\n                columnNumber: 5\n              }, this), \"(\", doc.inputText.substring(0, 20), \"...)\"]\n            }, doc._id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 446,\n              columnNumber: 5\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 443,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 439,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 421,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `${styles.mainContent} ${isSidebarVisible ? styles.withSidebar : \"\"}`,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.description,\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"This tool helps make complex text easier to read while preserving its original meaning. Whether you're simplifying academic content, technical documents, or general text for better accessibility, this tool provides a quick and efficient way to generate a more readable version. You can enter text manually or upload a document to get started.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 468,\n            columnNumber: 6\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 466,\n          columnNumber: 4\n        }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n          className: styles.customPanel,\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: styles.customToggle,\n            onClick: () => setShowCustom(s => !s),\n            children: showCustom ? \"▲  Hide Customisation Options\" : \"▼  Show Customisation Options\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 476,\n            columnNumber: 11\n          }, this), showCustom && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.customBody,\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              children: \"Output Length\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 487,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: styles.flexRow,\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                className: styles.block,\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"radio\",\n                  name: \"lenPreset\",\n                  value: \"50\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 490,\n                  columnNumber: 19\n                }, this), \" 50 words\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 489,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                className: styles.block,\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"radio\",\n                  name: \"lenPreset\",\n                  value: \"150\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 493,\n                  columnNumber: 19\n                }, this), \" 150 words\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 492,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                className: styles.block,\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"radio\",\n                  name: \"lenPreset\",\n                  value: \"300\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 496,\n                  columnNumber: 19\n                }, this), \" 300 words\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 495,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                className: styles.block,\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"radio\",\n                  name: \"lenPreset\",\n                  value: \"500\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 499,\n                  columnNumber: 19\n                }, this), \" 500 words\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 498,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                className: styles.block,\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"radio\",\n                  name: \"lenPreset\",\n                  value: \"custom\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 502,\n                  columnNumber: 19\n                }, this), \" Custom:\", \" \", /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"number\",\n                  min: \"10\",\n                  style: {\n                    width: \"5rem\"\n                  },\n                  onChange: e => setCustomLen(e.target.value)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 503,\n                  columnNumber: 19\n                }, this), \" \", \"words\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 501,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 488,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n              children: \"Reduce original text by\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 513,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: styles.flexRow,\n              children: [\"0\", \"25\", \"50\", \"75\", \"90\"].map(pct => /*#__PURE__*/_jsxDEV(\"label\", {\n                className: styles.block,\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"radio\",\n                  name: \"reducePct\",\n                  value: pct,\n                  defaultChecked: pct === \"0\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 517,\n                  columnNumber: 21\n                }, this), \" \", pct, \"%\", pct === \"0\" ? \" (No reduction)\" : \"\"]\n              }, pct, true, {\n                fileName: _jsxFileName,\n                lineNumber: 516,\n                columnNumber: 19\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 514,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n              children: \"Reading Level\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 529,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: styles.flexRow,\n              children: [\"Are learning to read\", \"Need simple vocabulary\", \"Prefer shorter sentences\", \"Can handle complex concepts but need clear explanations\", \"Are professionals in this field\"].map(txt => /*#__PURE__*/_jsxDEV(\"label\", {\n                className: styles.block,\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"checkbox\",\n                  name: \"readingLevel\",\n                  value: txt\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 539,\n                  columnNumber: 21\n                }, this), \" \", txt]\n              }, txt, true, {\n                fileName: _jsxFileName,\n                lineNumber: 538,\n                columnNumber: 19\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 530,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n              children: \"Tone & Style\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 546,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: styles.flexRow,\n              children: [\"Casual/Conversational\", \"Professional/Formal\", \"Academic/Instructional\", \"Enthusiastic\", \"Neutral/Objective\"].map(tone => /*#__PURE__*/_jsxDEV(\"label\", {\n                className: styles.block,\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"radio\",\n                  name: \"tone\",\n                  value: tone\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 556,\n                  columnNumber: 21\n                }, this), \" \", tone]\n              }, tone, true, {\n                fileName: _jsxFileName,\n                lineNumber: 555,\n                columnNumber: 19\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 547,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n              children: \"Sentence Structure Preferences\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 562,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: styles.flexRow,\n              children: [\"Bullet points instead of paragraphs\", \"Numbered sequences for steps\", \"Headings to break up content\", \"White space between key ideas\", \"Convert passive to active voice\", \"Break up sentences longer than X words\", \"Simplify nested clauses\", \"Maintain consistent subject‑verb patterns\", \"Reduce prepositional phrases\"].map(opt => /*#__PURE__*/_jsxDEV(\"label\", {\n                className: styles.block,\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"checkbox\",\n                  name: \"structure\",\n                  value: opt\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 576,\n                  columnNumber: 21\n                }, this), \" \", opt]\n              }, opt, true, {\n                fileName: _jsxFileName,\n                lineNumber: 575,\n                columnNumber: 19\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 563,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n              children: \"Anything else?\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 582,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n              rows: 3,\n              placeholder: \"Type any additional preferences here\\u2026\",\n              onChange: e => setExtraPrefs(e.target.value)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 583,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 484,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 474,\n          columnNumber: 4\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.form_container,\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.input_area,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: styles.text_container,\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                className: styles.label,\n                htmlFor: \"inputText\",\n                children: \"Input Text\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 598,\n                columnNumber: 6\n              }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n                id: \"inputText\",\n                className: `${styles.textarea} ${isLoading ? styles.disabled : \"\"}`\n                //   className={styles.textarea}\n                ,\n                placeholder: \"Write/Paste your text here or upload a PDF document to extract content automatically.\",\n                value: inputText,\n                onChange: e => setInputText(e.target.value),\n                disabled: isLoading // Disable input when loading\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 601,\n                columnNumber: 6\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: styles.countText,\n                children: [\"Words: \", inputWordCount, \" | Characters: \", inputCharCount, pdfPageCount > 0 && ` | Pages: ${pdfPageCount}`]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 611,\n                columnNumber: 6\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 597,\n              columnNumber: 7\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: styles.or_divider,\n              children: \"OR\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 618,\n              columnNumber: 7\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `${styles.upload_area} ${isLoading ? styles.disabled : \"\"}`,\n              onDragOver: e => e.preventDefault() // Prevent default behavior\n              ,\n              onDrop: e => {\n                e.preventDefault();\n                const file = e.dataTransfer.files[0]; // Get the first dropped file\n                if (file) {\n                  handleFileUpload({\n                    target: {\n                      files: [file]\n                    }\n                  }); // Simulate file selection event\n                }\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                htmlFor: \"fileUpload\",\n                className: styles.upload_box,\n                children: isUploading ? /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: styles.loadingText,\n                  children: \"Extracting text, please wait...\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 633,\n                  columnNumber: 8\n                }, this) : uploadedFileName ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                  children: [\"File uploaded: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: uploadedFileName\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 636,\n                    columnNumber: 24\n                  }, this)]\n                }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n                  children: [\"Click to Upload a PDF\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 641,\n                    columnNumber: 9\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    children: \"...or drag and drop a file.\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 642,\n                    columnNumber: 9\n                  }, this)]\n                }, void 0, true)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 630,\n                columnNumber: 6\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"file\",\n                id: \"fileUpload\",\n                accept: \"application/pdf\",\n                onChange: handleFileUpload,\n                className: styles.hidden_input,\n                disabled: isUploading || isLoading // Disable upload while processing\n                //disabled={isUploading} // Disable upload while processing\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 647,\n                columnNumber: 6\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 621,\n              columnNumber: 7\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 596,\n            columnNumber: 5\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 594,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: styles.submit_btn,\n          onClick: handleSubmit,\n          disabled: !inputText.trim() || isLoading || isUploading,\n          id: \"simplifyBtn\"\n          //title={!inputText.trim() ? \"Enter text or upload a file to enable simplification.\" : \"\"}\n          ,\n          children: isLoading ? \"Processing...\" : \"Simplify Text\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 660,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: styles.help_text,\n          children: [\"Need Help? \", /*#__PURE__*/_jsxDEV(\"a\", {\n            href: \"mailto:anukumar@uw.edu\",\n            children: \"Contact Support\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 670,\n            columnNumber: 49\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 670,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 462,\n        columnNumber: 4\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 419,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true);\n};\n_s(Main, \"z/0M8DbzVe4+QJQ9FTy/nAp3ubE=\", false, function () {\n  return [useNavigate];\n});\n_c = Main;\nexport default Main;\nvar _c;\n$RefreshReg$(_c, \"Main\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","styles","useNavigate","pdfjsLib","jwtDecode","calcMetrics","jsxDEV","_jsxDEV","Fragment","_Fragment","GlobalWorkerOptions","workerSrc","process","env","PUBLIC_URL","prefsToPlain","prefs","sections","maxWords","reduction","push","readingLevels","length","join","tone","structPrefs","misc","trim","Main","_s","inputText","setInputText","outputText","setOutputText","isLoading","setIsLoading","isSubmitted","setIsSubmitted","isEditable","setIsEditable","uploadedFileName","setUploadedFileName","isSaveButtonVisible","setIsSaveButtonVisible","showSurveyPrompt","setShowSurveyPrompt","documents","setDocuments","selectedDocument","setSelectedDocument","isSidebarVisible","setIsSidebarVisible","navigate","isUploading","setIsUploading","user","JSON","parse","localStorage","getItem","email","inputWordCount","setInputWordCount","inputCharCount","setInputCharCount","pdfPageCount","setPdfPageCount","inputTextSnapshot","pdfPath","setPdfPath","prefsOpen","setPrefsOpen","customPrefs","setCustomPrefs","showCustom","setShowCustom","customLen","setCustomLen","extraPrefs","setExtraPrefs","handleLogout","removeItem","toggleSet","key","value","p","list","includes","filter","v","fetchDocuments","response","fetch","result","json","ok","sortedDocs","data","sort","a","b","Date","createdAt","console","error","message","handleDocumentClick","doc","handleFileUpload","event","file","target","files","name","fileReader","FileReader","onload","typedArray","Uint8Array","pdf","getDocument","promise","numPages","text","i","page","getPage","textContent","getTextContent","items","map","item","str","readAsArrayBuffer","alert","countWordsAndChars","words","split","Boolean","chars","inputWords","inputChars","saveInitialSimplification","trimmedInput","cleanedOutput","method","headers","body","stringify","userId","_id","pdfName","generatePrompt","prefsText","splitTextIntoChunks","maxTokens","chunks","currentChunk","word","handleSubmit","combinedOutput","chunk","_data$response","prompt","status","log","data1","replace","cleanedResponse","state","children","className","navbar","onClick","window","location","href","style","cursor","fileName","_jsxFileName","lineNumber","columnNumber","white_btn","container","sidebar","expanded","historyIcon","fontSize","historyContent","closeButton","historyList","index","historyItem","activeDoc","substring","mainContent","withSidebar","description","customPanel","customToggle","s","customBody","flexRow","block","type","min","width","onChange","e","pct","defaultChecked","txt","opt","rows","placeholder","form_container","input_area","text_container","label","htmlFor","id","textarea","disabled","countText","or_divider","upload_area","onDragOver","preventDefault","onDrop","dataTransfer","upload_box","loadingText","accept","hidden_input","submit_btn","help_text","_c","$RefreshReg$"],"sources":["/Users/anukumar/Desktop/Spring2025/local-textsimplification/client/src/components/Main/index.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback  } from \"react\";\nimport styles from \"./styles.module.css\";\nimport { useNavigate } from \"react-router-dom\";\nimport * as pdfjsLib from \"pdfjs-dist/legacy/build/pdf\";\n// import { BrowserRouter as Router, Routes, Route, useNavigate } from \"react-router-dom\";\nimport { jwtDecode } from \"jwt-decode\";\n\nimport { calcMetrics } from \"../../utils/textMetrics\";\n\npdfjsLib.GlobalWorkerOptions.workerSrc = `${process.env.PUBLIC_URL}/pdf.worker.mjs`;\n\nconst prefsToPlain = (prefs) => {\n\tconst sections = [];\n  \n\t/* ----- 1 Output length ----- */\n\tif (prefs.maxWords || prefs.reduction)\n\t  sections.push(\n\t\t`• Limit final output to **${prefs.maxWords || \"⩓\"} words** ` +\n\t\t`(${prefs.reduction ? `${prefs.reduction}% reduction` : \"no reduction\"}).`\n\t  );\n  \n\t/* ----- 2 Reading level ----- */\n\tif (prefs.readingLevels.length)\n\t  sections.push(\"• Writing should suit readers who \" +\n\t\tprefs.readingLevels.join(\", \") + \".\");\n  \n\t/* ----- 3 Tone ----- */\n\tif (prefs.tone)\n\t  sections.push(`• Use a **${prefs.tone}** tone.`);\n  \n\t/* ----- 4 Sentence structure ----- */\n\tif (prefs.structPrefs.length)\n\t  sections.push(\"• Structural preferences: \" +\n\t\tprefs.structPrefs.join(\", \") + \".\");\n  \n\t/* ----- 5 Free text ----- */\n\tif (prefs.misc.trim())\n\t  sections.push(\"• Additional notes: \" + prefs.misc.trim());\n  \n\treturn sections.length ? sections.join(\"\\n\") : \"\";\n  };\n\n  \nconst Main = () => {\n\n\tconst [inputText, setInputText] = useState(\"\");\n\tconst [outputText, setOutputText] = useState(\"\");\n\tconst [isLoading, setIsLoading] = useState(false);\n\tconst [isSubmitted, setIsSubmitted] = useState(false);\n\tconst [isEditable, setIsEditable] = useState(false); // For toggling edit mode\n\tconst [uploadedFileName, setUploadedFileName] = useState(\"\"); // State for file name\n\tconst [isSaveButtonVisible, setIsSaveButtonVisible] = useState(true);\n\tconst [showSurveyPrompt, setShowSurveyPrompt] = useState(false); // State for survey prompt\n\n\tconst [documents, setDocuments] = useState([]); // Store user documents\n\tconst [selectedDocument, setSelectedDocument] = useState(null); // Selected doc\n\tconst [isSidebarVisible, setIsSidebarVisible] = useState(false); // Sidebar toggle\n\n\tconst navigate = useNavigate();\n\tconst [isUploading, setIsUploading] = useState(false); // State for showing buffer\n\n\tconst user = JSON.parse(localStorage.getItem(\"user\"));\n\tconst email = user?.email;\n\n\tconst [inputWordCount, setInputWordCount] = useState(0);\n\tconst [inputCharCount, setInputCharCount] = useState(0);\n\tconst [pdfPageCount, setPdfPageCount] = useState(0);\n\n\tconst inputTextSnapshot = useRef(\"\");\n\tconst [pdfPath, setPdfPath] = useState(\"\"); \n\n\tconst [prefsOpen, setPrefsOpen] = useState(false);\n\tconst [customPrefs, setCustomPrefs] = useState({\n\t  maxWords   : \"\",      // number or \"\"\n\t  reduction  : \"\",      // \"0\" | \"25\" | \"50\" | …\n\t  readingLevels : [],   // array of strings\n\t  tone       : \"\",      // single string\n\t  structPrefs: [],      // array of strings\n\t  misc       : \"\",      // free text\n\t});\n\n\tconst [showCustom,  setShowCustom]  = useState(false);  // accordion open/close\n\tconst [customLen,   setCustomLen]   = useState(\"\");     // numeric length, if “Custom”\n\tconst [extraPrefs,  setExtraPrefs]  = useState(\"\");     // free‑text box\n\n  const handleLogout = () => {\n    localStorage.removeItem(\"token\");\n    navigate(\"/Login\"); \n  };\n\n  const toggleSet = (key, value) => setCustomPrefs(p => {\n    const list = p[key];\n    return {\n      ...p,\n      [key]: list.includes(value)\n        ? list.filter(v => v !== value)\n        : [...list, value]\n    };\n  });\n\n\n    // Load user's past documents (original texts only)\n\tuseEffect(() => {\n\t\tif (!email) return;\n\t\n\t\tconst fetchDocuments = async () => {\n\t\t  try {\n\t\t\tconst response = await fetch(\n\t\t\t  `http://localhost:5001/api/simplifications/user/${email}`\n\t\t\t);\n\t\t\tconst result = await response.json();\n\t\n\t\t\tif (response.ok) {\n\t\t\t  const sortedDocs = result.data.sort(\n\t\t\t\t(a, b) => new Date(b.createdAt) - new Date(a.createdAt)\n\t\t\t  );\n\t\t\t  setDocuments(sortedDocs);\n\t\t\t} else {\n\t\t\t  console.error(\"Error fetching documents:\", result.message);\n\t\t\t}\n\t\t  } catch (error) {\n\t\t\tconsole.error(\"Error fetching documents:\", error);\n\t\t  }\n\t\t};\n\t\n\t\tfetchDocuments();\n\t  }, [email]);\n\n\t  // Handle document selection from history\n  const handleDocumentClick = (doc) => {\n    setSelectedDocument(doc);\n    setInputText(doc.inputText);\n  };\n\n  \tconst handleFileUpload = async (event) => {\n\t  const file = event.target.files[0];\n\t  setPdfPath(`/uploads/${file.name}`);    \n\n\t  if (!file) return;\n  \n\t  setIsUploading(true); // Show buffer while processing\n\t  setUploadedFileName(file.name); // Set file name\n\n\t  try {\n\t\t//setUploadedFileName(file.name); // Set the uploaded file name\n\t\tconst fileReader = new FileReader();\n\t\tfileReader.onload = async function () {\n\t\t  const typedArray = new Uint8Array(this.result);\n  \n\t\t  const pdf = await pdfjsLib.getDocument(typedArray).promise;\n\n\t\t  setPdfPageCount(pdf.numPages);\n\n\t\t  let text = \"\";\n  \n\t\t  // Extract text from all pages\n\t\t  for (let i = 1; i <= pdf.numPages; i++) {\n\t\t\tconst page = await pdf.getPage(i);\n\t\t\tconst textContent = await page.getTextContent();\n\t\t\ttext += textContent.items.map((item) => item.str).join(\" \");\n\t\t  }\n  \n\t\t  setInputText(text);\n\t\t};\n\t\tfileReader.readAsArrayBuffer(file);\n\t  } catch (error) {\n\t\tconsole.error(\"Error reading PDF:\", error);\n\t\talert(\"Failed to extract text from the PDF.\");\n\t  } finally {\n\t\tsetIsUploading(false); // Hide buffer once done\n\t  }\n\t};\n \n\tconst countWordsAndChars = (text) => {\n\t\tconst words = text.trim().split(/\\s+/).filter(Boolean).length;\n\t\tconst chars = text.length;\n\t\treturn { words, chars };\n\t  };\n\t  \n\t    useEffect(() => {\n\t\t  const { words: inputWords, chars: inputChars } = countWordsAndChars(inputText);\n\n\t\t  setInputWordCount(inputWords);\n\t\t  setInputCharCount(inputChars);\n\n\t\t}, [inputText]);\n\t  \n\t\tconst saveInitialSimplification = async (trimmedInput, cleanedOutput) => {\n\t\t\tconst user = JSON.parse(localStorage.getItem(\"user\"));\n\t\t\tif (!user) return;\n\n\t\t\tawait fetch(\"http://localhost:5001/api/simplifications\", {\n\t\t\t\tmethod: \"POST\",\n\t\t\t\theaders: { \"Content-Type\": \"application/json\" },\n\t\t\t\tbody: JSON.stringify({\n\t\t\t\tuserId: user._id,\n\t\t\t\temail,\n\t\t\t\tinputText: trimmedInput,\n\t\t\t\toutputText: cleanedOutput,\n\t\t\t\tpdfName: uploadedFileName || null,\n\t\t\t\tpdfPath: pdfPath || null,\n\t\t\t\t}),\n\t\t\t});\n\t\t};\n\n\n\t\tconst generatePrompt = useCallback((inputText) => {\n\t\t\tconst prefsText = prefsToPlain(customPrefs);\n\t\n\t\t\treturn `\n\t\t### USER‑SPECIFIC CUSTOMISATIONS (please follow **strictly**)\n\t\t${prefsText || \"• No special preferences.\"}\n\t\t\n\t\tYou are an expert in accessible communication, tasked with transforming complex text into clear, accessible plain language for individuals with Intellectual and Developmental Disabilities (IDD) or those requiring simplified content. Retain all essential information and intent while prioritizing readability, comprehension, and inclusivity.\n\n\t\tText simplification refers to rewriting or adapting text to make it easier to read and understand while keeping the same level of detail and precision. Make sure you focus on simplification and not summarization. The length of generated output text must be similar to that of input text.\n\n\t\tStick to the provided input text and only simplify the language. Don't provide the answer or hallucinate or provide any irrelevant information, not mentioned in the input text. \n\n\t\tGuidelines for Simplification:\n\t\tVocabulary and Terminology:\n\t\tReplace uncommon, technical, or abstract words with simple, everyday language.\n\t\tDefine unavoidable complex terms in plain language within parentheses upon first use (example: “cardiologist (heart doctor)”).\n\t\tAvoid idioms, metaphors, sarcasm, or culturally specific references.\n\n\t\tSentence Structure:\n\t\tUse short sentences (10--15 words max). Break long sentences into 1–2 ideas each.\n\t\tPrefer active voice (example: “The doctor examined the patient” vs. “The patient was examined by the doctor”).\n\t\tAvoid nested clauses, passive voice, and ambiguous pronouns (example: “they,” “it”).\n\n\t\tClarity and Flow:\n\t\tOrganize content logically, using headings/subheadings to group related ideas.\n\t\tUse bullet points or numbered lists for steps, options, or key points.\n\t\tEnsure each paragraph focuses on one main idea.\n\n\t\tTone and Engagement:\n\t\tWrite in a neutral, conversational tone (avoid formal or academic language).\n\t\tAddress the reader directly with “you” or “we” where appropriate.\n\t\tUse consistent terms for concepts (avoid synonyms that may confuse).\n\n\t\tAvoid Exclusionary Elements:\n\t\tRemove jargon, acronyms (unless defined), and expand abbreviations if needed (example: “ASAP” → “as soon as possible”).\n\t\tEliminate metaphors, idioms, or implied meanings (example: “hit the books” → “study”).\n\t\tAvoid double negatives (example: “not uncommon” → “common”).\n\n\t\tStructural Support:\n\t\tAdd clear headings to label sections (example: “How to Apply for Benefits”).\n\t\tUse formatting tools like bold for key terms or warnings.\n\t\tChunk information into short paragraphs with line breaks for visual ease.\n\n\t\tInclusivity Checks:\n\t\tEnsure content is free of bias, stereotypes, or assumptions about the reader.\n\t\tUse gender-neutral language (example: “they” instead of “he/she”).\n\n\n\t\tOutput Requirements:\n\t\tReturn only the simplified text, without markdown, emojis, or images.\n\t\tPreserve original context, facts, and intent. Do not omit critical details.\n\t\tPrioritize clarity over brevity; focus on simplification and not summarization. The length of generated output text should be same or similar to that of input text.\n\t\tDo not simplify already simple text.\n\n\t\tExample Transformation:\n\t\tOriginal: “Individuals experiencing adverse climatic conditions may necessitate relocation to mitigate health risks.”\n\t\tSimplified: “If weather conditions become dangerous, people might need to move to stay safe.”\n\n\t\tFor the provided input text, apply the above guidelines rigorously. Ensure the output is accessible to readers with varied cognitive abilities, emphasizing clarity, simplicity, and logical structure. Verify that the simplified text aligns with plain language standards like WCAG and PlainLanguage.gov.\n\n\t\t\"${inputText}\"\n\t\t`;\n\t\t  }, [customPrefs]);\n\t// Function to format the prompt with user input\n// const generatePrompt = (inputText) => {\n// \treturn `\n// \tYou are an expert in accessible communication, tasked with transforming complex text into clear, accessible plain language for individuals with Intellectual and Developmental Disabilities (IDD) or those requiring simplified content. Retain all essential information and intent while prioritizing readability, comprehension, and inclusivity.\n\n// \tText simplification refers to rewriting or adapting text to make it easier to read and understand while keeping the same level of detail and precision. Make sure you focus on simplification and not summarization. The length of generated output text must be similar to that of input text.\n\n// \tStick to the provided input text and only simplify the language. Don't provide the answer or hallucinate or provide any irrelevant information, not mentioned in the input text. \n\n// \tGuidelines for Simplification:\n// \tVocabulary and Terminology:\n// \tReplace uncommon, technical, or abstract words with simple, everyday language.\n// \tDefine unavoidable complex terms in plain language within parentheses upon first use (example: “cardiologist (heart doctor)”).\n// \tAvoid idioms, metaphors, sarcasm, or culturally specific references.\n\n// \tSentence Structure:\n// \tUse short sentences (10--15 words max). Break long sentences into 1–2 ideas each.\n// \tPrefer active voice (example: “The doctor examined the patient” vs. “The patient was examined by the doctor”).\n// \tAvoid nested clauses, passive voice, and ambiguous pronouns (example: “they,” “it”).\n\n// \tClarity and Flow:\n// \tOrganize content logically, using headings/subheadings to group related ideas.\n// \tUse bullet points or numbered lists for steps, options, or key points.\n// \tEnsure each paragraph focuses on one main idea.\n\n// \tTone and Engagement:\n// \tWrite in a neutral, conversational tone (avoid formal or academic language).\n// \tAddress the reader directly with “you” or “we” where appropriate.\n// \tUse consistent terms for concepts (avoid synonyms that may confuse).\n\n// \tAvoid Exclusionary Elements:\n// \tRemove jargon, acronyms (unless defined), and expand abbreviations if needed (example: “ASAP” → “as soon as possible”).\n// \tEliminate metaphors, idioms, or implied meanings (example: “hit the books” → “study”).\n// \tAvoid double negatives (example: “not uncommon” → “common”).\n\n// \tStructural Support:\n// \tAdd clear headings to label sections (example: “How to Apply for Benefits”).\n// \tUse formatting tools like bold for key terms or warnings.\n// \tChunk information into short paragraphs with line breaks for visual ease.\n\n// \tInclusivity Checks:\n// \tEnsure content is free of bias, stereotypes, or assumptions about the reader.\n// \tUse gender-neutral language (example: “they” instead of “he/she”).\n\n\n// \tOutput Requirements:\n// \tReturn only the simplified text, without markdown, emojis, or images.\n// \tPreserve original context, facts, and intent. Do not omit critical details.\n// \tPrioritize clarity over brevity; focus on simplification and not summarization. The length of generated output text should be same or similar to that of input text.\n// \tDo not simplify already simple text.\n\n// \tExample Transformation:\n// \tOriginal: “Individuals experiencing adverse climatic conditions may necessitate relocation to mitigate health risks.”\n// \tSimplified: “If weather conditions become dangerous, people might need to move to stay safe.”\n\n// \tFor the provided input text, apply the above guidelines rigorously. Ensure the output is accessible to readers with varied cognitive abilities, emphasizing clarity, simplicity, and logical structure. Verify that the simplified text aligns with plain language standards like WCAG and PlainLanguage.gov.\n\n// \t\"${inputText}\"\n// \t`;\n//   };\n\n  const splitTextIntoChunks = (text, maxTokens) => {\n\tconst words = text.split(\" \");\n\tlet chunks = [];\n\tlet currentChunk = [];\n  \n\tfor (let word of words) {\n\t  if (currentChunk.join(\" \").length + word.length < maxTokens) {\n\t\tcurrentChunk.push(word);\n\t  } else {\n\t\tchunks.push(currentChunk.join(\" \"));\n\t\tcurrentChunk = [word];\n\t  }\n\t}\n\tif (currentChunk.length > 0) chunks.push(currentChunk.join(\" \"));\n\treturn chunks;\n  };\n\n\n  const handleSubmit = async () => {\n\n\t// const inputText = document.getElementById('inputText').value;\n\tconst trimmedInput = inputText.trim();\n\tif (!trimmedInput) return;\n\n\t// inputTextSnapshot.current = inputText; \n\tsetIsLoading(true);\n  \n\ttry {\n\t  const chunks = splitTextIntoChunks(trimmedInput, 10000);\n\t  let combinedOutput = \"\";\n  \n\t  for (let chunk of chunks) {\n\t\tconst prompt = generatePrompt(chunk);\n\t\tconst response = await fetch(\"http://localhost:5001/api/gpt4\", {\n\t\t  method: \"POST\",\n\t\t  headers: { \"Content-Type\": \"application/json\" },\n\t\t  body: JSON.stringify({ prompt }),\n\t\t});\n\t\t\n\t\tif (!response.ok) {\n\t\t\tconsole.error(`API request failed with status: ${response.status}`);\n\t\t\tcontinue; // Skip this chunk if the API request failed\n\t\t  }\n\n\t\tconst data = await response.json();\n\t\tconsole.log(\"Full API Response: \", data);\n\n\n\t\tconst data1 = data?.response?.replace(/^\"|\"$/g, \"\") || \"No response received.\"; // Append results\n\t\tcombinedOutput += data1 + \" \";\n\t}\n\t  console.log(\"Final Combined Output: \", combinedOutput);\n\n\tconsole.log(\"Data: \", combinedOutput);\n\n\tconst cleanedResponse = combinedOutput.trim();\n\tsetOutputText(cleanedResponse);\n\tsetIsSubmitted(true);\n\n\tawait saveInitialSimplification(trimmedInput, cleanedResponse);\n\tnavigate(\"/review\", { state: { inputText: trimmedInput, outputText: cleanedResponse } });\n\t// navigate(\"/review\", { state: { inputText: trimmedInput, outputText: cleanedResponse } });\n\t\n\t} catch (error) {\n\t  console.error(\"Error fetching GPT-4o response:\", error);\n\t  setOutputText(\"An error occurred while simplifying the text.\");\n\t}\n  \n\tsetIsLoading(false);\n  };\n\n  \n\n  return (\n    <>\n      <nav className={styles.navbar}>\n        {/* <h1>Text Simplification Tool</h1> */}\n\t\t<h1 \n    onClick={() => window.location.href = \"http://localhost:5001/\"}\n    style={{ cursor: \"pointer\" }} // Makes it look clickable\n \t\t>\n\t\tText Simplification Tool</h1>\n        <button className={styles.white_btn} onClick={handleLogout}>\n          Logout\n        </button>\n      </nav>\n\n\t  <div className={styles.container}>\n\n\t\t\t <div\n\t\t\t\t  className={`${styles.sidebar} ${\n\t\t\t\t\tisSidebarVisible ? styles.expanded : \"\"\n\t\t\t\t  }`}\n\t\t\t\t>\n\n\t\t\t{/* </div> */}\n\n\t\t\t<button\n\t\t\tclassName={styles.historyIcon}\n\t\t\tonClick={() => setIsSidebarVisible(!isSidebarVisible)}\n\t\t\t>\n\t\t\t\t🕒   <p style={{ fontSize: \"15px\" }}> History </p> \n\t\t\t</button>\n\n\n\n          {isSidebarVisible && (\n            <div className={styles.historyContent}>\n              <button className={styles.closeButton} onClick={() => setIsSidebarVisible(false)}>\n                ✖\n              </button>\n              <ul className={styles.historyList}>\n                {documents.map((doc, index) => (\n    \n\t\t\t\t<li\n\t\t\t\tkey={doc._id}\n\t\t\t\tonClick={() => handleDocumentClick(doc)}\n\t\t\t\tclassName={`${styles.historyItem} ${selectedDocument?._id === doc._id ? styles.activeDoc : \"\"}`}\n\t\t\t\t>\n\t\t\t\t{/* <strong>Document {index + 1}</strong>  */}\n\t\t\t\t<strong>Document {documents.length - index}</strong>({doc.inputText.substring(0, 20)}...)\n\t\t\t\t</li>\n                ))}\n              </ul>\n            </div>\n          )}\n        </div>\n\n\t  {/* <div className={styles.main_container}> */}\n\t  \n\t  <div className={`${styles.mainContent} ${isSidebarVisible ? styles.withSidebar : \"\"}`}>\n         \n\n\n\t\t\t<div className={styles.description}>\n\n\t\t\t  <p>\n\t\t\t  This tool helps make complex text easier to read while preserving its original meaning. Whether you're simplifying academic content, technical documents, or general text for better accessibility, this tool provides a quick and efficient way to generate a more readable version. You can enter text manually or upload a document to get started.\n\t\t\t  </p>\n\t</div>\n\n\t        {/* ─── (2)  CUSTOMISATION PANEL  ─────────── */}\n\t\t\t<section className={styles.customPanel}>\n          {/* toggle row */}\n          <button\n            className={styles.customToggle}\n            onClick={() => setShowCustom((s) => !s)}\n          >\n            {showCustom ? \"▲  Hide Customisation Options\" : \"▼  Show Customisation Options\"}\n          </button>\n\n          {showCustom && (\n            <div className={styles.customBody}>\n\t\t\t\t\n              {/* 2‑A  ▸ Output length ------------------------------------------------ */}\n              <h3>Output Length</h3>\n              <div className={styles.flexRow}>\n                <label className={styles.block}>\n                  <input type=\"radio\" name=\"lenPreset\" value=\"50\" /> 50 words\n                </label>\n                <label className={styles.block}>\n                  <input type=\"radio\" name=\"lenPreset\" value=\"150\" /> 150 words\n                </label>\n                <label className={styles.block}>\n                  <input type=\"radio\" name=\"lenPreset\" value=\"300\" /> 300 words\n                </label>\n                <label className={styles.block}>\n                  <input type=\"radio\" name=\"lenPreset\" value=\"500\" /> 500 words\n                </label>\n                <label className={styles.block}>\n                  <input type=\"radio\" name=\"lenPreset\" value=\"custom\" /> Custom:{\" \"}\n                  <input\n                    type=\"number\"\n                    min=\"10\"\n                    style={{ width: \"5rem\" }}\n                    onChange={(e) => setCustomLen(e.target.value)}\n                  />{\" \"}\n                  words\n                </label>\n              </div>\n\n              <h3>Reduce original text by</h3>\n              <div className={styles.flexRow}>\n                {[\"0\", \"25\", \"50\", \"75\", \"90\"].map((pct) => (\n                  <label key={pct} className={styles.block}>\n                    <input\n                      type=\"radio\"\n                      name=\"reducePct\"\n                      value={pct}\n                      defaultChecked={pct === \"0\"}\n                    />{\" \"}\n                    {pct}%{pct === \"0\" ? \" (No reduction)\" : \"\"}\n                  </label>\n                ))}\n              </div>\n\n              {/* 2‑B  ▸ Reading level ---------------------------------------------- */}\n              <h3>Reading Level</h3>\n              <div className={styles.flexRow}>\n                {[\n                  \"Are learning to read\",\n                  \"Need simple vocabulary\",\n                  \"Prefer shorter sentences\",\n                  \"Can handle complex concepts but need clear explanations\",\n                  \"Are professionals in this field\",\n                ].map((txt) => (\n                  <label key={txt} className={styles.block}>\n                    <input type=\"checkbox\" name=\"readingLevel\" value={txt} />{\" \"}\n                    {txt}\n                  </label>\n                ))}\n              </div>\n\n              {/* 2‑C  ▸ Tone / style ---------------------------------------------- */}\n              <h3>Tone &amp; Style</h3>\n              <div className={styles.flexRow}>\n                {[\n                  \"Casual/Conversational\",\n                  \"Professional/Formal\",\n                  \"Academic/Instructional\",\n                  \"Enthusiastic\",\n                  \"Neutral/Objective\",\n                ].map((tone) => (\n                  <label key={tone} className={styles.block}>\n                    <input type=\"radio\" name=\"tone\" value={tone} /> {tone}\n                  </label>\n                ))}\n              </div>\n\n              {/* 2‑D  ▸ Sentence structure ---------------------------------------- */}\n              <h3>Sentence Structure Preferences</h3>\n              <div className={styles.flexRow}>\n                {[\n                  \"Bullet points instead of paragraphs\",\n                  \"Numbered sequences for steps\",\n                  \"Headings to break up content\",\n                  \"White space between key ideas\",\n                  \"Convert passive to active voice\",\n                  \"Break up sentences longer than X words\",\n                  \"Simplify nested clauses\",\n                  \"Maintain consistent subject‑verb patterns\",\n                  \"Reduce prepositional phrases\",\n                ].map((opt) => (\n                  <label key={opt} className={styles.block}>\n                    <input type=\"checkbox\" name=\"structure\" value={opt} /> {opt}\n                  </label>\n                ))}\n              </div>\n\n              {/* 2‑E  ▸ Free‑text box -------------------------------------------- */}\n              <h3>Anything else?</h3>\n              <textarea\n                rows={3}\n                placeholder=\"Type any additional preferences here…\"\n                onChange={(e) => setExtraPrefs(e.target.value)}\n              />\n            </div>\n          )}\n        </section>\n\n\t\t{/*  */}\n\n\t\t\t  <div className={styles.form_container}>\n\t\t\t\t{/* Input Area */}\n\t\t\t\t<div className={styles.input_area}>\n\t\t\t\t  <div className={styles.text_container}>\n\t\t\t\t\t<label className={styles.label} htmlFor=\"inputText\">\n\t\t\t\t\t  Input Text\n\t\t\t\t\t</label>\n\t\t\t\t\t<textarea\n\t\t\t\t\t  id=\"inputText\"\n\t\t\t\t\t  className={`${styles.textarea} ${isLoading ? styles.disabled : \"\"}`}\n\t\t\t\t\t//   className={styles.textarea}\n\t\t\t\t\t  placeholder=\"Write/Paste your text here or upload a PDF document to extract content automatically.\"\n\t\t\t\t\t  value={inputText}\n\t\t\t\t\t  onChange={(e) => setInputText(e.target.value)}\n\t\t\t\t\t  disabled={isLoading} // Disable input when loading\n\t\t\t\t\t></textarea>\n\t\t\t\t \n\t\t\t\t <p className={styles.countText}>Words: {inputWordCount} | Characters: {inputCharCount}\n\t\t\t\t {pdfPageCount > 0 && ` | Pages: ${pdfPageCount}`}\n\t\t\t\t </p>\n\t\t\t\t\t\n\t\t\t\t  </div>\n  \n\t\t\t\t  {/* OR Divider */}\n\t\t\t\t  <div className={styles.or_divider}>OR</div>\n  \n\t\t\t\t  {/* File Upload */}\n\t\t\t\t  <div className={`${styles.upload_area} ${isLoading ? styles.disabled : \"\"}`}\n\t\t\t\t\tonDragOver={(e) => e.preventDefault()} // Prevent default behavior\n\t\t\t\t\tonDrop={(e) => {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tconst file = e.dataTransfer.files[0]; // Get the first dropped file\n\t\t\t\t\t\tif (file) {\n\t\t\t\t\t\thandleFileUpload({ target: { files: [file] } }); // Simulate file selection event\n\t\t\t\t\t\t}\n\t\t\t\t\t}}>\n\t\t\t\t\t<label htmlFor=\"fileUpload\" className={styles.upload_box}>\n\t\t\t\t\t\t\n\t\t\t\t\t\t{isUploading ? (\n\t\t\t\t\t\t\t<span className={styles.loadingText}>Extracting text, please wait...</span>\n\t\t\t\t\t\t\t) : uploadedFileName ? (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\tFile uploaded: <strong>{uploadedFileName}</strong>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\tClick to Upload a PDF\n\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t<span>...or drag and drop a file.</span>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t)}\n\t\t\t\n\t\t\t\t\t</label>\n\t\t\t\t\t<input\n\t\t\t\t\t  type=\"file\"\n\t\t\t\t\t  id=\"fileUpload\"\n\t\t\t\t\t  accept=\"application/pdf\"\n\t\t\t\t\t  onChange={handleFileUpload}\n\t\t\t\t\t  className={styles.hidden_input}\n\t\t\t\t\t  disabled={isUploading || isLoading} // Disable upload while processing\n\t\t\t\t\t  //disabled={isUploading} // Disable upload while processing\n\t\t\t\t\t/>\n\t\t\t\t  </div>\n\t\t\t\t</div>\n\t\t\t  </div>\n\t\t\t  {/* Submit Button */}\n\t\t\t  <button\n\t\t\t\tclassName={styles.submit_btn}\n\t\t\t\tonClick={handleSubmit}\n\t\t\t\tdisabled={!inputText.trim() || isLoading || isUploading}\n\t\t\t\tid=\"simplifyBtn\"\n\t\t\t\t//title={!inputText.trim() ? \"Enter text or upload a file to enable simplification.\" : \"\"}\n\t\t\t  >\n\t\t\t\t{isLoading ? \"Processing...\" : \"Simplify Text\"}\n\t\t\t  </button>\n\t\n\t\t\t  <p className={styles.help_text}>Need Help? <a href=\"mailto:anukumar@uw.edu\">Contact Support</a></p>\n\n      </div>\n\n      </div>\n    </>\n  );\n};\n\nexport default Main;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}