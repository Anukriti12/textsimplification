{"ast":null,"code":"// import React, { useState, useEffect, useRef, useCallback  } from \"react\";\n// import styles from \"./styles.module.css\";\n// import { useNavigate } from \"react-router-dom\";\n// import * as pdfjsLib from \"pdfjs-dist/legacy/build/pdf\";\n// // import { BrowserRouter as Router, Routes, Route, useNavigate } from \"react-router-dom\";\n// import { jwtDecode } from \"jwt-decode\";\n// import Footer from \"../Footer\";\n// import { calcMetrics } from \"../../utils/textMetrics\";\n// import StatsButton from \"../StatsButton\";\n// pdfjsLib.GlobalWorkerOptions.workerSrc = `${process.env.PUBLIC_URL}/pdf.worker.mjs`;\n// const prefsToPlain = (prefs) => {\n// \tconst sections = [];\n// \t/* ----- 1 Output length ----- */\n// \tif (prefs.maxWords || prefs.reduction)\n// \t  sections.push(\n// \t\t`• Limit final output to **${prefs.maxWords || \"⩓\"} words** ` +\n// \t\t`(${prefs.reduction ? `${prefs.reduction}% reduction` : \"no reduction\"}).`\n// \t  );\n// \t/* ----- 2 Reading level ----- */\n// \tif (prefs.readingLevels.length)\n// \t  sections.push(\"• Writing should suit readers who \" +\n// \t\tprefs.readingLevels.join(\", \") + \".\");\n// \t/* ----- 3 Tone ----- */\n// \tif (prefs.tone)\n// \t  sections.push(`• Use a **${prefs.tone}** tone.`);\n// \t/* ----- 4 Sentence structure ----- */\n// \tif (prefs.structPrefs.length)\n// \t  sections.push(\"• Structural preferences: \" +\n// \t\tprefs.structPrefs.join(\", \") + \".\");\n// \t/* ----- 5 Free text ----- */\n// \tif (prefs.misc.trim())\n// \t  sections.push(\"• Additional notes: \" + prefs.misc.trim());\n// \treturn sections.length ? sections.join(\"\\n\") : \"\";\n//   };\n// const Main = () => {\n// \tconst [inputText, setInputText] = useState(\"\");\n// \tconst [outputText, setOutputText] = useState(\"\");\n// \tconst [isLoading, setIsLoading] = useState(false);\n// \tconst [isSubmitted, setIsSubmitted] = useState(false);\n// \tconst [isEditable, setIsEditable] = useState(false); // For toggling edit mode\n// \tconst [uploadedFileName, setUploadedFileName] = useState(\"\"); // State for file name\n// \tconst [isSaveButtonVisible, setIsSaveButtonVisible] = useState(true);\n// \tconst [showSurveyPrompt, setShowSurveyPrompt] = useState(false); // State for survey prompt\n// \tconst [documents, setDocuments] = useState([]); // Store user documents\n// \tconst [selectedDocument, setSelectedDocument] = useState(null); // Selected doc\n// \tconst [isSidebarVisible, setIsSidebarVisible] = useState(false); // Sidebar toggle\n// \tconst navigate = useNavigate();\n// \tconst [isUploading, setIsUploading] = useState(false); // State for showing buffer\n// \tconst user = JSON.parse(localStorage.getItem(\"user\"));\n// \tconst email = user?.email;\n// \tconst [inputWordCount, setInputWordCount] = useState(0);\n// \tconst [inputCharCount, setInputCharCount] = useState(0);\n// \tconst [pdfPageCount, setPdfPageCount] = useState(0);\n// \tconst inputTextSnapshot = useRef(\"\");\n// \tconst [pdfPath, setPdfPath] = useState(\"\"); \n// \tconst [prefsOpen, setPrefsOpen] = useState(false);\n// \tconst [customPrefs, setCustomPrefs] = useState({\n// \t  maxWords   : \"\",      // number or \"\"\n// \t  reduction  : \"\",      // \"0\" | \"25\" | \"50\" | …\n// \t  readingLevels : [],   // array of strings\n// \t  tone       : \"\",      // single string\n// \t  structPrefs: [],      // array of strings\n// \t  misc       : \"\",      // free text\n// \t});\n// \tconst [outputLen, setOutputLen] = useState(\"\");   // \"\", \"50\", \"150\", …, \"custom\"\n// \tconst [showCustom,  setShowCustom]  = useState(false);  // accordion open/close\n// \tconst [customLen,   setCustomLen]   = useState(\"\");     // numeric length, if “Custom”\n// \tconst [extraPrefs,  setExtraPrefs]  = useState(\"\");     // free‑text box\n// \t// ─── Panel toggle ────────────────────────────────────────────────\n// const handleTogglePanel = () => setShowCustom((s) => !s);   // <─ NEW\n//   const handleLogout = () => {\n//     localStorage.removeItem(\"token\");\n//     navigate(\"/Login\"); \n//   };\n//   const toggleSet = (key, value) => setCustomPrefs(p => {\n//     const list = p[key];\n//     return {\n//       ...p,\n//       [key]: list.includes(value)\n//         ? list.filter(v => v !== value)\n//         : [...list, value]\n//     };\n//   });\n//     // Load user's past documents (original texts only)\n// \tuseEffect(() => {\n// \t\tif (!email) return;\n// \t\tconst fetchDocuments = async () => {\n// \t\t  try {\n// \t\t\tconst response = await fetch(\n// \t\t\t  `https://textsimplification12-a0a8gqfbhnhxbgbv.westus-01.azurewebsites.net/api/simplifications/user/${email}`\n// \t\t\t);\n// \t\t\tconst result = await response.json();\n// \t\t\tif (response.ok) {\n// \t\t\t  const sortedDocs = result.data.sort(\n// \t\t\t\t(a, b) => new Date(b.createdAt) - new Date(a.createdAt)\n// \t\t\t  );\n// \t\t\t  setDocuments(sortedDocs);\n// \t\t\t} else {\n// \t\t\t  console.error(\"Error fetching documents:\", result.message);\n// \t\t\t}\n// \t\t  } catch (error) {\n// \t\t\tconsole.error(\"Error fetching documents:\", error);\n// \t\t  }\n// \t\t};\n// \t\tfetchDocuments();\n// \t  }, [email]);\n// \t  // Handle document selection from history\n//   const handleDocumentClick = (doc) => {\n//     setSelectedDocument(doc);\n//     setInputText(doc.inputText);\n//   };\n//   \tconst handleFileUpload = async (event) => {\n// \t  const file = event.target.files[0];\n// \t  setPdfPath(`/uploads/${file.name}`);    \n// \t  if (!file) return;\n// \t  setIsUploading(true); // Show buffer while processing\n// \t  setUploadedFileName(file.name); // Set file name\n// \t  try {\n// \t\t//setUploadedFileName(file.name); // Set the uploaded file name\n// \t\tconst fileReader = new FileReader();\n// \t\tfileReader.onload = async function () {\n// \t\t  const typedArray = new Uint8Array(this.result);\n// \t\t  const pdf = await pdfjsLib.getDocument(typedArray).promise;\n// \t\t  setPdfPageCount(pdf.numPages);\n// \t\t  let text = \"\";\n// \t\t  // Extract text from all pages\n// \t\t  for (let i = 1; i <= pdf.numPages; i++) {\n// \t\t\tconst page = await pdf.getPage(i);\n// \t\t\tconst textContent = await page.getTextContent();\n// \t\t\ttext += textContent.items.map((item) => item.str).join(\" \");\n// \t\t  }\n// \t\t  setInputText(text);\n// \t\t};\n// \t\tfileReader.readAsArrayBuffer(file);\n// \t  } catch (error) {\n// \t\tconsole.error(\"Error reading PDF:\", error);\n// \t\talert(\"Failed to extract text from the PDF.\");\n// \t  } finally {\n// \t\tsetIsUploading(false); // Hide buffer once done\n// \t  }\n// \t};\n// \tconst countWordsAndChars = (text) => {\n// \t\tconst words = text.trim().split(/\\s+/).filter(Boolean).length;\n// \t\tconst chars = text.length;\n// \t\treturn { words, chars };\n// \t  };\n// \t    useEffect(() => {\n// \t\t  const { words: inputWords, chars: inputChars } = countWordsAndChars(inputText);\n// \t\t  setInputWordCount(inputWords);\n// \t\t  setInputCharCount(inputChars);\n// \t\t}, [inputText]);\n// \t\tconst saveInitialSimplification = async (trimmedInput, cleanedOutput) => {\n// \t\t\tconst user = JSON.parse(localStorage.getItem(\"user\"));\n// \t\t\tif (!user) return;\n// \t\t\tawait fetch(\"https://textsimplification12-a0a8gqfbhnhxbgbv.westus-01.azurewebsites.net/api/simplifications\", {\n// \t\t\t\tmethod: \"POST\",\n// \t\t\t\theaders: { \"Content-Type\": \"application/json\" },\n// \t\t\t\tbody: JSON.stringify({\n// \t\t\t\tuserId: user._id,\n// \t\t\t\temail,\n// \t\t\t\tinputText: trimmedInput,\n// \t\t\t\toutputText: cleanedOutput,\n// \t\t\t\tpdfName: uploadedFileName || null,\n// \t\t\t\tpdfPath: pdfPath || null,\n// \t\t\t\t}),\n// \t\t\t});\n// \t\t};\n// \t\tconst generatePrompt = useCallback((inputText) => {\n// \t\t\tconst prefsText = prefsToPlain(customPrefs);\n// \t\t\treturn `\n// \t\t### USER‑SPECIFIC CUSTOMISATIONS (please follow **strictly**)\n// \t\t${prefsText || \"• No special preferences.\"}\n// \t\tYou are an expert in accessible communication, tasked with transforming complex text into clear, accessible plain language for individuals with Intellectual and Developmental Disabilities (IDD) or those requiring simplified content. Retain all essential information and intent while prioritizing readability, comprehension, and inclusivity.\n// \t\tText simplification refers to rewriting or adapting text to make it easier to read and understand while keeping the same level of detail and precision. Make sure you focus on simplification and not summarization. The length of generated output text must be similar to that of input text.\n// \t\tStick to the provided input text and only simplify the language. Don't provide the answer or hallucinate or provide any irrelevant information, not mentioned in the input text. \n// \t\tGuidelines for Simplification:\n// \t\tVocabulary and Terminology:\n// \t\tReplace uncommon, technical, or abstract words with simple, everyday language.\n// \t\tDefine unavoidable complex terms in plain language within parentheses upon first use (example: “cardiologist (heart doctor)”).\n// \t\tAvoid idioms, metaphors, sarcasm, or culturally specific references.\n// \t\tSentence Structure:\n// \t\tUse short sentences (10--15 words max). Break long sentences into 1–2 ideas each.\n// \t\tPrefer active voice (example: “The doctor examined the patient” vs. “The patient was examined by the doctor”).\n// \t\tAvoid nested clauses, passive voice, and ambiguous pronouns (example: “they,” “it”).\n// \t\tClarity and Flow:\n// \t\tOrganize content logically, using headings/subheadings to group related ideas.\n// \t\tUse bullet points or numbered lists for steps, options, or key points.\n// \t\tEnsure each paragraph focuses on one main idea.\n// \t\tTone and Engagement:\n// \t\tWrite in a neutral, conversational tone (avoid formal or academic language).\n// \t\tAddress the reader directly with “you” or “we” where appropriate.\n// \t\tUse consistent terms for concepts (avoid synonyms that may confuse).\n// \t\tAvoid Exclusionary Elements:\n// \t\tRemove jargon, acronyms (unless defined), and expand abbreviations if needed (example: “ASAP” → “as soon as possible”).\n// \t\tEliminate metaphors, idioms, or implied meanings (example: “hit the books” → “study”).\n// \t\tAvoid double negatives (example: “not uncommon” → “common”).\n// \t\tStructural Support:\n// \t\tAdd clear headings to label sections (example: “How to Apply for Benefits”).\n// \t\tUse formatting tools like bold for key terms or warnings.\n// \t\tChunk information into short paragraphs with line breaks for visual ease.\n// \t\tInclusivity Checks:\n// \t\tEnsure content is free of bias, stereotypes, or assumptions about the reader.\n// \t\tUse gender-neutral language (example: “they” instead of “he/she”).\n// \t\tOutput Requirements:\n// \t\tReturn only the simplified text, without markdown, emojis, or images.\n// \t\tPreserve original context, facts, and intent. Do not omit critical details.\n// \t\tPrioritize clarity over brevity; focus on simplification and not summarization. The length of generated output text should be same or similar to that of input text.\n// \t\tDo not simplify already simple text.\n// \t\tExample Transformation:\n// \t\tOriginal: “Individuals experiencing adverse climatic conditions may necessitate relocation to mitigate health risks.”\n// \t\tSimplified: “If weather conditions become dangerous, people might need to move to stay safe.”\n// \t\tFor the provided input text, apply the above guidelines rigorously. Ensure the output is accessible to readers with varied cognitive abilities, emphasizing clarity, simplicity, and logical structure. Verify that the simplified text aligns with plain language standards like WCAG and PlainLanguage.gov.\n// \t\t\"${inputText}\"\n// \t\t`;\n// \t\t  }, [customPrefs]);\n//   const splitTextIntoChunks = (text, maxTokens) => {\n// \tconst words = text.split(\" \");\n// \tlet chunks = [];\n// \tlet currentChunk = [];\n// \tfor (let word of words) {\n// \t  if (currentChunk.join(\" \").length + word.length < maxTokens) {\n// \t\tcurrentChunk.push(word);\n// \t  } else {\n// \t\tchunks.push(currentChunk.join(\" \"));\n// \t\tcurrentChunk = [word];\n// \t  }\n// \t}\n// \tif (currentChunk.length > 0) chunks.push(currentChunk.join(\" \"));\n// \treturn chunks;\n//   };\n//   const handleSubmit = async () => {\n// \t// const inputText = document.getElementById('inputText').value;\n// \tconst trimmedInput = inputText.trim();\n// \tif (!trimmedInput) return;\n// \t// inputTextSnapshot.current = inputText; \n// \tsetIsLoading(true);\n// \ttry {\n// \t  const chunks = splitTextIntoChunks(trimmedInput, 1000);\n// \t  let combinedOutput = \"\";\n// \t  for (let chunk of chunks) {\n// \t\tconst prompt = generatePrompt(chunk);\n// \t\tconst response = await fetch(\"https://textsimplification12-a0a8gqfbhnhxbgbv.westus-01.azurewebsites.net/api/gpt4\", {\n// \t\t  method: \"POST\",\n// \t\t  headers: { \"Content-Type\": \"application/json\" },\n// \t\t  body: JSON.stringify({ prompt }),\n// \t\t});\n// \t\tif (!response.ok) {\n// \t\t\tconsole.error(`API request failed with status: ${response.status}`);\n// \t\t\tcontinue; // Skip this chunk if the API request failed\n// \t\t  }\n// \t\tconst data = await response.json();\n// \t\tconsole.log(\"Full API Response: \", data);\n// \t\tconst data1 = data?.response?.replace(/^\"|\"$/g, \"\") || \"No response received.\"; // Append results\n// \t\tcombinedOutput += data1 + \" \";\n// \t}\n// \t  console.log(\"Final Combined Output: \", combinedOutput);\n// \tconsole.log(\"Data: \", combinedOutput);\n// \tconst cleanedResponse = combinedOutput.trim();\n// \tsetOutputText(cleanedResponse);\n// \tsetIsSubmitted(true);\n// \tawait saveInitialSimplification(trimmedInput, cleanedResponse);\n// \tnavigate(\"/review\", { state: { inputText: trimmedInput, outputText: cleanedResponse } });\n// \t// navigate(\"/review\", { state: { inputText: trimmedInput, outputText: cleanedResponse } });\n// \t} catch (error) {\n// \t  console.error(\"Error fetching GPT-4o response:\", error);\n// \t  setOutputText(\"An error occurred while simplifying the text.\");\n// \t}\n// \tsetIsLoading(false);\n//   };\n//   return (\n//     <>\n//       <nav className={styles.navbar}>\n//         {/* <h1>Text Simplification Tool</h1> */}\n// \t\t<h1 \n//     onClick={() => window.location.href = \"https://textsimplification12-a0a8gqfbhnhxbgbv.westus-01.azurewebsites.net/\"}\n//     style={{ cursor: \"pointer\" }} // Makes it look clickable\n//  \t\t>\n// \t\tText Simplification Tool</h1>\n//         <button className={styles.white_btn} onClick={handleLogout}>\n//           Logout\n//         </button>\n//       </nav>\n// \t  <div className={styles.container}>\n// \t\t\t <div\n// \t\t\t\t  className={`${styles.sidebar} ${\n// \t\t\t\t\tisSidebarVisible ? styles.expanded : \"\"\n// \t\t\t\t  }`}\n// \t\t\t\t>\n// \t\t\t{/* </div> */}\n// \t\t\t<button\n// \t\t\tclassName={styles.historyIcon}\n// \t\t\tonClick={() => setIsSidebarVisible(!isSidebarVisible)}\n// \t\t\t>\n// \t\t\t\t🕒   <p style={{ fontSize: \"15px\" }}> History </p> \n// \t\t\t</button>\n//           {isSidebarVisible && (\n//             <div className={styles.historyContent}>\n//               <button className={styles.closeButton} onClick={() => setIsSidebarVisible(false)}>\n//                 ✖\n//               </button>\n//               <ul className={styles.historyList}>\n//                 {documents.map((doc, index) => (\n// \t\t\t\t<li\n// \t\t\t\tkey={doc._id}\n// \t\t\t\tonClick={() => handleDocumentClick(doc)}\n// \t\t\t\tclassName={`${styles.historyItem} ${selectedDocument?._id === doc._id ? styles.activeDoc : \"\"}`}\n// \t\t\t\t>\n// \t\t\t\t{/* <strong>Document {index + 1}</strong>  */}\n// \t\t\t\t<strong>Document {documents.length - index}</strong>({doc.inputText.substring(0, 20)}...)\n// \t\t\t\t</li>\n//                 ))}\n//               </ul>\n//             </div>\n//           )}\n//         </div>\n// \t  {/* <div className={styles.main_container}> */}\n// \t  <div className={`${styles.mainContent} ${isSidebarVisible ? styles.withSidebar : \"\"}`}>\n// \t\t\t<div className={styles.description}>\n// \t\t\t  <p>\n// \t\t\t  This tool helps make complex text easier to read while preserving its original meaning. Whether you're simplifying academic content, technical documents, or general text for better accessibility, this tool provides a quick and efficient way to generate a more readable version. You can enter text manually or upload a document to get started.\n// \t\t\t  </p>\n// \t</div>\n// \t        {/* ─── (2)  CUSTOMISATION PANEL  ─────────── */}\n// \t\t\t<section className={styles.customPanel}>\n//           {/* toggle row */}\n//           <button\n//             className={styles.customToggle}\n//             onClick={() => setShowCustom((s) => !s)}\n//           >\n//             {showCustom ? \"▲  Hide Customisation Options\" : \"▼  Show Customisation Options\"}\n//           </button>\n// \t\t  <div\n// \t\t\tclassName={`${styles.customPanel} ${\n// \t\t\t\tshowCustom ? \"\" : styles.hiddenPanel   // ←  just hide with CSS\n// \t\t\t}`}\n// \t\t\t>\n//             <div className={styles.customBody}>\n//               {/* 2‑A  ▸ Output length ------------------------------------------------ */}\n//               <h3>Output Length</h3>\n//               <div className={styles.flexRow}>\n//                 <label className={styles.block}>\n//                   <input type=\"radio\" name=\"lenPreset\" value=\"50\"     checked={outputLen === \"50\"}      /* ← NEW */\n//     onChange={(e) => setOutputLen(e.target.value)}/> 50 words\n//                 </label>\n//                 <label className={styles.block}>\n//                   <input type=\"radio\" name=\"lenPreset\" value=\"150\"     checked={outputLen === \"150\"}      /* ← NEW */\n//     onChange={(e) => setOutputLen(e.target.value)}/> 150 words\n//                 </label>\n//                 <label className={styles.block}>\n//                   <input type=\"radio\" name=\"lenPreset\" value=\"300\"     checked={outputLen === \"300\"}      /* ← NEW */\n//     onChange={(e) => setOutputLen(e.target.value)}/> 300 words\n//                 </label>\n//                 <label className={styles.block}>\n//                   <input type=\"radio\" name=\"lenPreset\" value=\"500\"    checked={outputLen === \"500\"}      /* ← NEW */\n//     onChange={(e) => setOutputLen(e.target.value)} /> 500 words\n//                 </label>\n//                 <label className={styles.block}>\n//                   <input type=\"radio\" name=\"lenPreset\" value=\"custom\"    checked={outputLen === \"custom\" } onChange={(e) => setOutputLen(e.target.value)}      /* ← NEW */\n//    /> Custom:{\" \"}\n//                   <input\n//                     type=\"number\"\n//                     min=\"10\"\n//                     style={{ width: \"5rem\" }}\n//                     onChange={(e) => setCustomLen(e.target.value)}\n//                   />{\" \"}\n//                   words\n//                 </label>\n//               </div>\n//               <h3>Reduce original text by</h3>\n//               <div className={styles.flexRow}>\n//                 {[\"0\", \"25\", \"50\", \"75\", \"90\"].map((pct) => (\n//                   <label key={pct} className={styles.block}>\n//                     <input\n//                       type=\"radio\"\n//                       name=\"reducePct\"\n//                       value={pct}\n//                       defaultChecked={pct === \"0\"}\n//                     />{\" \"}\n//                     {pct}%{pct === \"0\" ? \" (No reduction)\" : \"\"}\n//                   </label>\n//                 ))}\n//               </div>\n//               {/* 2‑B  ▸ Reading level ---------------------------------------------- */}\n//               <h3>Reading Level</h3>\n//               <div className={styles.flexRow}>\n//                 {[\n//                   \"Are learning to read\",\n//                   \"Need simple vocabulary\",\n//                   \"Prefer shorter sentences\",\n//                   \"Can handle complex concepts but need clear explanations\",\n//                   \"Are professionals in this field\",\n//                 ].map((txt) => (\n//                   <label key={txt} className={styles.block}>\n//                     <input type=\"checkbox\" name=\"readingLevel\" value={txt} />{\" \"}\n//                     {txt}\n//                   </label>\n//                 ))}\n//               </div>\n//               {/* 2‑C  ▸ Tone / style ---------------------------------------------- */}\n//               <h3>Tone &amp; Style</h3>\n//               <div className={styles.flexRow}>\n//                 {[\n//                   \"Casual/Conversational\",\n//                   \"Professional/Formal\",\n//                   \"Academic/Instructional\",\n//                   \"Creative/Enthusiastic\",\n//                   \"Neutral/Objective\",\n//                 ].map((tone) => (\n//                   <label key={tone} className={styles.block}>\n//                     <input type=\"radio\" name=\"tone\" value={tone} /> {tone}\n//                   </label>\n//                 ))}\n//               </div>\n//               {/* 2‑D  ▸ Sentence structure ---------------------------------------- */}\n//               <h3>Sentence Structure Preferences</h3>\n//               <div className={styles.flexRow}>\n//                 {[\n//                   \"Bullet points instead of paragraphs\",\n//                   \"Numbered sequences for steps\",\n//                   \"Headings to break up content\",\n//                   \"White space between key ideas\",\n//                   \"Convert passive to active voice\",\n//                   \"Break up sentences longer than 10--15 words words\",\n//                   \"Simplify nested clauses\",\n//                   \"Reduce prepositional phrases\",\n//                 ].map((opt) => (\n//                   <label key={opt} className={styles.block}>\n//                     <input type=\"checkbox\" name=\"structure\" value={opt} /> {opt}\n//                   </label>\n//                 ))}\n//               </div>\n//               {/* 2‑E  ▸ Free‑text box -------------------------------------------- */}\n//               <h3>Anything else?</h3>\n//               <textarea\n//                 rows={3}\n//                 placeholder=\"Type any additional preferences here…\"\n//                 onChange={(e) => setExtraPrefs(e.target.value)}\n//               />\n//             </div>\n// \t\t\t</div>\n//         </section>\n// \t\t{/*  */}\n// \t\t\t  <div className={styles.form_container}>\n// \t\t\t\t{/* Input Area */}\n// \t\t\t\t<div className={styles.input_area}>\n// \t\t\t\t  <div className={styles.text_container}>\n// \t\t\t\t\t<label className={styles.label} htmlFor=\"inputText\">\n// \t\t\t\t\t  Input Text\n// \t\t\t\t\t</label>\n// \t\t\t\t\t<textarea\n// \t\t\t\t\t  id=\"inputText\"\n// \t\t\t\t\t  className={`${styles.textarea} ${isLoading ? styles.disabled : \"\"}`}\n// \t\t\t\t\t//   className={styles.textarea}\n// \t\t\t\t\t  placeholder=\"Write/Paste your text here or upload a PDF document to extract content automatically.\"\n// \t\t\t\t\t  value={inputText}\n// \t\t\t\t\t  onChange={(e) => setInputText(e.target.value)}\n// \t\t\t\t\t  disabled={isLoading} // Disable input when loading\n// \t\t\t\t\t></textarea>\n// \t\t\t\t <p className={styles.countText}>Words: {inputWordCount} | Characters: {inputCharCount}\n// \t\t\t\t {pdfPageCount > 0 && ` | Pages: ${pdfPageCount}`}\n// \t\t\t\t </p>\n// \t\t\t\t  </div>\n// \t\t\t\t  {/* OR Divider */}\n// \t\t\t\t  <div className={styles.or_divider}>OR</div>\n// \t\t\t\t  {/* File Upload */}\n// \t\t\t\t  <div className={`${styles.upload_area} ${isLoading ? styles.disabled : \"\"}`}\n// \t\t\t\t\tonDragOver={(e) => e.preventDefault()} // Prevent default behavior\n// \t\t\t\t\tonDrop={(e) => {\n// \t\t\t\t\t\te.preventDefault();\n// \t\t\t\t\t\tconst file = e.dataTransfer.files[0]; // Get the first dropped file\n// \t\t\t\t\t\tif (file) {\n// \t\t\t\t\t\thandleFileUpload({ target: { files: [file] } }); // Simulate file selection event\n// \t\t\t\t\t\t}\n// \t\t\t\t\t}}>\n// \t\t\t\t\t<label htmlFor=\"fileUpload\" className={styles.upload_box}>\n// \t\t\t\t\t\t{isUploading ? (\n// \t\t\t\t\t\t\t<span className={styles.loadingText}>Extracting text, please wait...</span>\n// \t\t\t\t\t\t\t) : uploadedFileName ? (\n// \t\t\t\t\t\t\t<>\n// \t\t\t\t\t\t\t\tFile uploaded: <strong>{uploadedFileName}</strong>\n// \t\t\t\t\t\t\t</>\n// \t\t\t\t\t\t\t) : (\n// \t\t\t\t\t\t\t<>\n// \t\t\t\t\t\t\t\tClick to Upload a PDF\n// \t\t\t\t\t\t\t\t<br />\n// \t\t\t\t\t\t\t\t<span>...or drag and drop a file.</span>\n// \t\t\t\t\t\t\t</>\n// \t\t\t\t\t\t)}\n// \t\t\t\t\t</label>\n// \t\t\t\t\t<input\n// \t\t\t\t\t  type=\"file\"\n// \t\t\t\t\t  id=\"fileUpload\"\n// \t\t\t\t\t  accept=\"application/pdf\"\n// \t\t\t\t\t  onChange={handleFileUpload}\n// \t\t\t\t\t  className={styles.hidden_input}\n// \t\t\t\t\t  disabled={isUploading || isLoading} // Disable upload while processing\n// \t\t\t\t\t  //disabled={isUploading} // Disable upload while processing\n// \t\t\t\t\t/>\n// \t\t\t\t  </div>\n// \t\t\t\t</div>\n// \t\t\t  </div>\n// \t\t\t  {/* Submit Button */}\n// \t\t\t  <button\n// \t\t\t\tclassName={styles.submit_btn}\n// \t\t\t\tonClick={handleSubmit}\n// \t\t\t\tdisabled={!inputText.trim() || isLoading || isUploading}\n// \t\t\t\tid=\"simplifyBtn\"\n// \t\t\t\t//title={!inputText.trim() ? \"Enter text or upload a file to enable simplification.\" : \"\"}\n// \t\t\t  >\n// \t\t\t\t{isLoading ? \"Processing...\" : \"Simplify Text\"}\n// \t\t\t  </button>\n// \t\t\t  <p className={styles.help_text}>Need Help? <a href=\"mailto:anukumar@uw.edu\">Contact Support</a></p>\n// \t\t\t  <Footer />  \n//       </div>\n//       </div>\n//     </>\n//   );\n// };\n// export default Main;\n// v2\n// import React, { useState, useEffect, useRef, useCallback  } from \"react\";\n// import styles from \"./styles.module.css\";\n// import { useNavigate } from \"react-router-dom\";\n// import * as pdfjsLib from \"pdfjs-dist/legacy/build/pdf\";\n// // import { BrowserRouter as Router, Routes, Route, useNavigate } from \"react-router-dom\";\n// import { jwtDecode } from \"jwt-decode\";\n// import Footer from \"../Footer\";\n// import { calcMetrics } from \"../../utils/textMetrics\";\n// import StatsButton from \"../StatsButton\";\n// pdfjsLib.GlobalWorkerOptions.workerSrc = `${process.env.PUBLIC_URL}/pdf.worker.mjs`;\n// // Updated prefsToPlain function to work with expanded structure preferences\n// const prefsToPlain = (inputWordCount, outputLength, customWordCount, structurePrefs, tonePreference) => {\n//   const sections = [];\n//   // Helper function to calculate word counts\n//   const calculateWordCount = (inputWordCount, type, customWordCount) => {\n//     switch(type) {\n//       case \"shorter\": return Math.round(inputWordCount * 0.75);\n//       case \"much_shorter\": return Math.round(inputWordCount * 0.5);\n//       case \"custom\": return customWordCount;\n//       default: return inputWordCount;\n//     }\n//   };\n//   // Output length\n//   const targetWordCount = calculateWordCount(inputWordCount, outputLength, customWordCount);\n//   if (outputLength !== \"same\") {\n//     sections.push(`• Limit final output to **${targetWordCount} words**.`);\n//   }\n//   // Organization & Structure\n//   const organizationPrefs = [];\n//   if (structurePrefs.sectionHeadings) organizationPrefs.push(\"add clear section headings\");\n//   if (structurePrefs.bulletLists) organizationPrefs.push(\"use bullet points or numbered lists for sequences and key points\");\n//   if (structurePrefs.shortParagraphs) organizationPrefs.push(\"keep paragraphs to 2-3 sentences maximum\");\n//   if (structurePrefs.addWhiteSpace) organizationPrefs.push(\"add white space between key ideas for visual breaks\");\n//   if (organizationPrefs.length > 0) {\n//     sections.push(\"• Organization: \" + organizationPrefs.join(\", \") + \".\");\n//   }\n//   // Sentence Structure\n//   const sentencePrefs = [];\n//   if (structurePrefs.sentenceSplitting) sentencePrefs.push(\"break sentences longer than 10-15 words\");\n//   if (structurePrefs.activeVoice) sentencePrefs.push(\"convert passive voice to active voice\");\n//   if (structurePrefs.avoidNestedClauses) sentencePrefs.push(\"simplify nested clauses and complex sentence structures\");\n//   if (structurePrefs.clearPronouns) sentencePrefs.push(\"avoid ambiguous pronouns like 'they,' 'it,' 'this'\");\n//   if (sentencePrefs.length > 0) {\n//     sections.push(\"• Sentence structure: \" + sentencePrefs.join(\", \") + \".\");\n//   }\n//   // Vocabulary & Clarity\n//   const vocabularyPrefs = [];\n//   if (structurePrefs.useEverydayLanguage) vocabularyPrefs.push(\"replace complex words with simple, everyday language\");\n//   if (structurePrefs.defineComplexTerms) vocabularyPrefs.push(\"define unavoidable complex terms in parentheses\");\n//   if (structurePrefs.expandAcronyms) vocabularyPrefs.push(\"expand acronyms and abbreviations\");\n//   if (structurePrefs.avoidJargon) vocabularyPrefs.push(\"remove technical jargon and specialized language\");\n//   if (structurePrefs.avoidIdioms) vocabularyPrefs.push(\"avoid idioms, metaphors, and culturally specific references\");\n//   if (structurePrefs.avoidDoubleNegatives) vocabularyPrefs.push(\"eliminate double negatives and use positive statements\");\n//   if (structurePrefs.consistentTerms) vocabularyPrefs.push(\"use consistent terminology and avoid confusing synonyms\");\n//   if (vocabularyPrefs.length > 0) {\n//     sections.push(\"• Vocabulary: \" + vocabularyPrefs.join(\", \") + \".\");\n//   }\n//   // Engagement & Formatting\n//   const engagementPrefs = [];\n//   if (structurePrefs.directAddress) engagementPrefs.push(\"use direct address with 'you' or 'we' where appropriate\");\n//   if (structurePrefs.boldKeyTerms) engagementPrefs.push(\"use bold formatting for key terms and warnings\");\n//   if (engagementPrefs.length > 0) {\n//     sections.push(\"• Engagement: \" + engagementPrefs.join(\", \") + \".\");\n//   }\n//   // Tone\n//   if (tonePreference !== \"neutral\") {\n//     sections.push(`• Use a **${tonePreference}** tone while maintaining accessibility.`);\n//   }\n//   return sections.length ? sections.join(\"\\n\") : \"• Follow standard text simplification guidelines.\";\n// };\n// const Main = () => {\n// \tconst [inputText, setInputText] = useState(\"\");\n// \tconst [outputText, setOutputText] = useState(\"\");\n// \tconst [isLoading, setIsLoading] = useState(false);\n// \tconst [isSubmitted, setIsSubmitted] = useState(false);\n// \tconst [isEditable, setIsEditable] = useState(false); // For toggling edit mode\n// \tconst [uploadedFileName, setUploadedFileName] = useState(\"\"); // State for file name\n// \tconst [isSaveButtonVisible, setIsSaveButtonVisible] = useState(true);\n// \tconst [showSurveyPrompt, setShowSurveyPrompt] = useState(false); // State for survey prompt\n// \tconst [documents, setDocuments] = useState([]); // Store user documents\n// \tconst [selectedDocument, setSelectedDocument] = useState(null); // Selected doc\n// \tconst [isSidebarVisible, setIsSidebarVisible] = useState(false); // Sidebar toggle\n// \tconst navigate = useNavigate();\n// \tconst [isUploading, setIsUploading] = useState(false); // State for showing buffer\n// \tconst user = JSON.parse(localStorage.getItem(\"user\"));\n// \tconst email = user?.email;\n// \tconst [inputWordCount, setInputWordCount] = useState(0);\n// \tconst [inputCharCount, setInputCharCount] = useState(0);\n// \tconst [pdfPageCount, setPdfPageCount] = useState(0);\n// \tconst inputTextSnapshot = useRef(\"\");\n// \tconst [pdfPath, setPdfPath] = useState(\"\"); \n// \t// Updated state variables for your customization requirements\n// \tconst [outputLength, setOutputLength] = useState(\"same\"); // \"same\", \"shorter\", \"much_shorter\", \"custom\"\n// \tconst [customWordCount, setCustomWordCount] = useState(\"\");\n// \t// Structure preferences - extracted from your existing prompt\n// \tconst [structurePrefs, setStructurePrefs] = useState({\n// \t  // Organization & Structure\n// \t  sectionHeadings: true,\n// \t  bulletLists: true,\n// \t  shortParagraphs: true,\n// \t  // Sentence Structure\n// \t  sentenceSplitting: true,\n// \t  activeVoice: true,\n// \t  avoidNestedClauses: true,\n// \t  clearPronouns: true,\n// \t  // Vocabulary & Clarity\n// \t  defineComplexTerms: true,\n// \t  expandAcronyms: true,\n// \t  avoidJargon: true,\n// \t  avoidIdioms: true,\n// \t  avoidDoubleNegatives: true,\n// \t  useEverydayLanguage: true,\n// \t  // Formatting & Visual\n// \t  boldKeyTerms: true,\n// \t  addWhiteSpace: true,\n// \t  directAddress: true, // Use \"you\" or \"we\"\n// \t  consistentTerms: true, // Avoid synonyms that may confuse\n// \t  // Special Features\n// \t  showChanges: false // This one defaults to OFF\n// \t});\n// \tconst [tonePreference, setTonePreference] = useState(\"neutral\"); // \"neutral\", \"academic\", \"formal\", \"creative\"\n// \tconst [showCustom,  setShowCustom]  = useState(false);  // accordion open/close\n// \t// Helper function to calculate word counts based on input\n// \tconst calculateWordCount = (inputWordCount, type) => {\n// \t  switch(type) {\n// \t\tcase \"shorter\": return Math.round(inputWordCount * 0.75);\n// \t\tcase \"much_shorter\": return Math.round(inputWordCount * 0.5);\n// \t\tcase \"custom\": return customWordCount;\n// \t\tdefault: return inputWordCount;\n// \t  }\n// \t};\n// \t// Toggle function for structure preferences\n// \tconst toggleStructurePref = (key) => {\n// \t  setStructurePrefs(prev => ({\n// \t\t...prev,\n// \t\t[key]: !prev[key]\n// \t  }));\n// \t};\n//   const handleLogout = () => {\n//     localStorage.removeItem(\"token\");\n//     navigate(\"/Login\"); \n//   };\n//     // Load user's past documents (original texts only)\n// \tuseEffect(() => {\n// \t\tif (!email) return;\n// \t\tconst fetchDocuments = async () => {\n// \t\t  try {\n// \t\t\tconst response = await fetch(\n// \t\t\t  `https://textsimplification12-a0a8gqfbhnhxbgbv.westus-01.azurewebsites.net/api/simplifications/user/${email}`\n// \t\t\t);\n// \t\t\tconst result = await response.json();\n// \t\t\tif (response.ok) {\n// \t\t\t  const sortedDocs = result.data.sort(\n// \t\t\t\t(a, b) => new Date(b.createdAt) - new Date(a.createdAt)\n// \t\t\t  );\n// \t\t\t  setDocuments(sortedDocs);\n// \t\t\t} else {\n// \t\t\t  console.error(\"Error fetching documents:\", result.message);\n// \t\t\t}\n// \t\t  } catch (error) {\n// \t\t\tconsole.error(\"Error fetching documents:\", error);\n// \t\t  }\n// \t\t};\n// \t\tfetchDocuments();\n// \t  }, [email]);\n// \t  // Handle document selection from history\n//   const handleDocumentClick = (doc) => {\n//     setSelectedDocument(doc);\n//     setInputText(doc.inputText);\n//   };\n//   \tconst handleFileUpload = async (event) => {\n// \t  const file = event.target.files[0];\n// \t  setPdfPath(`/uploads/${file.name}`);    \n// \t  if (!file) return;\n// \t  setIsUploading(true); // Show buffer while processing\n// \t  setUploadedFileName(file.name); // Set file name\n// \t  try {\n// \t\t//setUploadedFileName(file.name); // Set the uploaded file name\n// \t\tconst fileReader = new FileReader();\n// \t\tfileReader.onload = async function () {\n// \t\t  const typedArray = new Uint8Array(this.result);\n// \t\t  const pdf = await pdfjsLib.getDocument(typedArray).promise;\n// \t\t  setPdfPageCount(pdf.numPages);\n// \t\t  let text = \"\";\n// \t\t  // Extract text from all pages\n// \t\t  for (let i = 1; i <= pdf.numPages; i++) {\n// \t\t\tconst page = await pdf.getPage(i);\n// \t\t\tconst textContent = await page.getTextContent();\n// \t\t\ttext += textContent.items.map((item) => item.str).join(\" \");\n// \t\t  }\n// \t\t  setInputText(text);\n// \t\t};\n// \t\tfileReader.readAsArrayBuffer(file);\n// \t  } catch (error) {\n// \t\tconsole.error(\"Error reading PDF:\", error);\n// \t\talert(\"Failed to extract text from the PDF.\");\n// \t  } finally {\n// \t\tsetIsUploading(false); // Hide buffer once done\n// \t  }\n// \t};\n// \tconst countWordsAndChars = (text) => {\n// \t\tconst words = text.trim().split(/\\s+/).filter(Boolean).length;\n// \t\tconst chars = text.length;\n// \t\treturn { words, chars };\n// \t  };\n// \t    useEffect(() => {\n// \t\t  const { words: inputWords, chars: inputChars } = countWordsAndChars(inputText);\n// \t\t  setInputWordCount(inputWords);\n// \t\t  setInputCharCount(inputChars);\n// \t\t}, [inputText]);\n// \t\tconst saveInitialSimplification = async (trimmedInput, cleanedOutput) => {\n// \t\t\tconst user = JSON.parse(localStorage.getItem(\"user\"));\n// \t\t\tif (!user) return;\n// \t\t\tawait fetch(\"https://textsimplification12-a0a8gqfbhnhxbgbv.westus-01.azurewebsites.net/api/simplifications\", {\n// \t\t\t\tmethod: \"POST\",\n// \t\t\t\theaders: { \"Content-Type\": \"application/json\" },\n// \t\t\t\tbody: JSON.stringify({\n// \t\t\t\tuserId: user._id,\n// \t\t\t\temail,\n// \t\t\t\tinputText: trimmedInput,\n// \t\t\t\toutputText: cleanedOutput,\n// \t\t\t\tpdfName: uploadedFileName || null,\n// \t\t\t\tpdfPath: pdfPath || null,\n// \t\t\t\t}),\n// \t\t\t});\n// \t\t};\n// \t\tconst generatePrompt = useCallback((inputText) => {\n// \t\t\tconst prefsText = prefsToPlain(inputWordCount, outputLength, customWordCount, structurePrefs, tonePreference);\n// \t\t\treturn `\n// \t\t### USER‑SPECIFIC CUSTOMISATIONS (please follow **strictly**)\n// \t\t${prefsText || \"• No special preferences.\"}\n// \t\tYou are an expert in accessible communication, tasked with transforming complex text into clear, accessible plain language for individuals with Intellectual and Developmental Disabilities (IDD) or those requiring simplified content. Retain all essential information and intent while prioritizing readability, comprehension, and inclusivity.\n// \t\tText simplification refers to rewriting or adapting text to make it easier to read and understand while keeping the same level of detail and precision. Make sure you focus on simplification and not summarization. The length of generated output text must be similar to that of input text.\n// \t\tStick to the provided input text and only simplify the language. Don't provide the answer or hallucinate or provide any irrelevant information, not mentioned in the input text. \n// \t\tGuidelines for Simplification:\n// \t\tVocabulary and Terminology:\n// \t\tReplace uncommon, technical, or abstract words with simple, everyday language.\n// \t\tDefine unavoidable complex terms in plain language within parentheses upon first use (example: \"cardiologist (heart doctor)\").\n// \t\tAvoid idioms, metaphors, sarcasm, or culturally specific references.\n// \t\tSentence Structure:\n// \t\tUse short sentences (10--15 words max). Break long sentences into 1–2 ideas each.\n// \t\tPrefer active voice (example: \"The doctor examined the patient\" vs. \"The patient was examined by the doctor\").\n// \t\tAvoid nested clauses, passive voice, and ambiguous pronouns (example: \"they,\" \"it\").\n// \t\tClarity and Flow:\n// \t\tOrganize content logically, using headings/subheadings to group related ideas.\n// \t\tUse bullet points or numbered lists for steps, options, or key points.\n// \t\tEnsure each paragraph focuses on one main idea.\n// \t\tTone and Engagement:\n// \t\tWrite in a neutral, conversational tone (avoid formal or academic language).\n// \t\tAddress the reader directly with \"you\" or \"we\" where appropriate.\n// \t\tUse consistent terms for concepts (avoid synonyms that may confuse).\n// \t\tAvoid Exclusionary Elements:\n// \t\tRemove jargon, acronyms (unless defined), and expand abbreviations if needed (example: \"ASAP\" → \"as soon as possible\").\n// \t\tEliminate metaphors, idioms, or implied meanings (example: \"hit the books\" → \"study\").\n// \t\tAvoid double negatives (example: \"not uncommon\" → \"common\").\n// \t\tStructural Support:\n// \t\tAdd clear headings to label sections (example: \"How to Apply for Benefits\").\n// \t\tUse formatting tools like bold for key terms or warnings.\n// \t\tChunk information into short paragraphs with line breaks for visual ease.\n// \t\tInclusivity Checks:\n// \t\tEnsure content is free of bias, stereotypes, or assumptions about the reader.\n// \t\tUse gender-neutral language (example: \"they\" instead of \"he/she\").\n// \t\tOutput Requirements:\n// \t\tReturn only the simplified text, without markdown, emojis, or images.\n// \t\tPreserve original context, facts, and intent. Do not omit critical details.\n// \t\tPrioritize clarity over brevity; focus on simplification and not summarization. The length of generated output text should be same or similar to that of input text.\n// \t\tDo not simplify already simple text.\n// \t\tExample Transformation:\n// \t\tOriginal: \"Individuals experiencing adverse climatic conditions may necessitate relocation to mitigate health risks.\"\n// \t\tSimplified: \"If weather conditions become dangerous, people might need to move to stay safe.\"\n// \t\tFor the provided input text, apply the above guidelines rigorously. Ensure the output is accessible to readers with varied cognitive abilities, emphasizing clarity, simplicity, and logical structure. Verify that the simplified text aligns with plain language standards like WCAG and PlainLanguage.gov.\n// \t\t\"${inputText}\"\n// \t\t`;\n// \t\t  }, [inputWordCount, outputLength, customWordCount, structurePrefs, tonePreference]);\n//   const splitTextIntoChunks = (text, maxTokens) => {\n// \tconst words = text.split(\" \");\n// \tlet chunks = [];\n// \tlet currentChunk = [];\n// \tfor (let word of words) {\n// \t  if (currentChunk.join(\" \").length + word.length < maxTokens) {\n// \t\tcurrentChunk.push(word);\n// \t  } else {\n// \t\tchunks.push(currentChunk.join(\" \"));\n// \t\tcurrentChunk = [word];\n// \t  }\n// \t}\n// \tif (currentChunk.length > 0) chunks.push(currentChunk.join(\" \"));\n// \treturn chunks;\n//   };\n//   const handleSubmit = async () => {\n// \t// const inputText = document.getElementById('inputText').value;\n// \tconst trimmedInput = inputText.trim();\n// \tif (!trimmedInput) return;\n// \t// inputTextSnapshot.current = inputText; \n// \tsetIsLoading(true);\n// \ttry {\n// \t  const chunks = splitTextIntoChunks(trimmedInput, 10000);\n// \t  let combinedOutput = \"\";\n// \t  for (let chunk of chunks) {\n// \t\tconst prompt = generatePrompt(chunk);\n// \t\tconst response = await fetch(\"https://textsimplification12-a0a8gqfbhnhxbgbv.westus-01.azurewebsites.net/api/gpt4\", {\n// \t\t  method: \"POST\",\n// \t\t  headers: { \"Content-Type\": \"application/json\" },\n// \t\t  body: JSON.stringify({ prompt }),\n// \t\t});\n// \t\tif (!response.ok) {\n// \t\t\tconsole.error(`API request failed with status: ${response.status}`);\n// \t\t\tcontinue; // Skip this chunk if the API request failed\n// \t\t  }\n// \t\tconst data = await response.json();\n// \t\tconsole.log(\"Full API Response: \", data);\n// \t\tconst data1 = data?.response?.replace(/^\"|\"$/g, \"\") || \"No response received.\"; // Append results\n// \t\tcombinedOutput += data1 + \" \";\n// \t}\n// \t  console.log(\"Final Combined Output: \", combinedOutput);\n// \tconsole.log(\"Data: \", combinedOutput);\n// \tconst cleanedResponse = combinedOutput.trim();\n// \tsetOutputText(cleanedResponse);\n// \tsetIsSubmitted(true);\n// \tawait saveInitialSimplification(trimmedInput, cleanedResponse);\n// \tnavigate(\"/review\", { state: { inputText: trimmedInput, outputText: cleanedResponse } });\n// \t// navigate(\"/review\", { state: { inputText: trimmedInput, outputText: cleanedResponse } });\n// \t} catch (error) {\n// \t  console.error(\"Error fetching GPT-4o response:\", error);\n// \t  setOutputText(\"An error occurred while simplifying the text.\");\n// \t}\n// \tsetIsLoading(false);\n//   };\n//   return (\n//     <>\n//       <nav className={styles.navbar}>\n//         {/* <h1>Text Simplification Tool</h1> */}\n// \t\t<h1 \n//     onClick={() => window.location.href = \"https://textsimplification12-a0a8gqfbhnhxbgbv.westus-01.azurewebsites.net/\"}\n//     style={{ cursor: \"pointer\" }} // Makes it look clickable\n//  \t\t>\n// \t\tText Simplification Tool</h1>\n//         <button className={styles.white_btn} onClick={handleLogout}>\n//           Logout\n//         </button>\n//       </nav>\n// \t  <div className={styles.container}>\n// \t\t\t <div\n// \t\t\t\t  className={`${styles.sidebar} ${\n// \t\t\t\t\tisSidebarVisible ? styles.expanded : \"\"\n// \t\t\t\t  }`}\n// \t\t\t\t>\n// \t\t\t{/* </div> */}\n// \t\t\t<button\n// \t\t\tclassName={styles.historyIcon}\n// \t\t\tonClick={() => setIsSidebarVisible(!isSidebarVisible)}\n// \t\t\t>\n// \t\t\t\t🕒   <p style={{ fontSize: \"15px\" }}> History </p> \n// \t\t\t</button>\n//           {isSidebarVisible && (\n//             <div className={styles.historyContent}>\n//               <button className={styles.closeButton} onClick={() => setIsSidebarVisible(false)}>\n//                 ✖\n//               </button>\n//               <ul className={styles.historyList}>\n//                 {documents.map((doc, index) => (\n// \t\t\t\t<li\n// \t\t\t\tkey={doc._id}\n// \t\t\t\tonClick={() => handleDocumentClick(doc)}\n// \t\t\t\tclassName={`${styles.historyItem} ${selectedDocument?._id === doc._id ? styles.activeDoc : \"\"}`}\n// \t\t\t\t>\n// \t\t\t\t{/* <strong>Document {index + 1}</strong>  */}\n// \t\t\t\t<strong>Document {documents.length - index}</strong>({doc.inputText.substring(0, 20)}...)\n// \t\t\t\t</li>\n//                 ))}\n//               </ul>\n//             </div>\n//           )}\n//         </div>\n// \t  {/* <div className={styles.main_container}> */}\n// \t  <div className={`${styles.mainContent} ${isSidebarVisible ? styles.withSidebar : \"\"}`}>\n// \t\t\t<div className={styles.description}>\n// \t\t\t  <p>\n// \t\t\t  This tool helps make complex text easier to read while preserving its original meaning. Whether you're simplifying academic content, technical documents, or general text for better accessibility, this tool provides a quick and efficient way to generate a more readable version. You can enter text manually or upload a document to get started.\n// \t\t\t  </p>\n// \t</div>\n// \t        {/* ─── CUSTOMISATION PANEL  ─────────── */}\n// \t\t\t<section className={styles.customPanel}>\n// \t\t\t  {/* toggle row */}\n// \t\t\t  <button\n// \t\t\t\tclassName={styles.customToggle}\n// \t\t\t\tonClick={() => setShowCustom((s) => !s)}\n// \t\t\t  >\n// \t\t\t\t{showCustom ? \"▲  Hide Customisation Options\" : \"▼  Show Customisation Options\"}\n// \t\t\t  </button>\n// \t\t\t  <div className={`${styles.customPanel} ${showCustom ? \"\" : styles.hiddenPanel}`}>\n// \t\t\t\t<div className={styles.customBody}>\n// \t\t\t\t  {/* 1. OUTPUT LENGTH SECTION */}\n// \t\t\t\t  <h3>Output Length</h3>\n// \t\t\t\t  <div className={styles.sliderContainer}>\n// \t\t\t\t\t{/* Visual slider representation */}\n// \t\t\t\t\t<div className={styles.sliderTrack}>\n// \t\t\t\t\t  <div className={styles.sliderMarkers}>\n// \t\t\t\t\t\t<span className={outputLength === \"same\" ? styles.activeMarker : styles.marker}>•</span>\n// \t\t\t\t\t\t<span className={outputLength === \"shorter\" ? styles.activeMarker : styles.marker}>•</span>\n// \t\t\t\t\t\t<span className={outputLength === \"much_shorter\" ? styles.activeMarker : styles.marker}>•</span>\n// \t\t\t\t\t  </div>\n// \t\t\t\t\t  <div className={styles.sliderLabels}>\n// \t\t\t\t\t\t<span>Same as input</span>\n// \t\t\t\t\t\t<span>Shorter</span>\n// \t\t\t\t\t\t<span>Much shorter</span>\n// \t\t\t\t\t  </div>\n// \t\t\t\t\t</div>\n// \t\t\t\t\t{/* Radio buttons for selection */}\n// \t\t\t\t\t<div className={styles.lengthOptions}>\n// \t\t\t\t\t  <label className={styles.lengthOption}>\n// \t\t\t\t\t\t<input \n// \t\t\t\t\t\t  type=\"radio\" \n// \t\t\t\t\t\t  name=\"outputLength\" \n// \t\t\t\t\t\t  value=\"same\"\n// \t\t\t\t\t\t  checked={outputLength === \"same\"}\n// \t\t\t\t\t\t  onChange={(e) => setOutputLength(e.target.value)}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span>Same as input ({inputWordCount} words)</span>\n// \t\t\t\t\t  </label>\n// \t\t\t\t\t  <label className={styles.lengthOption}>\n// \t\t\t\t\t\t<input \n// \t\t\t\t\t\t  type=\"radio\" \n// \t\t\t\t\t\t  name=\"outputLength\" \n// \t\t\t\t\t\t  value=\"shorter\"\n// \t\t\t\t\t\t  checked={outputLength === \"shorter\"}\n// \t\t\t\t\t\t  onChange={(e) => setOutputLength(e.target.value)}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span>Shorter (~{Math.round(inputWordCount * 0.75)} words - 25% less)</span>\n// \t\t\t\t\t  </label>\n// \t\t\t\t\t  <label className={styles.lengthOption}>\n// \t\t\t\t\t\t<input \n// \t\t\t\t\t\t  type=\"radio\" \n// \t\t\t\t\t\t  name=\"outputLength\" \n// \t\t\t\t\t\t  value=\"much_shorter\"\n// \t\t\t\t\t\t  checked={outputLength === \"much_shorter\"}\n// \t\t\t\t\t\t  onChange={(e) => setOutputLength(e.target.value)}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span>Much shorter (~{Math.round(inputWordCount * 0.5)} words - 50% less)</span>\n// \t\t\t\t\t  </label>\n// \t\t\t\t\t  <label className={styles.lengthOption}>\n// \t\t\t\t\t\t<input \n// \t\t\t\t\t\t  type=\"radio\" \n// \t\t\t\t\t\t  name=\"outputLength\" \n// \t\t\t\t\t\t  value=\"custom\"\n// \t\t\t\t\t\t  checked={outputLength === \"custom\"}\n// \t\t\t\t\t\t  onChange={(e) => setOutputLength(e.target.value)}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span>Custom: </span>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"number\"\n// \t\t\t\t\t\t  min=\"10\"\n// \t\t\t\t\t\t  placeholder=\"Enter word count\"\n// \t\t\t\t\t\t  value={customWordCount}\n// \t\t\t\t\t\t  onChange={(e) => setCustomWordCount(e.target.value)}\n// \t\t\t\t\t\t  disabled={outputLength !== \"custom\"}\n// \t\t\t\t\t\t  style={{ width: \"100px\", marginLeft: \"8px\" }}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span> words</span>\n// \t\t\t\t\t  </label>\n// \t\t\t\t\t</div>\n// \t\t\t\t  </div>\n// \t\t\t\t  {/* 2. STRUCTURE & WRITING PREFERENCES */}\n// \t\t\t\t  <h3>Structure & Writing Preferences</h3>\n// \t\t\t\t  <div className={styles.structurePrefs}>\n// \t\t\t\t\t{/* Organization & Structure */}\n// \t\t\t\t\t<div className={styles.prefSection}>\n// \t\t\t\t\t  <h4>Organization & Structure</h4>\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.sectionHeadings}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('sectionHeadings')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Section headings</strong> - Add headings to organise sections\n// \t\t\t\t\t\t  <small className={styles.reference}>WCAG 2.2 & Easy-Read guidelines</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.bulletLists}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('bulletLists')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Bullet/numbered lists</strong> - Use bullet points for lists and steps\n// \t\t\t\t\t\t  <small className={styles.reference}>Nielsen Norman Group: lists improve comprehension</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.shortParagraphs}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('shortParagraphs')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Short paragraphs</strong> - Maximum 2-3 sentence paragraphs\n// \t\t\t\t\t\t  <small className={styles.reference}>Easy-Read conventions: ≤ 2 sentences per paragraph</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.addWhiteSpace}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('addWhiteSpace')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>White space between ideas</strong> - Add visual breaks for easier reading\n// \t\t\t\t\t\t  <small className={styles.reference}>Improves scannability and reduces cognitive load</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n// \t\t\t\t\t</div>\n// \t\t\t\t\t{/* Sentence Structure */}\n// \t\t\t\t\t<div className={styles.prefSection}>\n// \t\t\t\t\t  <h4>Sentence Structure</h4>\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.sentenceSplitting}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('sentenceSplitting')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Break long sentences</strong> - Split sentences longer than 10-15 words\n// \t\t\t\t\t\t  <small className={styles.reference}>Readable.com & PlainLanguage.gov guidelines</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.activeVoice}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('activeVoice')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Active voice</strong> - Convert passive to active voice\n// \t\t\t\t\t\t  <small className={styles.reference}>Minimal Text Complexity Guidelines</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.avoidNestedClauses}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('avoidNestedClauses')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Simplify nested clauses</strong> - Break complex sentence structures\n// \t\t\t\t\t\t  <small className={styles.reference}>Reduces processing difficulty for readers</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.clearPronouns}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('clearPronouns')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Clear pronoun references</strong> - Avoid ambiguous \"they,\" \"it,\" \"this\"\n// \t\t\t\t\t\t  <small className={styles.reference}>Prevents confusion about what pronouns refer to</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n// \t\t\t\t\t</div>\n// \t\t\t\t\t{/* Vocabulary & Clarity */}\n// \t\t\t\t\t<div className={styles.prefSection}>\n// \t\t\t\t\t  <h4>Vocabulary & Clarity</h4>\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.useEverydayLanguage}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('useEverydayLanguage')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Use everyday language</strong> - Replace complex words with simple alternatives\n// \t\t\t\t\t\t  <small className={styles.reference}>Core principle of plain language</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.defineComplexTerms}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('defineComplexTerms')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Define complex terms</strong> - Add simple explanations in parentheses\n// \t\t\t\t\t\t  <small className={styles.reference}>e.g., \"cardiologist (heart doctor)\"</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.expandAcronyms}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('expandAcronyms')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Expand acronyms</strong> - Write out abbreviated terms\n// \t\t\t\t\t\t  <small className={styles.reference}>e.g., \"ASAP\" → \"as soon as possible\"</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.avoidJargon}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('avoidJargon')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Remove jargon</strong> - Eliminate technical or specialized language\n// \t\t\t\t\t\t  <small className={styles.reference}>Makes content accessible to general audiences</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.avoidIdioms}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('avoidIdioms')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Avoid idioms & metaphors</strong> - Replace with literal language\n// \t\t\t\t\t\t  <small className={styles.reference}>e.g., \"hit the books\" → \"study\"</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.avoidDoubleNegatives}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('avoidDoubleNegatives')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Eliminate double negatives</strong> - Use positive statements\n// \t\t\t\t\t\t  <small className={styles.reference}>e.g., \"not uncommon\" → \"common\"</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.consistentTerms}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('consistentTerms')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Use consistent terms</strong> - Avoid synonyms that may confuse\n// \t\t\t\t\t\t  <small className={styles.reference}>Reduces cognitive load for readers</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n// \t\t\t\t\t</div>\n// \t\t\t\t\t{/* Engagement & Formatting */}\n// \t\t\t\t\t<div className={styles.prefSection}>\n// \t\t\t\t\t  <h4>Engagement & Formatting</h4>\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.directAddress}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('directAddress')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Direct address</strong> - Use \"you\" or \"we\" to engage readers\n// \t\t\t\t\t\t  <small className={styles.reference}>Creates conversational, accessible tone</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.boldKeyTerms}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('boldKeyTerms')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Highlight key terms</strong> - Use bold for important words and warnings\n// \t\t\t\t\t\t  <small className={styles.reference}>Aids scanning and comprehension</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n// \t\t\t\t\t</div>\n// \t\t\t\t\t{/* Special Features */}\n// \t\t\t\t\t<div className={styles.prefSection}>\n// \t\t\t\t\t  <h4>Review Features</h4>\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.showChanges}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('showChanges')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Show changes while writing</strong> - Toggle above AI-generated text box\n// \t\t\t\t\t\t  <small className={styles.reference}>Useful for reviewing what was changed</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n// \t\t\t\t\t</div>\n// \t\t\t\t  </div>\n// \t\t\t\t  {/* 3. TONE PREFERENCES */}\n// \t\t\t\t  <h3>Tone Preferences</h3>\n// \t\t\t\t  <div className={styles.toneOptions}>\n// \t\t\t\t\t{[\n// \t\t\t\t\t  { value: \"neutral\", label: \"Neutral\", default: true },\n// \t\t\t\t\t  { value: \"academic\", label: \"Academic\" },\n// \t\t\t\t\t  { value: \"formal\", label: \"Formal\" },\n// \t\t\t\t\t  { value: \"creative\", label: \"Creative\" }\n// \t\t\t\t\t].map((tone) => (\n// \t\t\t\t\t  <label key={tone.value} className={styles.toneOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"radio\"\n// \t\t\t\t\t\t  name=\"tonePreference\"\n// \t\t\t\t\t\t  value={tone.value}\n// \t\t\t\t\t\t  checked={tonePreference === tone.value}\n// \t\t\t\t\t\t  onChange={(e) => setTonePreference(e.target.value)}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span>{tone.label} {tone.default && \"<By default>\"}</span>\n// \t\t\t\t\t  </label>\n// \t\t\t\t\t))}\n// \t\t\t\t  </div>\n// \t\t\t\t</div>\n// \t\t\t  </div>\n// \t\t\t</section>\n// \t\t\t{/*  */}\n// \t\t\t\t  <div className={styles.form_container}>\n// \t\t\t\t\t{/* Input Area */}\n// \t\t\t\t\t<div className={styles.input_area}>\n// \t\t\t\t\t  <div className={styles.text_container}>\n// \t\t\t\t\t\t<label className={styles.label} htmlFor=\"inputText\">\n// \t\t\t\t\t\t  Input Text\n// \t\t\t\t\t\t</label>\n// \t\t\t\t\t\t<textarea\n// \t\t\t\t\t\t  id=\"inputText\"\n// \t\t\t\t\t\t  className={`${styles.textarea} ${isLoading ? styles.disabled : \"\"}`}\n// \t\t\t\t\t\t//   className={styles.textarea}\n// \t\t\t\t\t\t  placeholder=\"Write/Paste your text here or upload a PDF document to extract content automatically.\"\n// \t\t\t\t\t\t  value={inputText}\n// \t\t\t\t\t\t  onChange={(e) => setInputText(e.target.value)}\n// \t\t\t\t\t\t  disabled={isLoading} // Disable input when loading\n// \t\t\t\t\t\t></textarea>\n// \t\t\t\t\t <p className={styles.countText}>Words: {inputWordCount} | Characters: {inputCharCount}\n// \t\t\t\t\t {pdfPageCount > 0 && ` | Pages: ${pdfPageCount}`}\n// \t\t\t\t\t </p>\n// \t\t\t\t\t  </div>\n// \t\t\t\t\t  {/* OR Divider */}\n// \t\t\t\t\t  <div className={styles.or_divider}>OR</div>\n// \t\t\t\t\t  {/* File Upload */}\n// \t\t\t\t\t  <div className={`${styles.upload_area} ${isLoading ? styles.disabled : \"\"}`}\n// \t\t\t\t\t\tonDragOver={(e) => e.preventDefault()} // Prevent default behavior\n// \t\t\t\t\t\tonDrop={(e) => {\n// \t\t\t\t\t\t\te.preventDefault();\n// \t\t\t\t\t\t\tconst file = e.dataTransfer.files[0]; // Get the first dropped file\n// \t\t\t\t\t\t\tif (file) {\n// \t\t\t\t\t\t\thandleFileUpload({ target: { files: [file] } }); // Simulate file selection event\n// \t\t\t\t\t\t\t}\n// \t\t\t\t\t\t}}>\n// \t\t\t\t\t\t<label htmlFor=\"fileUpload\" className={styles.upload_box}>\n// \t\t\t\t\t\t\t{isUploading ? (\n// \t\t\t\t\t\t\t\t<span className={styles.loadingText}>Extracting text, please wait...</span>\n// \t\t\t\t\t\t\t\t) : uploadedFileName ? (\n// \t\t\t\t\t\t\t\t<>\n// \t\t\t\t\t\t\t\t\tFile uploaded: <strong>{uploadedFileName}</strong>\n// \t\t\t\t\t\t\t\t</>\n// \t\t\t\t\t\t\t\t) : (\n// \t\t\t\t\t\t\t\t<>\n// \t\t\t\t\t\t\t\t\tClick to Upload a PDF\n// \t\t\t\t\t\t\t\t\t<br />\n// \t\t\t\t\t\t\t\t\t<span>...or drag and drop a file.</span>\n// \t\t\t\t\t\t\t\t</>\n// \t\t\t\t\t\t\t)}\n// \t\t\t\t\t\t</label>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"file\"\n// \t\t\t\t\t\t  id=\"fileUpload\"\n// \t\t\t\t\t\t  accept=\"application/pdf\"\n// \t\t\t\t\t\t  onChange={handleFileUpload}\n// \t\t\t\t\t\t  className={styles.hidden_input}\n// \t\t\t\t\t\t  disabled={isUploading || isLoading} // Disable upload while processing\n// \t\t\t\t\t\t  //disabled={isUploading} // Disable upload while processing\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t  </div>\n// \t\t\t\t\t</div>\n// \t\t\t\t  </div>\n// \t\t\t\t  {/* Submit Button */}\n// \t\t\t\t  <button\n// \t\t\t\t\tclassName={styles.submit_btn}\n// \t\t\t\t\tonClick={handleSubmit}\n// \t\t\t\t\tdisabled={!inputText.trim() || isLoading || isUploading}\n// \t\t\t\t\tid=\"simplifyBtn\"\n// \t\t\t\t\t//title={!inputText.trim() ? \"Enter text or upload a file to enable simplification.\" : \"\"}\n// \t\t\t\t  >\n// \t\t\t\t\t{isLoading ? \"Processing...\" : \"Simplify Text\"}\n// \t\t\t\t  </button>\n// \t\t\t\t  <p className={styles.help_text}>Need Help? <a href=\"mailto:anukumar@uw.edu\">Contact Support</a></p>\n// \t\t\t\t  <Footer />  \n// \t\t      </div>\n// \t\t      </div>\n// \t\t    </>\n// \t\t  );\n// \t\t};\n// \t\texport default Main;\n// v3\nimport React,{useState,useEffect,useRef,useCallback}from\"react\";import styles from\"./styles.module.css\";import{useNavigate}from\"react-router-dom\";import*as pdfjsLib from\"pdfjs-dist/legacy/build/pdf\";// import { BrowserRouter as Router, Routes, Route, useNavigate } from \"react-router-dom\";\nimport{jwtDecode}from\"jwt-decode\";import Footer from\"../Footer\";import{calcMetrics}from\"../../utils/textMetrics\";import StatsButton from\"../StatsButton\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";pdfjsLib.GlobalWorkerOptions.workerSrc=`${process.env.PUBLIC_URL}/pdf.worker.mjs`;const prefsToPlain=(inputWordCount,outputLength,prefs,tone,additionalInstructions)=>{var _lengthRatios$outputL;const sections=[];// Calculate target word count based on slider selection\nconst lengthRatios={very_simple:0.4,much_shorter:0.5,shorter:0.75,same:1.0};const ratio=(_lengthRatios$outputL=lengthRatios[outputLength])!==null&&_lengthRatios$outputL!==void 0?_lengthRatios$outputL:1.0;const target=Math.round(inputWordCount*ratio);if(outputLength!==\"same\"){sections.push(`• Limit output to about **${target} words**.`);}// Structure and formatting\nif(prefs.sectionHeadings){sections.push(\"• Add clear section headings.\");}else{sections.push(\"• Do not add section headings.\");}if(prefs.bulletLists){sections.push(\"• Use bullet points or numbered lists for steps and key points.\");}else{sections.push(\"• Avoid using bullet points or numbered lists.\");}if(prefs.shortParagraphs){sections.push(\"• Keep paragraphs to 2–3 sentences.\");}else{sections.push(\"• Paragraph length may remain as in the original text.\");}// Sentence style\nif(prefs.breakLongSentences){sections.push(\"• Break long sentences into shorter ones.\");}else{sections.push(\"• Preserve original sentence lengths when possible.\");}if(prefs.activeVoice){sections.push(\"• Use active voice instead of passive.\");}else{sections.push(\"• Passive voice is acceptable.\");}if(prefs.simplifyClauses){sections.push(\"• Simplify nested clauses and complex sentence structures.\");}else{sections.push(\"• Do not simplify nested clauses.\");}// Vocabulary and clarity\nif(prefs.useSimpleLanguage){sections.push(\"• Replace complex words with simple, everyday language.\");}else{sections.push(\"• Keep original vocabulary complexity.\");}if(prefs.defineTerms){sections.push(\"• Define unavoidable complex terms in parentheses.\");}else{sections.push(\"• Do not define complex terms.\");}if(prefs.expandAcronyms){sections.push(\"• Expand acronyms and abbreviations.\");}else{sections.push(\"• Leave acronyms and abbreviations unchanged.\");}if(prefs.avoidJargon){sections.push(\"• Avoid jargon, idioms, and culturally specific references.\");}else{sections.push(\"• Keep original jargon and idioms.\");}// Tone\nif(tone&&tone!==\"neutral\"){sections.push(`• Use a **${tone}** tone while maintaining accessibility.`);}// Additional user instructions\nif(additionalInstructions&&additionalInstructions.trim().length>0){sections.push(`• ${additionalInstructions.trim()}`);}return sections.join(\"\\n\");};const Main=()=>{const[inputText,setInputText]=useState(\"\");const[outputText,setOutputText]=useState(\"\");const[isLoading,setIsLoading]=useState(false);const[isSubmitted,setIsSubmitted]=useState(false);const[isEditable,setIsEditable]=useState(false);// For toggling edit mode\nconst[uploadedFileName,setUploadedFileName]=useState(\"\");// State for file name\nconst[isSaveButtonVisible,setIsSaveButtonVisible]=useState(true);const[showSurveyPrompt,setShowSurveyPrompt]=useState(false);// State for survey prompt\nconst[documents,setDocuments]=useState([]);// Store user documents\nconst[selectedDocument,setSelectedDocument]=useState(null);// Selected doc\nconst[isSidebarVisible,setIsSidebarVisible]=useState(false);// Sidebar toggle\nconst navigate=useNavigate();const[isUploading,setIsUploading]=useState(false);// State for showing buffer\nconst user=JSON.parse(localStorage.getItem(\"user\"));const email=user===null||user===void 0?void 0:user.email;const[inputWordCount,setInputWordCount]=useState(0);const[inputCharCount,setInputCharCount]=useState(0);const[pdfPageCount,setPdfPageCount]=useState(0);const[showCustom,setShowCustom]=useState(false);const inputTextSnapshot=useRef(\"\");const[pdfPath,setPdfPath]=useState(\"\");// Output length\nconst lengthOptions=[\"same\",\"shorter\",\"much_shorter\",\"very_simple\"];const[outputLength,setOutputLength]=useState(\"same\");const[customWordCount,setCustomWordCount]=useState(\"\");const[prefs,setPrefs]=useState({// Structure & Formatting\nsectionHeadings:true,bulletLists:true,shortParagraphs:true,// Sentence Style\nbreakLongSentences:true,activeVoice:true,simplifyClauses:true,// Vocabulary & Clarity\nuseSimpleLanguage:true,defineTerms:true,expandAcronyms:true,avoidJargon:true});const[tonePreference,setTonePreference]=useState(\"neutral\");const[additionalInstructions,setAdditionalInstructions]=useState(\"\");// Toggle a preference on/off\nconst togglePref=key=>{setPrefs(prev=>({...prev,[key]:!prev[key]}));};// Helper function to calculate word counts based on input\nconst calculateWordCount=(inputWordCount,type)=>{switch(type){case\"shorter\":return Math.round(inputWordCount*0.75);case\"much_shorter\":return Math.round(inputWordCount*0.5);case\"custom\":return customWordCount;default:return inputWordCount;}};const handleLogout=()=>{localStorage.removeItem(\"token\");navigate(\"/Login\");};// Load user's past documents (original texts only)\nuseEffect(()=>{if(!email)return;const fetchDocuments=async()=>{try{const response=await fetch(`https://textsimplification12-a0a8gqfbhnhxbgbv.westus-01.azurewebsites.net/api/simplifications/user/${email}`);const result=await response.json();if(response.ok){const sortedDocs=result.data.sort((a,b)=>new Date(b.createdAt)-new Date(a.createdAt));setDocuments(sortedDocs);}else{console.error(\"Error fetching documents:\",result.message);}}catch(error){console.error(\"Error fetching documents:\",error);}};fetchDocuments();},[email]);// Handle document selection from history\nconst handleDocumentClick=doc=>{setSelectedDocument(doc);setInputText(doc.inputText);};const handleFileUpload=async event=>{const file=event.target.files[0];setPdfPath(`/uploads/${file.name}`);if(!file)return;setIsUploading(true);// Show buffer while processing\nsetUploadedFileName(file.name);// Set file name\ntry{//setUploadedFileName(file.name); // Set the uploaded file name\nconst fileReader=new FileReader();fileReader.onload=async function(){const typedArray=new Uint8Array(this.result);const pdf=await pdfjsLib.getDocument(typedArray).promise;setPdfPageCount(pdf.numPages);let text=\"\";// Extract text from all pages\nfor(let i=1;i<=pdf.numPages;i++){const page=await pdf.getPage(i);const textContent=await page.getTextContent();text+=textContent.items.map(item=>item.str).join(\" \");}setInputText(text);};fileReader.readAsArrayBuffer(file);}catch(error){console.error(\"Error reading PDF:\",error);alert(\"Failed to extract text from the PDF.\");}finally{setIsUploading(false);// Hide buffer once done\n}};const countWordsAndChars=text=>{const words=text.trim().split(/\\s+/).filter(Boolean).length;const chars=text.length;return{words,chars};};useEffect(()=>{const{words:inputWords,chars:inputChars}=countWordsAndChars(inputText);setInputWordCount(inputWords);setInputCharCount(inputChars);},[inputText]);const saveInitialSimplification=async(trimmedInput,cleanedOutput)=>{const user=JSON.parse(localStorage.getItem(\"user\"));if(!user)return;await fetch(\"https://textsimplification12-a0a8gqfbhnhxbgbv.westus-01.azurewebsites.net/api/simplifications\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({userId:user._id,email,inputText:trimmedInput,outputText:cleanedOutput,pdfName:uploadedFileName||null,pdfPath:pdfPath||null})});};const generatePrompt=useCallback(chunk=>{const prefsText=prefsToPlain(inputWordCount,outputLength,prefs,tonePreference,additionalInstructions);return`You are an expert in accessible communication.\\n\\n### USER‑SPECIFIC CUSTOMISATIONS\\n${prefsText}\\n\\n Transform the input into clear, accessible language without losing information. Keep the length similar to the original and avoid hallucinations.\\n\\n\"${chunk}\"`;},[inputWordCount,outputLength,prefs,tonePreference,additionalInstructions]);const splitTextIntoChunks=(text,maxTokens)=>{const words=text.split(\" \");let chunks=[];let currentChunk=[];for(let word of words){if(currentChunk.join(\" \").length+word.length<maxTokens){currentChunk.push(word);}else{chunks.push(currentChunk.join(\" \"));currentChunk=[word];}}if(currentChunk.length>0)chunks.push(currentChunk.join(\" \"));return chunks;};const handleSubmit=async()=>{// const inputText = document.getElementById('inputText').value;\nconst trimmedInput=inputText.trim();if(!trimmedInput)return;// inputTextSnapshot.current = inputText; \nsetIsLoading(true);try{const chunks=splitTextIntoChunks(trimmedInput,10000);let combinedOutput=\"\";for(let chunk of chunks){var _data$response;const prompt=generatePrompt(chunk);const response=await fetch(\"https://textsimplification12-a0a8gqfbhnhxbgbv.westus-01.azurewebsites.net/api/gpt4\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({prompt})});if(!response.ok){console.error(`API request failed with status: ${response.status}`);continue;// Skip this chunk if the API request failed\n}const data=await response.json();console.log(\"Full API Response: \",data);const data1=(data===null||data===void 0?void 0:(_data$response=data.response)===null||_data$response===void 0?void 0:_data$response.replace(/^\"|\"$/g,\"\"))||\"No response received.\";// Append results\ncombinedOutput+=data1+\" \";}console.log(\"Final Combined Output: \",combinedOutput);console.log(\"Data: \",combinedOutput);const cleanedResponse=combinedOutput.trim();setOutputText(cleanedResponse);setIsSubmitted(true);await saveInitialSimplification(trimmedInput,cleanedResponse);navigate(\"/review\",{state:{inputText:trimmedInput,outputText:cleanedResponse}});// navigate(\"/review\", { state: { inputText: trimmedInput, outputText: cleanedResponse } });\n}catch(error){console.error(\"Error fetching GPT-4o response:\",error);setOutputText(\"An error occurred while simplifying the text.\");}setIsLoading(false);};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"nav\",{className:styles.navbar,children:[/*#__PURE__*/_jsx(\"h1\",{onClick:()=>window.location.href=\"https://textsimplification12-a0a8gqfbhnhxbgbv.westus-01.azurewebsites.net/\",style:{cursor:\"pointer\"},children:\"Text Simplification Tool\"}),/*#__PURE__*/_jsx(\"button\",{className:styles.white_btn,onClick:handleLogout,children:\"Logout\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.container,children:[/*#__PURE__*/_jsxs(\"div\",{className:`${styles.sidebar} ${isSidebarVisible?styles.expanded:\"\"}`,children:[/*#__PURE__*/_jsxs(\"button\",{className:styles.historyIcon,onClick:()=>setIsSidebarVisible(!isSidebarVisible),children:[\"\\uD83D\\uDD52 \",/*#__PURE__*/_jsx(\"p\",{style:{fontSize:\"15px\"},children:\"History\"})]}),isSidebarVisible&&/*#__PURE__*/_jsxs(\"div\",{className:styles.historyContent,children:[/*#__PURE__*/_jsx(\"button\",{className:styles.closeButton,onClick:()=>setIsSidebarVisible(false),children:\"\\u2716\"}),/*#__PURE__*/_jsx(\"ul\",{className:styles.historyList,children:documents.map((doc,index)=>/*#__PURE__*/_jsxs(\"li\",{onClick:()=>handleDocumentClick(doc),className:`${styles.historyItem} ${(selectedDocument===null||selectedDocument===void 0?void 0:selectedDocument._id)===doc._id?styles.activeDoc:\"\"}`,children:[/*#__PURE__*/_jsxs(\"strong\",{children:[\"Document \",documents.length-index]}),\"(\",doc.inputText.substring(0,20),\"...)\"]},doc._id))})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:`${styles.mainContent} ${isSidebarVisible?styles.withSidebar:\"\"}`,children:[/*#__PURE__*/_jsx(\"div\",{className:styles.description,children:/*#__PURE__*/_jsx(\"p\",{children:\"This tool helps make complex text easier to read while preserving its original meaning. Enter text manually or upload a PDF to get started. You can customise the simplification guidelines below.\"})}),/*#__PURE__*/_jsxs(\"section\",{className:styles.customPanel,children:[/*#__PURE__*/_jsx(\"button\",{className:styles.customToggle,onClick:()=>setShowCustom(s=>!s),children:showCustom?\"▲ Hide Customisation Options\":\"▼ Show Customisation Options\"}),showCustom&&/*#__PURE__*/_jsxs(\"div\",{className:styles.customBody,children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Output Length\"}),/*#__PURE__*/_jsx(\"input\",{type:\"range\",min:\"0\",max:lengthOptions.length-1,value:lengthOptions.indexOf(outputLength),onChange:e=>setOutputLength(lengthOptions[e.target.value]),className:styles.sliderInput}),/*#__PURE__*/_jsxs(\"div\",{className:styles.sliderLabels,children:[/*#__PURE__*/_jsx(\"span\",{children:\"Very simple\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Much shorter\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Shorter\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Same\"})]}),/*#__PURE__*/_jsx(\"h3\",{children:\"Structure & Formatting\"}),[{key:\"sectionHeadings\",label:\"Section headings\"},{key:\"bulletLists\",label:\"Bullet/numbered lists\"},{key:\"shortParagraphs\",label:\"Short paragraphs\"}].map(opt=>/*#__PURE__*/_jsxs(\"label\",{className:styles.structureOption,children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:prefs[opt.key],onChange:()=>togglePref(opt.key)}),/*#__PURE__*/_jsx(\"span\",{children:opt.label})]},opt.key)),/*#__PURE__*/_jsx(\"h3\",{children:\"Sentence Style\"}),[{key:\"breakLongSentences\",label:\"Break long sentences\"},{key:\"activeVoice\",label:\"Active voice\"},{key:\"simplifyClauses\",label:\"Simplify nested clauses\"}].map(opt=>/*#__PURE__*/_jsxs(\"label\",{className:styles.structureOption,children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:prefs[opt.key],onChange:()=>togglePref(opt.key)}),/*#__PURE__*/_jsx(\"span\",{children:opt.label})]},opt.key)),/*#__PURE__*/_jsx(\"h3\",{children:\"Vocabulary & Clarity\"}),[{key:\"useSimpleLanguage\",label:\"Use everyday language\"},{key:\"defineTerms\",label:\"Define complex terms\"},{key:\"expandAcronyms\",label:\"Expand acronyms\"},{key:\"avoidJargon\",label:\"Avoid jargon & idioms\"}].map(opt=>/*#__PURE__*/_jsxs(\"label\",{className:styles.structureOption,children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:prefs[opt.key],onChange:()=>togglePref(opt.key)}),/*#__PURE__*/_jsx(\"span\",{children:opt.label})]},opt.key)),/*#__PURE__*/_jsx(\"h3\",{children:\"Tone Preference\"}),/*#__PURE__*/_jsx(\"div\",{className:styles.toneOptions,children:[{value:\"neutral\",label:\"Neutral (default)\"},{value:\"formal\",label:\"Professional/Formal\"},{value:\"academic\",label:\"Academic/Instructional\"},{value:\"casual\",label:\"Casual/Conversational\"},{value:\"creative\",label:\"Creative/Enthusiastic\"}].map(tone=>/*#__PURE__*/_jsxs(\"label\",{className:styles.toneOption,children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"tonePreference\",value:tone.value,checked:tonePreference===tone.value,onChange:e=>setTonePreference(e.target.value)}),/*#__PURE__*/_jsx(\"span\",{children:tone.label})]},tone.value))}),/*#__PURE__*/_jsx(\"h3\",{children:\"Additional Instructions\"}),/*#__PURE__*/_jsx(\"textarea\",{className:styles.textarea,placeholder:\"Enter any additional instructions or context here...\",value:additionalInstructions,onChange:e=>setAdditionalInstructions(e.target.value),rows:3})]})]}),/*#__PURE__*/_jsx(\"div\",{className:styles.form_container,children:/*#__PURE__*/_jsxs(\"div\",{className:styles.input_area,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.text_container,children:[/*#__PURE__*/_jsx(\"label\",{className:styles.label,htmlFor:\"inputText\",children:\"Input Text\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"inputText\",className:`${styles.textarea} ${isLoading?styles.disabled:\"\"}`,placeholder:\"Write/Paste your text here or upload a PDF document to extract content automatically.\",value:inputText,onChange:e=>setInputText(e.target.value),disabled:isLoading}),/*#__PURE__*/_jsxs(\"p\",{className:styles.countText,children:[\"Words: \",inputWordCount,\" | Characters: \",inputCharCount,pdfPageCount>0&&` | Pages: ${pdfPageCount}`]})]}),/*#__PURE__*/_jsx(\"div\",{className:styles.or_divider,children:\"OR\"}),/*#__PURE__*/_jsxs(\"div\",{className:`${styles.upload_area} ${isLoading?styles.disabled:\"\"}`,onDragOver:e=>e.preventDefault(),onDrop:e=>{e.preventDefault();const file=e.dataTransfer.files[0];if(file)handleFileUpload({target:{files:[file]}});},children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"fileUpload\",className:styles.upload_box,children:isUploading?/*#__PURE__*/_jsx(\"span\",{className:styles.loadingText,children:\"Extracting text, please wait...\"}):uploadedFileName?/*#__PURE__*/_jsxs(_Fragment,{children:[\"File uploaded: \",/*#__PURE__*/_jsx(\"strong\",{children:uploadedFileName})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[\"Click to Upload a PDF\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{children:\"...or drag and drop a file.\"})]})}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"fileUpload\",accept:\"application/pdf\",onChange:handleFileUpload,className:styles.hidden_input,disabled:isUploading||isLoading})]})]})}),/*#__PURE__*/_jsx(\"button\",{className:styles.submit_btn,onClick:handleSubmit,disabled:!inputText.trim()||isLoading||isUploading,id:\"simplifyBtn\",children:isLoading?\"Processing...\":\"Simplify Text\"}),/*#__PURE__*/_jsxs(\"p\",{className:styles.help_text,children:[\"Need Help? \",/*#__PURE__*/_jsx(\"a\",{href:\"mailto:anukumar@uw.edu\",children:\"Contact Support\"})]}),/*#__PURE__*/_jsx(Footer,{})]})]})]});};export default Main;","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","styles","useNavigate","pdfjsLib","jwtDecode","Footer","calcMetrics","StatsButton","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","GlobalWorkerOptions","workerSrc","process","env","PUBLIC_URL","prefsToPlain","inputWordCount","outputLength","prefs","tone","additionalInstructions","_lengthRatios$outputL","sections","lengthRatios","very_simple","much_shorter","shorter","same","ratio","target","Math","round","push","sectionHeadings","bulletLists","shortParagraphs","breakLongSentences","activeVoice","simplifyClauses","useSimpleLanguage","defineTerms","expandAcronyms","avoidJargon","trim","length","join","Main","inputText","setInputText","outputText","setOutputText","isLoading","setIsLoading","isSubmitted","setIsSubmitted","isEditable","setIsEditable","uploadedFileName","setUploadedFileName","isSaveButtonVisible","setIsSaveButtonVisible","showSurveyPrompt","setShowSurveyPrompt","documents","setDocuments","selectedDocument","setSelectedDocument","isSidebarVisible","setIsSidebarVisible","navigate","isUploading","setIsUploading","user","JSON","parse","localStorage","getItem","email","setInputWordCount","inputCharCount","setInputCharCount","pdfPageCount","setPdfPageCount","showCustom","setShowCustom","inputTextSnapshot","pdfPath","setPdfPath","lengthOptions","setOutputLength","customWordCount","setCustomWordCount","setPrefs","tonePreference","setTonePreference","setAdditionalInstructions","togglePref","key","prev","calculateWordCount","type","handleLogout","removeItem","fetchDocuments","response","fetch","result","json","ok","sortedDocs","data","sort","a","b","Date","createdAt","console","error","message","handleDocumentClick","doc","handleFileUpload","event","file","files","name","fileReader","FileReader","onload","typedArray","Uint8Array","pdf","getDocument","promise","numPages","text","i","page","getPage","textContent","getTextContent","items","map","item","str","readAsArrayBuffer","alert","countWordsAndChars","words","split","filter","Boolean","chars","inputWords","inputChars","saveInitialSimplification","trimmedInput","cleanedOutput","method","headers","body","stringify","userId","_id","pdfName","generatePrompt","chunk","prefsText","splitTextIntoChunks","maxTokens","chunks","currentChunk","word","handleSubmit","combinedOutput","_data$response","prompt","status","log","data1","replace","cleanedResponse","state","children","className","navbar","onClick","window","location","href","style","cursor","white_btn","container","sidebar","expanded","historyIcon","fontSize","historyContent","closeButton","historyList","index","historyItem","activeDoc","substring","mainContent","withSidebar","description","customPanel","customToggle","s","customBody","min","max","value","indexOf","onChange","e","sliderInput","sliderLabels","label","opt","structureOption","checked","toneOptions","toneOption","textarea","placeholder","rows","form_container","input_area","text_container","htmlFor","id","disabled","countText","or_divider","upload_area","onDragOver","preventDefault","onDrop","dataTransfer","upload_box","loadingText","accept","hidden_input","submit_btn","help_text"],"sources":["/Users/anukumar/Desktop/Summer 2025/TextSimplification_CHI/updated_repo/textsimplification/client/src/components/Main/index.jsx"],"sourcesContent":["// import React, { useState, useEffect, useRef, useCallback  } from \"react\";\n// import styles from \"./styles.module.css\";\n// import { useNavigate } from \"react-router-dom\";\n// import * as pdfjsLib from \"pdfjs-dist/legacy/build/pdf\";\n// // import { BrowserRouter as Router, Routes, Route, useNavigate } from \"react-router-dom\";\n// import { jwtDecode } from \"jwt-decode\";\n// import Footer from \"../Footer\";\n// import { calcMetrics } from \"../../utils/textMetrics\";\n// import StatsButton from \"../StatsButton\";\n\n// pdfjsLib.GlobalWorkerOptions.workerSrc = `${process.env.PUBLIC_URL}/pdf.worker.mjs`;\n\n// const prefsToPlain = (prefs) => {\n// \tconst sections = [];\n  \n// \t/* ----- 1 Output length ----- */\n// \tif (prefs.maxWords || prefs.reduction)\n// \t  sections.push(\n// \t\t`• Limit final output to **${prefs.maxWords || \"⩓\"} words** ` +\n// \t\t`(${prefs.reduction ? `${prefs.reduction}% reduction` : \"no reduction\"}).`\n// \t  );\n  \n// \t/* ----- 2 Reading level ----- */\n// \tif (prefs.readingLevels.length)\n// \t  sections.push(\"• Writing should suit readers who \" +\n// \t\tprefs.readingLevels.join(\", \") + \".\");\n  \n// \t/* ----- 3 Tone ----- */\n// \tif (prefs.tone)\n// \t  sections.push(`• Use a **${prefs.tone}** tone.`);\n  \n// \t/* ----- 4 Sentence structure ----- */\n// \tif (prefs.structPrefs.length)\n// \t  sections.push(\"• Structural preferences: \" +\n// \t\tprefs.structPrefs.join(\", \") + \".\");\n  \n// \t/* ----- 5 Free text ----- */\n// \tif (prefs.misc.trim())\n// \t  sections.push(\"• Additional notes: \" + prefs.misc.trim());\n  \n// \treturn sections.length ? sections.join(\"\\n\") : \"\";\n//   };\n\n  \n// const Main = () => {\n\n// \tconst [inputText, setInputText] = useState(\"\");\n// \tconst [outputText, setOutputText] = useState(\"\");\n// \tconst [isLoading, setIsLoading] = useState(false);\n// \tconst [isSubmitted, setIsSubmitted] = useState(false);\n// \tconst [isEditable, setIsEditable] = useState(false); // For toggling edit mode\n// \tconst [uploadedFileName, setUploadedFileName] = useState(\"\"); // State for file name\n// \tconst [isSaveButtonVisible, setIsSaveButtonVisible] = useState(true);\n// \tconst [showSurveyPrompt, setShowSurveyPrompt] = useState(false); // State for survey prompt\n\n// \tconst [documents, setDocuments] = useState([]); // Store user documents\n// \tconst [selectedDocument, setSelectedDocument] = useState(null); // Selected doc\n// \tconst [isSidebarVisible, setIsSidebarVisible] = useState(false); // Sidebar toggle\n\n// \tconst navigate = useNavigate();\n// \tconst [isUploading, setIsUploading] = useState(false); // State for showing buffer\n\n// \tconst user = JSON.parse(localStorage.getItem(\"user\"));\n// \tconst email = user?.email;\n\n// \tconst [inputWordCount, setInputWordCount] = useState(0);\n// \tconst [inputCharCount, setInputCharCount] = useState(0);\n// \tconst [pdfPageCount, setPdfPageCount] = useState(0);\n\n// \tconst inputTextSnapshot = useRef(\"\");\n// \tconst [pdfPath, setPdfPath] = useState(\"\"); \n\n// \tconst [prefsOpen, setPrefsOpen] = useState(false);\n// \tconst [customPrefs, setCustomPrefs] = useState({\n// \t  maxWords   : \"\",      // number or \"\"\n// \t  reduction  : \"\",      // \"0\" | \"25\" | \"50\" | …\n// \t  readingLevels : [],   // array of strings\n// \t  tone       : \"\",      // single string\n// \t  structPrefs: [],      // array of strings\n// \t  misc       : \"\",      // free text\n// \t});\n\n// \tconst [outputLen, setOutputLen] = useState(\"\");   // \"\", \"50\", \"150\", …, \"custom\"\n\n// \tconst [showCustom,  setShowCustom]  = useState(false);  // accordion open/close\n// \tconst [customLen,   setCustomLen]   = useState(\"\");     // numeric length, if “Custom”\n// \tconst [extraPrefs,  setExtraPrefs]  = useState(\"\");     // free‑text box\n\n// \t// ─── Panel toggle ────────────────────────────────────────────────\n// const handleTogglePanel = () => setShowCustom((s) => !s);   // <─ NEW\n\n//   const handleLogout = () => {\n//     localStorage.removeItem(\"token\");\n//     navigate(\"/Login\"); \n//   };\n\n//   const toggleSet = (key, value) => setCustomPrefs(p => {\n//     const list = p[key];\n//     return {\n//       ...p,\n//       [key]: list.includes(value)\n//         ? list.filter(v => v !== value)\n//         : [...list, value]\n//     };\n//   });\n\n\n//     // Load user's past documents (original texts only)\n// \tuseEffect(() => {\n// \t\tif (!email) return;\n\t\n// \t\tconst fetchDocuments = async () => {\n// \t\t  try {\n// \t\t\tconst response = await fetch(\n// \t\t\t  `https://textsimplification12-a0a8gqfbhnhxbgbv.westus-01.azurewebsites.net/api/simplifications/user/${email}`\n// \t\t\t);\n// \t\t\tconst result = await response.json();\n\t\n// \t\t\tif (response.ok) {\n// \t\t\t  const sortedDocs = result.data.sort(\n// \t\t\t\t(a, b) => new Date(b.createdAt) - new Date(a.createdAt)\n// \t\t\t  );\n// \t\t\t  setDocuments(sortedDocs);\n// \t\t\t} else {\n// \t\t\t  console.error(\"Error fetching documents:\", result.message);\n// \t\t\t}\n// \t\t  } catch (error) {\n// \t\t\tconsole.error(\"Error fetching documents:\", error);\n// \t\t  }\n// \t\t};\n\t\n// \t\tfetchDocuments();\n// \t  }, [email]);\n\n// \t  // Handle document selection from history\n//   const handleDocumentClick = (doc) => {\n//     setSelectedDocument(doc);\n//     setInputText(doc.inputText);\n//   };\n\n//   \tconst handleFileUpload = async (event) => {\n// \t  const file = event.target.files[0];\n// \t  setPdfPath(`/uploads/${file.name}`);    \n\n// \t  if (!file) return;\n  \n// \t  setIsUploading(true); // Show buffer while processing\n// \t  setUploadedFileName(file.name); // Set file name\n\n// \t  try {\n// \t\t//setUploadedFileName(file.name); // Set the uploaded file name\n// \t\tconst fileReader = new FileReader();\n// \t\tfileReader.onload = async function () {\n// \t\t  const typedArray = new Uint8Array(this.result);\n  \n// \t\t  const pdf = await pdfjsLib.getDocument(typedArray).promise;\n\n// \t\t  setPdfPageCount(pdf.numPages);\n\n// \t\t  let text = \"\";\n  \n// \t\t  // Extract text from all pages\n// \t\t  for (let i = 1; i <= pdf.numPages; i++) {\n// \t\t\tconst page = await pdf.getPage(i);\n// \t\t\tconst textContent = await page.getTextContent();\n// \t\t\ttext += textContent.items.map((item) => item.str).join(\" \");\n// \t\t  }\n  \n// \t\t  setInputText(text);\n// \t\t};\n// \t\tfileReader.readAsArrayBuffer(file);\n// \t  } catch (error) {\n// \t\tconsole.error(\"Error reading PDF:\", error);\n// \t\talert(\"Failed to extract text from the PDF.\");\n// \t  } finally {\n// \t\tsetIsUploading(false); // Hide buffer once done\n// \t  }\n// \t};\n \n// \tconst countWordsAndChars = (text) => {\n// \t\tconst words = text.trim().split(/\\s+/).filter(Boolean).length;\n// \t\tconst chars = text.length;\n// \t\treturn { words, chars };\n// \t  };\n\t  \n// \t    useEffect(() => {\n// \t\t  const { words: inputWords, chars: inputChars } = countWordsAndChars(inputText);\n\n// \t\t  setInputWordCount(inputWords);\n// \t\t  setInputCharCount(inputChars);\n\n// \t\t}, [inputText]);\n\t  \n// \t\tconst saveInitialSimplification = async (trimmedInput, cleanedOutput) => {\n// \t\t\tconst user = JSON.parse(localStorage.getItem(\"user\"));\n// \t\t\tif (!user) return;\n\n// \t\t\tawait fetch(\"https://textsimplification12-a0a8gqfbhnhxbgbv.westus-01.azurewebsites.net/api/simplifications\", {\n// \t\t\t\tmethod: \"POST\",\n// \t\t\t\theaders: { \"Content-Type\": \"application/json\" },\n// \t\t\t\tbody: JSON.stringify({\n// \t\t\t\tuserId: user._id,\n// \t\t\t\temail,\n// \t\t\t\tinputText: trimmedInput,\n// \t\t\t\toutputText: cleanedOutput,\n// \t\t\t\tpdfName: uploadedFileName || null,\n// \t\t\t\tpdfPath: pdfPath || null,\n// \t\t\t\t}),\n// \t\t\t});\n// \t\t};\n\n\n// \t\tconst generatePrompt = useCallback((inputText) => {\n// \t\t\tconst prefsText = prefsToPlain(customPrefs);\n\t\n// \t\t\treturn `\n// \t\t### USER‑SPECIFIC CUSTOMISATIONS (please follow **strictly**)\n// \t\t${prefsText || \"• No special preferences.\"}\n\t\t\n// \t\tYou are an expert in accessible communication, tasked with transforming complex text into clear, accessible plain language for individuals with Intellectual and Developmental Disabilities (IDD) or those requiring simplified content. Retain all essential information and intent while prioritizing readability, comprehension, and inclusivity.\n\n// \t\tText simplification refers to rewriting or adapting text to make it easier to read and understand while keeping the same level of detail and precision. Make sure you focus on simplification and not summarization. The length of generated output text must be similar to that of input text.\n\n// \t\tStick to the provided input text and only simplify the language. Don't provide the answer or hallucinate or provide any irrelevant information, not mentioned in the input text. \n\n// \t\tGuidelines for Simplification:\n// \t\tVocabulary and Terminology:\n// \t\tReplace uncommon, technical, or abstract words with simple, everyday language.\n// \t\tDefine unavoidable complex terms in plain language within parentheses upon first use (example: “cardiologist (heart doctor)”).\n// \t\tAvoid idioms, metaphors, sarcasm, or culturally specific references.\n\n// \t\tSentence Structure:\n// \t\tUse short sentences (10--15 words max). Break long sentences into 1–2 ideas each.\n// \t\tPrefer active voice (example: “The doctor examined the patient” vs. “The patient was examined by the doctor”).\n// \t\tAvoid nested clauses, passive voice, and ambiguous pronouns (example: “they,” “it”).\n\n// \t\tClarity and Flow:\n// \t\tOrganize content logically, using headings/subheadings to group related ideas.\n// \t\tUse bullet points or numbered lists for steps, options, or key points.\n// \t\tEnsure each paragraph focuses on one main idea.\n\n// \t\tTone and Engagement:\n// \t\tWrite in a neutral, conversational tone (avoid formal or academic language).\n// \t\tAddress the reader directly with “you” or “we” where appropriate.\n// \t\tUse consistent terms for concepts (avoid synonyms that may confuse).\n\n// \t\tAvoid Exclusionary Elements:\n// \t\tRemove jargon, acronyms (unless defined), and expand abbreviations if needed (example: “ASAP” → “as soon as possible”).\n// \t\tEliminate metaphors, idioms, or implied meanings (example: “hit the books” → “study”).\n// \t\tAvoid double negatives (example: “not uncommon” → “common”).\n\n// \t\tStructural Support:\n// \t\tAdd clear headings to label sections (example: “How to Apply for Benefits”).\n// \t\tUse formatting tools like bold for key terms or warnings.\n// \t\tChunk information into short paragraphs with line breaks for visual ease.\n\n// \t\tInclusivity Checks:\n// \t\tEnsure content is free of bias, stereotypes, or assumptions about the reader.\n// \t\tUse gender-neutral language (example: “they” instead of “he/she”).\n\n\n// \t\tOutput Requirements:\n// \t\tReturn only the simplified text, without markdown, emojis, or images.\n// \t\tPreserve original context, facts, and intent. Do not omit critical details.\n// \t\tPrioritize clarity over brevity; focus on simplification and not summarization. The length of generated output text should be same or similar to that of input text.\n// \t\tDo not simplify already simple text.\n\n// \t\tExample Transformation:\n// \t\tOriginal: “Individuals experiencing adverse climatic conditions may necessitate relocation to mitigate health risks.”\n// \t\tSimplified: “If weather conditions become dangerous, people might need to move to stay safe.”\n\n// \t\tFor the provided input text, apply the above guidelines rigorously. Ensure the output is accessible to readers with varied cognitive abilities, emphasizing clarity, simplicity, and logical structure. Verify that the simplified text aligns with plain language standards like WCAG and PlainLanguage.gov.\n\n// \t\t\"${inputText}\"\n// \t\t`;\n// \t\t  }, [customPrefs]);\n\n//   const splitTextIntoChunks = (text, maxTokens) => {\n// \tconst words = text.split(\" \");\n// \tlet chunks = [];\n// \tlet currentChunk = [];\n  \n// \tfor (let word of words) {\n// \t  if (currentChunk.join(\" \").length + word.length < maxTokens) {\n// \t\tcurrentChunk.push(word);\n// \t  } else {\n// \t\tchunks.push(currentChunk.join(\" \"));\n// \t\tcurrentChunk = [word];\n// \t  }\n// \t}\n// \tif (currentChunk.length > 0) chunks.push(currentChunk.join(\" \"));\n// \treturn chunks;\n//   };\n\n\n//   const handleSubmit = async () => {\n\n// \t// const inputText = document.getElementById('inputText').value;\n// \tconst trimmedInput = inputText.trim();\n// \tif (!trimmedInput) return;\n\n// \t// inputTextSnapshot.current = inputText; \n// \tsetIsLoading(true);\n  \n// \ttry {\n// \t  const chunks = splitTextIntoChunks(trimmedInput, 1000);\n// \t  let combinedOutput = \"\";\n  \n// \t  for (let chunk of chunks) {\n// \t\tconst prompt = generatePrompt(chunk);\n// \t\tconst response = await fetch(\"https://textsimplification12-a0a8gqfbhnhxbgbv.westus-01.azurewebsites.net/api/gpt4\", {\n// \t\t  method: \"POST\",\n// \t\t  headers: { \"Content-Type\": \"application/json\" },\n// \t\t  body: JSON.stringify({ prompt }),\n// \t\t});\n\t\t\n// \t\tif (!response.ok) {\n// \t\t\tconsole.error(`API request failed with status: ${response.status}`);\n// \t\t\tcontinue; // Skip this chunk if the API request failed\n// \t\t  }\n\n// \t\tconst data = await response.json();\n// \t\tconsole.log(\"Full API Response: \", data);\n\n\n// \t\tconst data1 = data?.response?.replace(/^\"|\"$/g, \"\") || \"No response received.\"; // Append results\n// \t\tcombinedOutput += data1 + \" \";\n// \t}\n// \t  console.log(\"Final Combined Output: \", combinedOutput);\n\n// \tconsole.log(\"Data: \", combinedOutput);\n\n// \tconst cleanedResponse = combinedOutput.trim();\n// \tsetOutputText(cleanedResponse);\n// \tsetIsSubmitted(true);\n\n// \tawait saveInitialSimplification(trimmedInput, cleanedResponse);\n// \tnavigate(\"/review\", { state: { inputText: trimmedInput, outputText: cleanedResponse } });\n// \t// navigate(\"/review\", { state: { inputText: trimmedInput, outputText: cleanedResponse } });\n\t\n// \t} catch (error) {\n// \t  console.error(\"Error fetching GPT-4o response:\", error);\n// \t  setOutputText(\"An error occurred while simplifying the text.\");\n// \t}\n  \n// \tsetIsLoading(false);\n//   };\n\n  \n\n//   return (\n//     <>\n//       <nav className={styles.navbar}>\n//         {/* <h1>Text Simplification Tool</h1> */}\n// \t\t<h1 \n//     onClick={() => window.location.href = \"https://textsimplification12-a0a8gqfbhnhxbgbv.westus-01.azurewebsites.net/\"}\n//     style={{ cursor: \"pointer\" }} // Makes it look clickable\n//  \t\t>\n// \t\tText Simplification Tool</h1>\n//         <button className={styles.white_btn} onClick={handleLogout}>\n//           Logout\n//         </button>\n//       </nav>\n\n// \t  <div className={styles.container}>\n\n// \t\t\t <div\n// \t\t\t\t  className={`${styles.sidebar} ${\n// \t\t\t\t\tisSidebarVisible ? styles.expanded : \"\"\n// \t\t\t\t  }`}\n// \t\t\t\t>\n\n// \t\t\t{/* </div> */}\n\n// \t\t\t<button\n// \t\t\tclassName={styles.historyIcon}\n// \t\t\tonClick={() => setIsSidebarVisible(!isSidebarVisible)}\n// \t\t\t>\n// \t\t\t\t🕒   <p style={{ fontSize: \"15px\" }}> History </p> \n// \t\t\t</button>\n\n\n\n//           {isSidebarVisible && (\n//             <div className={styles.historyContent}>\n//               <button className={styles.closeButton} onClick={() => setIsSidebarVisible(false)}>\n//                 ✖\n//               </button>\n//               <ul className={styles.historyList}>\n//                 {documents.map((doc, index) => (\n    \n// \t\t\t\t<li\n// \t\t\t\tkey={doc._id}\n// \t\t\t\tonClick={() => handleDocumentClick(doc)}\n// \t\t\t\tclassName={`${styles.historyItem} ${selectedDocument?._id === doc._id ? styles.activeDoc : \"\"}`}\n// \t\t\t\t>\n// \t\t\t\t{/* <strong>Document {index + 1}</strong>  */}\n// \t\t\t\t<strong>Document {documents.length - index}</strong>({doc.inputText.substring(0, 20)}...)\n// \t\t\t\t</li>\n//                 ))}\n//               </ul>\n//             </div>\n//           )}\n//         </div>\n\n// \t  {/* <div className={styles.main_container}> */}\n\t  \n// \t  <div className={`${styles.mainContent} ${isSidebarVisible ? styles.withSidebar : \"\"}`}>\n         \n\n\n// \t\t\t<div className={styles.description}>\n\n// \t\t\t  <p>\n// \t\t\t  This tool helps make complex text easier to read while preserving its original meaning. Whether you're simplifying academic content, technical documents, or general text for better accessibility, this tool provides a quick and efficient way to generate a more readable version. You can enter text manually or upload a document to get started.\n// \t\t\t  </p>\n// \t</div>\n\n// \t        {/* ─── (2)  CUSTOMISATION PANEL  ─────────── */}\n// \t\t\t<section className={styles.customPanel}>\n//           {/* toggle row */}\n//           <button\n//             className={styles.customToggle}\n//             onClick={() => setShowCustom((s) => !s)}\n//           >\n//             {showCustom ? \"▲  Hide Customisation Options\" : \"▼  Show Customisation Options\"}\n//           </button>\n\n         \n// \t\t  <div\n// \t\t\tclassName={`${styles.customPanel} ${\n// \t\t\t\tshowCustom ? \"\" : styles.hiddenPanel   // ←  just hide with CSS\n// \t\t\t}`}\n// \t\t\t>\n\n//             <div className={styles.customBody}>\n\t\t\t\t\n//               {/* 2‑A  ▸ Output length ------------------------------------------------ */}\n//               <h3>Output Length</h3>\n//               <div className={styles.flexRow}>\n//                 <label className={styles.block}>\n//                   <input type=\"radio\" name=\"lenPreset\" value=\"50\"     checked={outputLen === \"50\"}      /* ← NEW */\n//     onChange={(e) => setOutputLen(e.target.value)}/> 50 words\n//                 </label>\n//                 <label className={styles.block}>\n//                   <input type=\"radio\" name=\"lenPreset\" value=\"150\"     checked={outputLen === \"150\"}      /* ← NEW */\n//     onChange={(e) => setOutputLen(e.target.value)}/> 150 words\n//                 </label>\n//                 <label className={styles.block}>\n//                   <input type=\"radio\" name=\"lenPreset\" value=\"300\"     checked={outputLen === \"300\"}      /* ← NEW */\n//     onChange={(e) => setOutputLen(e.target.value)}/> 300 words\n//                 </label>\n//                 <label className={styles.block}>\n//                   <input type=\"radio\" name=\"lenPreset\" value=\"500\"    checked={outputLen === \"500\"}      /* ← NEW */\n//     onChange={(e) => setOutputLen(e.target.value)} /> 500 words\n//                 </label>\n\t\t\n        \n\t\t\t\n//                 <label className={styles.block}>\n//                   <input type=\"radio\" name=\"lenPreset\" value=\"custom\"    checked={outputLen === \"custom\" } onChange={(e) => setOutputLen(e.target.value)}      /* ← NEW */\n//    /> Custom:{\" \"}\n//                   <input\n//                     type=\"number\"\n//                     min=\"10\"\n//                     style={{ width: \"5rem\" }}\n//                     onChange={(e) => setCustomLen(e.target.value)}\n//                   />{\" \"}\n//                   words\n//                 </label>\n//               </div>\n\n//               <h3>Reduce original text by</h3>\n//               <div className={styles.flexRow}>\n//                 {[\"0\", \"25\", \"50\", \"75\", \"90\"].map((pct) => (\n//                   <label key={pct} className={styles.block}>\n//                     <input\n//                       type=\"radio\"\n//                       name=\"reducePct\"\n//                       value={pct}\n//                       defaultChecked={pct === \"0\"}\n//                     />{\" \"}\n//                     {pct}%{pct === \"0\" ? \" (No reduction)\" : \"\"}\n//                   </label>\n//                 ))}\n//               </div>\n\n//               {/* 2‑B  ▸ Reading level ---------------------------------------------- */}\n//               <h3>Reading Level</h3>\n//               <div className={styles.flexRow}>\n//                 {[\n//                   \"Are learning to read\",\n//                   \"Need simple vocabulary\",\n//                   \"Prefer shorter sentences\",\n//                   \"Can handle complex concepts but need clear explanations\",\n//                   \"Are professionals in this field\",\n//                 ].map((txt) => (\n//                   <label key={txt} className={styles.block}>\n//                     <input type=\"checkbox\" name=\"readingLevel\" value={txt} />{\" \"}\n//                     {txt}\n//                   </label>\n//                 ))}\n//               </div>\n\n//               {/* 2‑C  ▸ Tone / style ---------------------------------------------- */}\n//               <h3>Tone &amp; Style</h3>\n//               <div className={styles.flexRow}>\n//                 {[\n//                   \"Casual/Conversational\",\n//                   \"Professional/Formal\",\n//                   \"Academic/Instructional\",\n//                   \"Creative/Enthusiastic\",\n//                   \"Neutral/Objective\",\n//                 ].map((tone) => (\n//                   <label key={tone} className={styles.block}>\n//                     <input type=\"radio\" name=\"tone\" value={tone} /> {tone}\n//                   </label>\n//                 ))}\n//               </div>\n\n//               {/* 2‑D  ▸ Sentence structure ---------------------------------------- */}\n//               <h3>Sentence Structure Preferences</h3>\n//               <div className={styles.flexRow}>\n//                 {[\n//                   \"Bullet points instead of paragraphs\",\n//                   \"Numbered sequences for steps\",\n//                   \"Headings to break up content\",\n//                   \"White space between key ideas\",\n//                   \"Convert passive to active voice\",\n//                   \"Break up sentences longer than 10--15 words words\",\n//                   \"Simplify nested clauses\",\n//                   \"Reduce prepositional phrases\",\n//                 ].map((opt) => (\n//                   <label key={opt} className={styles.block}>\n//                     <input type=\"checkbox\" name=\"structure\" value={opt} /> {opt}\n//                   </label>\n//                 ))}\n//               </div>\n\n//               {/* 2‑E  ▸ Free‑text box -------------------------------------------- */}\n//               <h3>Anything else?</h3>\n//               <textarea\n//                 rows={3}\n//                 placeholder=\"Type any additional preferences here…\"\n//                 onChange={(e) => setExtraPrefs(e.target.value)}\n//               />\n//             </div>\n          \n// \t\t\t</div>\n//         </section>\n\n// \t\t{/*  */}\n\n// \t\t\t  <div className={styles.form_container}>\n// \t\t\t\t{/* Input Area */}\n// \t\t\t\t<div className={styles.input_area}>\n// \t\t\t\t  <div className={styles.text_container}>\n// \t\t\t\t\t<label className={styles.label} htmlFor=\"inputText\">\n// \t\t\t\t\t  Input Text\n// \t\t\t\t\t</label>\n// \t\t\t\t\t<textarea\n// \t\t\t\t\t  id=\"inputText\"\n// \t\t\t\t\t  className={`${styles.textarea} ${isLoading ? styles.disabled : \"\"}`}\n// \t\t\t\t\t//   className={styles.textarea}\n// \t\t\t\t\t  placeholder=\"Write/Paste your text here or upload a PDF document to extract content automatically.\"\n// \t\t\t\t\t  value={inputText}\n// \t\t\t\t\t  onChange={(e) => setInputText(e.target.value)}\n// \t\t\t\t\t  disabled={isLoading} // Disable input when loading\n// \t\t\t\t\t></textarea>\n\t\t\t\t \n// \t\t\t\t <p className={styles.countText}>Words: {inputWordCount} | Characters: {inputCharCount}\n// \t\t\t\t {pdfPageCount > 0 && ` | Pages: ${pdfPageCount}`}\n// \t\t\t\t </p>\n\t\t\t\t\t\n// \t\t\t\t  </div>\n  \n// \t\t\t\t  {/* OR Divider */}\n// \t\t\t\t  <div className={styles.or_divider}>OR</div>\n  \n// \t\t\t\t  {/* File Upload */}\n// \t\t\t\t  <div className={`${styles.upload_area} ${isLoading ? styles.disabled : \"\"}`}\n// \t\t\t\t\tonDragOver={(e) => e.preventDefault()} // Prevent default behavior\n// \t\t\t\t\tonDrop={(e) => {\n// \t\t\t\t\t\te.preventDefault();\n// \t\t\t\t\t\tconst file = e.dataTransfer.files[0]; // Get the first dropped file\n// \t\t\t\t\t\tif (file) {\n// \t\t\t\t\t\thandleFileUpload({ target: { files: [file] } }); // Simulate file selection event\n// \t\t\t\t\t\t}\n// \t\t\t\t\t}}>\n// \t\t\t\t\t<label htmlFor=\"fileUpload\" className={styles.upload_box}>\n\t\t\t\t\t\t\n// \t\t\t\t\t\t{isUploading ? (\n// \t\t\t\t\t\t\t<span className={styles.loadingText}>Extracting text, please wait...</span>\n// \t\t\t\t\t\t\t) : uploadedFileName ? (\n// \t\t\t\t\t\t\t<>\n// \t\t\t\t\t\t\t\tFile uploaded: <strong>{uploadedFileName}</strong>\n// \t\t\t\t\t\t\t</>\n// \t\t\t\t\t\t\t) : (\n// \t\t\t\t\t\t\t<>\n// \t\t\t\t\t\t\t\tClick to Upload a PDF\n// \t\t\t\t\t\t\t\t<br />\n// \t\t\t\t\t\t\t\t<span>...or drag and drop a file.</span>\n// \t\t\t\t\t\t\t</>\n// \t\t\t\t\t\t)}\n\t\t\t\n// \t\t\t\t\t</label>\n// \t\t\t\t\t<input\n// \t\t\t\t\t  type=\"file\"\n// \t\t\t\t\t  id=\"fileUpload\"\n// \t\t\t\t\t  accept=\"application/pdf\"\n// \t\t\t\t\t  onChange={handleFileUpload}\n// \t\t\t\t\t  className={styles.hidden_input}\n// \t\t\t\t\t  disabled={isUploading || isLoading} // Disable upload while processing\n// \t\t\t\t\t  //disabled={isUploading} // Disable upload while processing\n// \t\t\t\t\t/>\n// \t\t\t\t  </div>\n// \t\t\t\t</div>\n// \t\t\t  </div>\n// \t\t\t  {/* Submit Button */}\n// \t\t\t  <button\n// \t\t\t\tclassName={styles.submit_btn}\n// \t\t\t\tonClick={handleSubmit}\n// \t\t\t\tdisabled={!inputText.trim() || isLoading || isUploading}\n// \t\t\t\tid=\"simplifyBtn\"\n// \t\t\t\t//title={!inputText.trim() ? \"Enter text or upload a file to enable simplification.\" : \"\"}\n// \t\t\t  >\n// \t\t\t\t{isLoading ? \"Processing...\" : \"Simplify Text\"}\n// \t\t\t  </button>\n\t\n// \t\t\t  <p className={styles.help_text}>Need Help? <a href=\"mailto:anukumar@uw.edu\">Contact Support</a></p>\n// \t\t\t  <Footer />  \n//       </div>\n\n//       </div>\n\t  \n//     </>\n//   );\n// };\n\n// export default Main;\n\n\n\n\n// v2\n// import React, { useState, useEffect, useRef, useCallback  } from \"react\";\n// import styles from \"./styles.module.css\";\n// import { useNavigate } from \"react-router-dom\";\n// import * as pdfjsLib from \"pdfjs-dist/legacy/build/pdf\";\n// // import { BrowserRouter as Router, Routes, Route, useNavigate } from \"react-router-dom\";\n// import { jwtDecode } from \"jwt-decode\";\n// import Footer from \"../Footer\";\n// import { calcMetrics } from \"../../utils/textMetrics\";\n// import StatsButton from \"../StatsButton\";\n\n// pdfjsLib.GlobalWorkerOptions.workerSrc = `${process.env.PUBLIC_URL}/pdf.worker.mjs`;\n\n// // Updated prefsToPlain function to work with expanded structure preferences\n// const prefsToPlain = (inputWordCount, outputLength, customWordCount, structurePrefs, tonePreference) => {\n//   const sections = [];\n\n//   // Helper function to calculate word counts\n//   const calculateWordCount = (inputWordCount, type, customWordCount) => {\n//     switch(type) {\n//       case \"shorter\": return Math.round(inputWordCount * 0.75);\n//       case \"much_shorter\": return Math.round(inputWordCount * 0.5);\n//       case \"custom\": return customWordCount;\n//       default: return inputWordCount;\n//     }\n//   };\n\n//   // Output length\n//   const targetWordCount = calculateWordCount(inputWordCount, outputLength, customWordCount);\n//   if (outputLength !== \"same\") {\n//     sections.push(`• Limit final output to **${targetWordCount} words**.`);\n//   }\n\n//   // Organization & Structure\n//   const organizationPrefs = [];\n//   if (structurePrefs.sectionHeadings) organizationPrefs.push(\"add clear section headings\");\n//   if (structurePrefs.bulletLists) organizationPrefs.push(\"use bullet points or numbered lists for sequences and key points\");\n//   if (structurePrefs.shortParagraphs) organizationPrefs.push(\"keep paragraphs to 2-3 sentences maximum\");\n//   if (structurePrefs.addWhiteSpace) organizationPrefs.push(\"add white space between key ideas for visual breaks\");\n  \n//   if (organizationPrefs.length > 0) {\n//     sections.push(\"• Organization: \" + organizationPrefs.join(\", \") + \".\");\n//   }\n\n//   // Sentence Structure\n//   const sentencePrefs = [];\n//   if (structurePrefs.sentenceSplitting) sentencePrefs.push(\"break sentences longer than 10-15 words\");\n//   if (structurePrefs.activeVoice) sentencePrefs.push(\"convert passive voice to active voice\");\n//   if (structurePrefs.avoidNestedClauses) sentencePrefs.push(\"simplify nested clauses and complex sentence structures\");\n//   if (structurePrefs.clearPronouns) sentencePrefs.push(\"avoid ambiguous pronouns like 'they,' 'it,' 'this'\");\n  \n//   if (sentencePrefs.length > 0) {\n//     sections.push(\"• Sentence structure: \" + sentencePrefs.join(\", \") + \".\");\n//   }\n\n//   // Vocabulary & Clarity\n//   const vocabularyPrefs = [];\n//   if (structurePrefs.useEverydayLanguage) vocabularyPrefs.push(\"replace complex words with simple, everyday language\");\n//   if (structurePrefs.defineComplexTerms) vocabularyPrefs.push(\"define unavoidable complex terms in parentheses\");\n//   if (structurePrefs.expandAcronyms) vocabularyPrefs.push(\"expand acronyms and abbreviations\");\n//   if (structurePrefs.avoidJargon) vocabularyPrefs.push(\"remove technical jargon and specialized language\");\n//   if (structurePrefs.avoidIdioms) vocabularyPrefs.push(\"avoid idioms, metaphors, and culturally specific references\");\n//   if (structurePrefs.avoidDoubleNegatives) vocabularyPrefs.push(\"eliminate double negatives and use positive statements\");\n//   if (structurePrefs.consistentTerms) vocabularyPrefs.push(\"use consistent terminology and avoid confusing synonyms\");\n  \n//   if (vocabularyPrefs.length > 0) {\n//     sections.push(\"• Vocabulary: \" + vocabularyPrefs.join(\", \") + \".\");\n//   }\n\n//   // Engagement & Formatting\n//   const engagementPrefs = [];\n//   if (structurePrefs.directAddress) engagementPrefs.push(\"use direct address with 'you' or 'we' where appropriate\");\n//   if (structurePrefs.boldKeyTerms) engagementPrefs.push(\"use bold formatting for key terms and warnings\");\n  \n//   if (engagementPrefs.length > 0) {\n//     sections.push(\"• Engagement: \" + engagementPrefs.join(\", \") + \".\");\n//   }\n\n//   // Tone\n//   if (tonePreference !== \"neutral\") {\n//     sections.push(`• Use a **${tonePreference}** tone while maintaining accessibility.`);\n//   }\n\n//   return sections.length ? sections.join(\"\\n\") : \"• Follow standard text simplification guidelines.\";\n// };\n\n  \n// const Main = () => {\n\n// \tconst [inputText, setInputText] = useState(\"\");\n// \tconst [outputText, setOutputText] = useState(\"\");\n// \tconst [isLoading, setIsLoading] = useState(false);\n// \tconst [isSubmitted, setIsSubmitted] = useState(false);\n// \tconst [isEditable, setIsEditable] = useState(false); // For toggling edit mode\n// \tconst [uploadedFileName, setUploadedFileName] = useState(\"\"); // State for file name\n// \tconst [isSaveButtonVisible, setIsSaveButtonVisible] = useState(true);\n// \tconst [showSurveyPrompt, setShowSurveyPrompt] = useState(false); // State for survey prompt\n\n// \tconst [documents, setDocuments] = useState([]); // Store user documents\n// \tconst [selectedDocument, setSelectedDocument] = useState(null); // Selected doc\n// \tconst [isSidebarVisible, setIsSidebarVisible] = useState(false); // Sidebar toggle\n\n// \tconst navigate = useNavigate();\n// \tconst [isUploading, setIsUploading] = useState(false); // State for showing buffer\n\n// \tconst user = JSON.parse(localStorage.getItem(\"user\"));\n// \tconst email = user?.email;\n\n// \tconst [inputWordCount, setInputWordCount] = useState(0);\n// \tconst [inputCharCount, setInputCharCount] = useState(0);\n// \tconst [pdfPageCount, setPdfPageCount] = useState(0);\n\n// \tconst inputTextSnapshot = useRef(\"\");\n// \tconst [pdfPath, setPdfPath] = useState(\"\"); \n\n// \t// Updated state variables for your customization requirements\n// \tconst [outputLength, setOutputLength] = useState(\"same\"); // \"same\", \"shorter\", \"much_shorter\", \"custom\"\n// \tconst [customWordCount, setCustomWordCount] = useState(\"\");\n\n// \t// Structure preferences - extracted from your existing prompt\n// \tconst [structurePrefs, setStructurePrefs] = useState({\n// \t  // Organization & Structure\n// \t  sectionHeadings: true,\n// \t  bulletLists: true,\n// \t  shortParagraphs: true,\n\t  \n// \t  // Sentence Structure\n// \t  sentenceSplitting: true,\n// \t  activeVoice: true,\n// \t  avoidNestedClauses: true,\n// \t  clearPronouns: true,\n\t  \n// \t  // Vocabulary & Clarity\n// \t  defineComplexTerms: true,\n// \t  expandAcronyms: true,\n// \t  avoidJargon: true,\n// \t  avoidIdioms: true,\n// \t  avoidDoubleNegatives: true,\n// \t  useEverydayLanguage: true,\n\t  \n// \t  // Formatting & Visual\n// \t  boldKeyTerms: true,\n// \t  addWhiteSpace: true,\n// \t  directAddress: true, // Use \"you\" or \"we\"\n// \t  consistentTerms: true, // Avoid synonyms that may confuse\n\t  \n// \t  // Special Features\n// \t  showChanges: false // This one defaults to OFF\n// \t});\n\n// \tconst [tonePreference, setTonePreference] = useState(\"neutral\"); // \"neutral\", \"academic\", \"formal\", \"creative\"\n\n// \tconst [showCustom,  setShowCustom]  = useState(false);  // accordion open/close\n\n// \t// Helper function to calculate word counts based on input\n// \tconst calculateWordCount = (inputWordCount, type) => {\n// \t  switch(type) {\n// \t\tcase \"shorter\": return Math.round(inputWordCount * 0.75);\n// \t\tcase \"much_shorter\": return Math.round(inputWordCount * 0.5);\n// \t\tcase \"custom\": return customWordCount;\n// \t\tdefault: return inputWordCount;\n// \t  }\n// \t};\n\n// \t// Toggle function for structure preferences\n// \tconst toggleStructurePref = (key) => {\n// \t  setStructurePrefs(prev => ({\n// \t\t...prev,\n// \t\t[key]: !prev[key]\n// \t  }));\n// \t};\n\n//   const handleLogout = () => {\n//     localStorage.removeItem(\"token\");\n//     navigate(\"/Login\"); \n//   };\n\n//     // Load user's past documents (original texts only)\n// \tuseEffect(() => {\n// \t\tif (!email) return;\n\t\n// \t\tconst fetchDocuments = async () => {\n// \t\t  try {\n// \t\t\tconst response = await fetch(\n// \t\t\t  `https://textsimplification12-a0a8gqfbhnhxbgbv.westus-01.azurewebsites.net/api/simplifications/user/${email}`\n// \t\t\t);\n// \t\t\tconst result = await response.json();\n\t\n// \t\t\tif (response.ok) {\n// \t\t\t  const sortedDocs = result.data.sort(\n// \t\t\t\t(a, b) => new Date(b.createdAt) - new Date(a.createdAt)\n// \t\t\t  );\n// \t\t\t  setDocuments(sortedDocs);\n// \t\t\t} else {\n// \t\t\t  console.error(\"Error fetching documents:\", result.message);\n// \t\t\t}\n// \t\t  } catch (error) {\n// \t\t\tconsole.error(\"Error fetching documents:\", error);\n// \t\t  }\n// \t\t};\n\t\n// \t\tfetchDocuments();\n// \t  }, [email]);\n\n// \t  // Handle document selection from history\n//   const handleDocumentClick = (doc) => {\n//     setSelectedDocument(doc);\n//     setInputText(doc.inputText);\n//   };\n\n//   \tconst handleFileUpload = async (event) => {\n// \t  const file = event.target.files[0];\n// \t  setPdfPath(`/uploads/${file.name}`);    \n\n// \t  if (!file) return;\n  \n// \t  setIsUploading(true); // Show buffer while processing\n// \t  setUploadedFileName(file.name); // Set file name\n\n// \t  try {\n// \t\t//setUploadedFileName(file.name); // Set the uploaded file name\n// \t\tconst fileReader = new FileReader();\n// \t\tfileReader.onload = async function () {\n// \t\t  const typedArray = new Uint8Array(this.result);\n  \n// \t\t  const pdf = await pdfjsLib.getDocument(typedArray).promise;\n\n// \t\t  setPdfPageCount(pdf.numPages);\n\n// \t\t  let text = \"\";\n  \n// \t\t  // Extract text from all pages\n// \t\t  for (let i = 1; i <= pdf.numPages; i++) {\n// \t\t\tconst page = await pdf.getPage(i);\n// \t\t\tconst textContent = await page.getTextContent();\n// \t\t\ttext += textContent.items.map((item) => item.str).join(\" \");\n// \t\t  }\n  \n// \t\t  setInputText(text);\n// \t\t};\n// \t\tfileReader.readAsArrayBuffer(file);\n// \t  } catch (error) {\n// \t\tconsole.error(\"Error reading PDF:\", error);\n// \t\talert(\"Failed to extract text from the PDF.\");\n// \t  } finally {\n// \t\tsetIsUploading(false); // Hide buffer once done\n// \t  }\n// \t};\n \n// \tconst countWordsAndChars = (text) => {\n// \t\tconst words = text.trim().split(/\\s+/).filter(Boolean).length;\n// \t\tconst chars = text.length;\n// \t\treturn { words, chars };\n// \t  };\n\t  \n// \t    useEffect(() => {\n// \t\t  const { words: inputWords, chars: inputChars } = countWordsAndChars(inputText);\n\n// \t\t  setInputWordCount(inputWords);\n// \t\t  setInputCharCount(inputChars);\n\n// \t\t}, [inputText]);\n\t  \n// \t\tconst saveInitialSimplification = async (trimmedInput, cleanedOutput) => {\n// \t\t\tconst user = JSON.parse(localStorage.getItem(\"user\"));\n// \t\t\tif (!user) return;\n\n// \t\t\tawait fetch(\"https://textsimplification12-a0a8gqfbhnhxbgbv.westus-01.azurewebsites.net/api/simplifications\", {\n// \t\t\t\tmethod: \"POST\",\n// \t\t\t\theaders: { \"Content-Type\": \"application/json\" },\n// \t\t\t\tbody: JSON.stringify({\n// \t\t\t\tuserId: user._id,\n// \t\t\t\temail,\n// \t\t\t\tinputText: trimmedInput,\n// \t\t\t\toutputText: cleanedOutput,\n// \t\t\t\tpdfName: uploadedFileName || null,\n// \t\t\t\tpdfPath: pdfPath || null,\n// \t\t\t\t}),\n// \t\t\t});\n// \t\t};\n\n\n// \t\tconst generatePrompt = useCallback((inputText) => {\n// \t\t\tconst prefsText = prefsToPlain(inputWordCount, outputLength, customWordCount, structurePrefs, tonePreference);\n\t\n// \t\t\treturn `\n// \t\t### USER‑SPECIFIC CUSTOMISATIONS (please follow **strictly**)\n// \t\t${prefsText || \"• No special preferences.\"}\n\t\t\n// \t\tYou are an expert in accessible communication, tasked with transforming complex text into clear, accessible plain language for individuals with Intellectual and Developmental Disabilities (IDD) or those requiring simplified content. Retain all essential information and intent while prioritizing readability, comprehension, and inclusivity.\n\n// \t\tText simplification refers to rewriting or adapting text to make it easier to read and understand while keeping the same level of detail and precision. Make sure you focus on simplification and not summarization. The length of generated output text must be similar to that of input text.\n\n// \t\tStick to the provided input text and only simplify the language. Don't provide the answer or hallucinate or provide any irrelevant information, not mentioned in the input text. \n\n// \t\tGuidelines for Simplification:\n// \t\tVocabulary and Terminology:\n// \t\tReplace uncommon, technical, or abstract words with simple, everyday language.\n// \t\tDefine unavoidable complex terms in plain language within parentheses upon first use (example: \"cardiologist (heart doctor)\").\n// \t\tAvoid idioms, metaphors, sarcasm, or culturally specific references.\n\n// \t\tSentence Structure:\n// \t\tUse short sentences (10--15 words max). Break long sentences into 1–2 ideas each.\n// \t\tPrefer active voice (example: \"The doctor examined the patient\" vs. \"The patient was examined by the doctor\").\n// \t\tAvoid nested clauses, passive voice, and ambiguous pronouns (example: \"they,\" \"it\").\n\n// \t\tClarity and Flow:\n// \t\tOrganize content logically, using headings/subheadings to group related ideas.\n// \t\tUse bullet points or numbered lists for steps, options, or key points.\n// \t\tEnsure each paragraph focuses on one main idea.\n\n// \t\tTone and Engagement:\n// \t\tWrite in a neutral, conversational tone (avoid formal or academic language).\n// \t\tAddress the reader directly with \"you\" or \"we\" where appropriate.\n// \t\tUse consistent terms for concepts (avoid synonyms that may confuse).\n\n// \t\tAvoid Exclusionary Elements:\n// \t\tRemove jargon, acronyms (unless defined), and expand abbreviations if needed (example: \"ASAP\" → \"as soon as possible\").\n// \t\tEliminate metaphors, idioms, or implied meanings (example: \"hit the books\" → \"study\").\n// \t\tAvoid double negatives (example: \"not uncommon\" → \"common\").\n\n// \t\tStructural Support:\n// \t\tAdd clear headings to label sections (example: \"How to Apply for Benefits\").\n// \t\tUse formatting tools like bold for key terms or warnings.\n// \t\tChunk information into short paragraphs with line breaks for visual ease.\n\n// \t\tInclusivity Checks:\n// \t\tEnsure content is free of bias, stereotypes, or assumptions about the reader.\n// \t\tUse gender-neutral language (example: \"they\" instead of \"he/she\").\n\n\n// \t\tOutput Requirements:\n// \t\tReturn only the simplified text, without markdown, emojis, or images.\n// \t\tPreserve original context, facts, and intent. Do not omit critical details.\n// \t\tPrioritize clarity over brevity; focus on simplification and not summarization. The length of generated output text should be same or similar to that of input text.\n// \t\tDo not simplify already simple text.\n\n// \t\tExample Transformation:\n// \t\tOriginal: \"Individuals experiencing adverse climatic conditions may necessitate relocation to mitigate health risks.\"\n// \t\tSimplified: \"If weather conditions become dangerous, people might need to move to stay safe.\"\n\n// \t\tFor the provided input text, apply the above guidelines rigorously. Ensure the output is accessible to readers with varied cognitive abilities, emphasizing clarity, simplicity, and logical structure. Verify that the simplified text aligns with plain language standards like WCAG and PlainLanguage.gov.\n\n// \t\t\"${inputText}\"\n// \t\t`;\n// \t\t  }, [inputWordCount, outputLength, customWordCount, structurePrefs, tonePreference]);\n\n//   const splitTextIntoChunks = (text, maxTokens) => {\n// \tconst words = text.split(\" \");\n// \tlet chunks = [];\n// \tlet currentChunk = [];\n  \n// \tfor (let word of words) {\n// \t  if (currentChunk.join(\" \").length + word.length < maxTokens) {\n// \t\tcurrentChunk.push(word);\n// \t  } else {\n// \t\tchunks.push(currentChunk.join(\" \"));\n// \t\tcurrentChunk = [word];\n// \t  }\n// \t}\n// \tif (currentChunk.length > 0) chunks.push(currentChunk.join(\" \"));\n// \treturn chunks;\n//   };\n\n\n//   const handleSubmit = async () => {\n\n// \t// const inputText = document.getElementById('inputText').value;\n// \tconst trimmedInput = inputText.trim();\n// \tif (!trimmedInput) return;\n\n// \t// inputTextSnapshot.current = inputText; \n// \tsetIsLoading(true);\n  \n// \ttry {\n// \t  const chunks = splitTextIntoChunks(trimmedInput, 10000);\n// \t  let combinedOutput = \"\";\n  \n// \t  for (let chunk of chunks) {\n// \t\tconst prompt = generatePrompt(chunk);\n// \t\tconst response = await fetch(\"https://textsimplification12-a0a8gqfbhnhxbgbv.westus-01.azurewebsites.net/api/gpt4\", {\n// \t\t  method: \"POST\",\n// \t\t  headers: { \"Content-Type\": \"application/json\" },\n// \t\t  body: JSON.stringify({ prompt }),\n// \t\t});\n\t\t\n// \t\tif (!response.ok) {\n// \t\t\tconsole.error(`API request failed with status: ${response.status}`);\n// \t\t\tcontinue; // Skip this chunk if the API request failed\n// \t\t  }\n\n// \t\tconst data = await response.json();\n// \t\tconsole.log(\"Full API Response: \", data);\n\n\n// \t\tconst data1 = data?.response?.replace(/^\"|\"$/g, \"\") || \"No response received.\"; // Append results\n// \t\tcombinedOutput += data1 + \" \";\n// \t}\n// \t  console.log(\"Final Combined Output: \", combinedOutput);\n\n// \tconsole.log(\"Data: \", combinedOutput);\n\n// \tconst cleanedResponse = combinedOutput.trim();\n// \tsetOutputText(cleanedResponse);\n// \tsetIsSubmitted(true);\n\n// \tawait saveInitialSimplification(trimmedInput, cleanedResponse);\n// \tnavigate(\"/review\", { state: { inputText: trimmedInput, outputText: cleanedResponse } });\n// \t// navigate(\"/review\", { state: { inputText: trimmedInput, outputText: cleanedResponse } });\n\t\n// \t} catch (error) {\n// \t  console.error(\"Error fetching GPT-4o response:\", error);\n// \t  setOutputText(\"An error occurred while simplifying the text.\");\n// \t}\n  \n// \tsetIsLoading(false);\n//   };\n\n  \n\n//   return (\n//     <>\n//       <nav className={styles.navbar}>\n//         {/* <h1>Text Simplification Tool</h1> */}\n// \t\t<h1 \n//     onClick={() => window.location.href = \"https://textsimplification12-a0a8gqfbhnhxbgbv.westus-01.azurewebsites.net/\"}\n//     style={{ cursor: \"pointer\" }} // Makes it look clickable\n//  \t\t>\n// \t\tText Simplification Tool</h1>\n//         <button className={styles.white_btn} onClick={handleLogout}>\n//           Logout\n//         </button>\n//       </nav>\n\n// \t  <div className={styles.container}>\n\n// \t\t\t <div\n// \t\t\t\t  className={`${styles.sidebar} ${\n// \t\t\t\t\tisSidebarVisible ? styles.expanded : \"\"\n// \t\t\t\t  }`}\n// \t\t\t\t>\n\n// \t\t\t{/* </div> */}\n\n// \t\t\t<button\n// \t\t\tclassName={styles.historyIcon}\n// \t\t\tonClick={() => setIsSidebarVisible(!isSidebarVisible)}\n// \t\t\t>\n// \t\t\t\t🕒   <p style={{ fontSize: \"15px\" }}> History </p> \n// \t\t\t</button>\n\n\n\n//           {isSidebarVisible && (\n//             <div className={styles.historyContent}>\n//               <button className={styles.closeButton} onClick={() => setIsSidebarVisible(false)}>\n//                 ✖\n//               </button>\n//               <ul className={styles.historyList}>\n//                 {documents.map((doc, index) => (\n    \n// \t\t\t\t<li\n// \t\t\t\tkey={doc._id}\n// \t\t\t\tonClick={() => handleDocumentClick(doc)}\n// \t\t\t\tclassName={`${styles.historyItem} ${selectedDocument?._id === doc._id ? styles.activeDoc : \"\"}`}\n// \t\t\t\t>\n// \t\t\t\t{/* <strong>Document {index + 1}</strong>  */}\n// \t\t\t\t<strong>Document {documents.length - index}</strong>({doc.inputText.substring(0, 20)}...)\n// \t\t\t\t</li>\n//                 ))}\n//               </ul>\n//             </div>\n//           )}\n//         </div>\n\n// \t  {/* <div className={styles.main_container}> */}\n\t  \n// \t  <div className={`${styles.mainContent} ${isSidebarVisible ? styles.withSidebar : \"\"}`}>\n         \n\n\n// \t\t\t<div className={styles.description}>\n\n// \t\t\t  <p>\n// \t\t\t  This tool helps make complex text easier to read while preserving its original meaning. Whether you're simplifying academic content, technical documents, or general text for better accessibility, this tool provides a quick and efficient way to generate a more readable version. You can enter text manually or upload a document to get started.\n// \t\t\t  </p>\n// \t</div>\n\n// \t        {/* ─── CUSTOMISATION PANEL  ─────────── */}\n// \t\t\t<section className={styles.customPanel}>\n// \t\t\t  {/* toggle row */}\n// \t\t\t  <button\n// \t\t\t\tclassName={styles.customToggle}\n// \t\t\t\tonClick={() => setShowCustom((s) => !s)}\n// \t\t\t  >\n// \t\t\t\t{showCustom ? \"▲  Hide Customisation Options\" : \"▼  Show Customisation Options\"}\n// \t\t\t  </button>\n\n\t\t\t \n// \t\t\t  <div className={`${styles.customPanel} ${showCustom ? \"\" : styles.hiddenPanel}`}>\n// \t\t\t\t<div className={styles.customBody}>\n\t\t\t\t  \n// \t\t\t\t  {/* 1. OUTPUT LENGTH SECTION */}\n// \t\t\t\t  <h3>Output Length</h3>\n// \t\t\t\t  <div className={styles.sliderContainer}>\n// \t\t\t\t\t{/* Visual slider representation */}\n// \t\t\t\t\t<div className={styles.sliderTrack}>\n// \t\t\t\t\t  <div className={styles.sliderMarkers}>\n// \t\t\t\t\t\t<span className={outputLength === \"same\" ? styles.activeMarker : styles.marker}>•</span>\n// \t\t\t\t\t\t<span className={outputLength === \"shorter\" ? styles.activeMarker : styles.marker}>•</span>\n// \t\t\t\t\t\t<span className={outputLength === \"much_shorter\" ? styles.activeMarker : styles.marker}>•</span>\n// \t\t\t\t\t  </div>\n// \t\t\t\t\t  <div className={styles.sliderLabels}>\n// \t\t\t\t\t\t<span>Same as input</span>\n// \t\t\t\t\t\t<span>Shorter</span>\n// \t\t\t\t\t\t<span>Much shorter</span>\n// \t\t\t\t\t  </div>\n// \t\t\t\t\t</div>\n\t\t\t\t\t\n// \t\t\t\t\t{/* Radio buttons for selection */}\n// \t\t\t\t\t<div className={styles.lengthOptions}>\n// \t\t\t\t\t  <label className={styles.lengthOption}>\n// \t\t\t\t\t\t<input \n// \t\t\t\t\t\t  type=\"radio\" \n// \t\t\t\t\t\t  name=\"outputLength\" \n// \t\t\t\t\t\t  value=\"same\"\n// \t\t\t\t\t\t  checked={outputLength === \"same\"}\n// \t\t\t\t\t\t  onChange={(e) => setOutputLength(e.target.value)}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span>Same as input ({inputWordCount} words)</span>\n// \t\t\t\t\t  </label>\n\t\t\t\t\t  \n// \t\t\t\t\t  <label className={styles.lengthOption}>\n// \t\t\t\t\t\t<input \n// \t\t\t\t\t\t  type=\"radio\" \n// \t\t\t\t\t\t  name=\"outputLength\" \n// \t\t\t\t\t\t  value=\"shorter\"\n// \t\t\t\t\t\t  checked={outputLength === \"shorter\"}\n// \t\t\t\t\t\t  onChange={(e) => setOutputLength(e.target.value)}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span>Shorter (~{Math.round(inputWordCount * 0.75)} words - 25% less)</span>\n// \t\t\t\t\t  </label>\n\t\t\t\t\t  \n// \t\t\t\t\t  <label className={styles.lengthOption}>\n// \t\t\t\t\t\t<input \n// \t\t\t\t\t\t  type=\"radio\" \n// \t\t\t\t\t\t  name=\"outputLength\" \n// \t\t\t\t\t\t  value=\"much_shorter\"\n// \t\t\t\t\t\t  checked={outputLength === \"much_shorter\"}\n// \t\t\t\t\t\t  onChange={(e) => setOutputLength(e.target.value)}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span>Much shorter (~{Math.round(inputWordCount * 0.5)} words - 50% less)</span>\n// \t\t\t\t\t  </label>\n\t\t\t\t\t  \n// \t\t\t\t\t  <label className={styles.lengthOption}>\n// \t\t\t\t\t\t<input \n// \t\t\t\t\t\t  type=\"radio\" \n// \t\t\t\t\t\t  name=\"outputLength\" \n// \t\t\t\t\t\t  value=\"custom\"\n// \t\t\t\t\t\t  checked={outputLength === \"custom\"}\n// \t\t\t\t\t\t  onChange={(e) => setOutputLength(e.target.value)}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span>Custom: </span>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"number\"\n// \t\t\t\t\t\t  min=\"10\"\n// \t\t\t\t\t\t  placeholder=\"Enter word count\"\n// \t\t\t\t\t\t  value={customWordCount}\n// \t\t\t\t\t\t  onChange={(e) => setCustomWordCount(e.target.value)}\n// \t\t\t\t\t\t  disabled={outputLength !== \"custom\"}\n// \t\t\t\t\t\t  style={{ width: \"100px\", marginLeft: \"8px\" }}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span> words</span>\n// \t\t\t\t\t  </label>\n// \t\t\t\t\t</div>\n// \t\t\t\t  </div>\n\n// \t\t\t\t  {/* 2. STRUCTURE & WRITING PREFERENCES */}\n// \t\t\t\t  <h3>Structure & Writing Preferences</h3>\n// \t\t\t\t  <div className={styles.structurePrefs}>\n\t\t\t\t\t\n// \t\t\t\t\t{/* Organization & Structure */}\n// \t\t\t\t\t<div className={styles.prefSection}>\n// \t\t\t\t\t  <h4>Organization & Structure</h4>\n\t\t\t\t\t  \n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.sectionHeadings}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('sectionHeadings')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Section headings</strong> - Add headings to organise sections\n// \t\t\t\t\t\t  <small className={styles.reference}>WCAG 2.2 & Easy-Read guidelines</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.bulletLists}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('bulletLists')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Bullet/numbered lists</strong> - Use bullet points for lists and steps\n// \t\t\t\t\t\t  <small className={styles.reference}>Nielsen Norman Group: lists improve comprehension</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.shortParagraphs}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('shortParagraphs')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Short paragraphs</strong> - Maximum 2-3 sentence paragraphs\n// \t\t\t\t\t\t  <small className={styles.reference}>Easy-Read conventions: ≤ 2 sentences per paragraph</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.addWhiteSpace}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('addWhiteSpace')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>White space between ideas</strong> - Add visual breaks for easier reading\n// \t\t\t\t\t\t  <small className={styles.reference}>Improves scannability and reduces cognitive load</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n// \t\t\t\t\t</div>\n\n// \t\t\t\t\t{/* Sentence Structure */}\n// \t\t\t\t\t<div className={styles.prefSection}>\n// \t\t\t\t\t  <h4>Sentence Structure</h4>\n\t\t\t\t\t  \n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.sentenceSplitting}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('sentenceSplitting')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Break long sentences</strong> - Split sentences longer than 10-15 words\n// \t\t\t\t\t\t  <small className={styles.reference}>Readable.com & PlainLanguage.gov guidelines</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.activeVoice}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('activeVoice')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Active voice</strong> - Convert passive to active voice\n// \t\t\t\t\t\t  <small className={styles.reference}>Minimal Text Complexity Guidelines</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.avoidNestedClauses}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('avoidNestedClauses')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Simplify nested clauses</strong> - Break complex sentence structures\n// \t\t\t\t\t\t  <small className={styles.reference}>Reduces processing difficulty for readers</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.clearPronouns}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('clearPronouns')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Clear pronoun references</strong> - Avoid ambiguous \"they,\" \"it,\" \"this\"\n// \t\t\t\t\t\t  <small className={styles.reference}>Prevents confusion about what pronouns refer to</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n// \t\t\t\t\t</div>\n\n// \t\t\t\t\t{/* Vocabulary & Clarity */}\n// \t\t\t\t\t<div className={styles.prefSection}>\n// \t\t\t\t\t  <h4>Vocabulary & Clarity</h4>\n\t\t\t\t\t  \n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.useEverydayLanguage}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('useEverydayLanguage')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Use everyday language</strong> - Replace complex words with simple alternatives\n// \t\t\t\t\t\t  <small className={styles.reference}>Core principle of plain language</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.defineComplexTerms}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('defineComplexTerms')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Define complex terms</strong> - Add simple explanations in parentheses\n// \t\t\t\t\t\t  <small className={styles.reference}>e.g., \"cardiologist (heart doctor)\"</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.expandAcronyms}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('expandAcronyms')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Expand acronyms</strong> - Write out abbreviated terms\n// \t\t\t\t\t\t  <small className={styles.reference}>e.g., \"ASAP\" → \"as soon as possible\"</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.avoidJargon}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('avoidJargon')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Remove jargon</strong> - Eliminate technical or specialized language\n// \t\t\t\t\t\t  <small className={styles.reference}>Makes content accessible to general audiences</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.avoidIdioms}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('avoidIdioms')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Avoid idioms & metaphors</strong> - Replace with literal language\n// \t\t\t\t\t\t  <small className={styles.reference}>e.g., \"hit the books\" → \"study\"</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.avoidDoubleNegatives}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('avoidDoubleNegatives')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Eliminate double negatives</strong> - Use positive statements\n// \t\t\t\t\t\t  <small className={styles.reference}>e.g., \"not uncommon\" → \"common\"</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.consistentTerms}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('consistentTerms')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Use consistent terms</strong> - Avoid synonyms that may confuse\n// \t\t\t\t\t\t  <small className={styles.reference}>Reduces cognitive load for readers</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n// \t\t\t\t\t</div>\n\n// \t\t\t\t\t{/* Engagement & Formatting */}\n// \t\t\t\t\t<div className={styles.prefSection}>\n// \t\t\t\t\t  <h4>Engagement & Formatting</h4>\n\t\t\t\t\t  \n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.directAddress}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('directAddress')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Direct address</strong> - Use \"you\" or \"we\" to engage readers\n// \t\t\t\t\t\t  <small className={styles.reference}>Creates conversational, accessible tone</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n\n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.boldKeyTerms}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('boldKeyTerms')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Highlight key terms</strong> - Use bold for important words and warnings\n// \t\t\t\t\t\t  <small className={styles.reference}>Aids scanning and comprehension</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n// \t\t\t\t\t</div>\n\n// \t\t\t\t\t{/* Special Features */}\n// \t\t\t\t\t<div className={styles.prefSection}>\n// \t\t\t\t\t  <h4>Review Features</h4>\n\t\t\t\t\t  \n// \t\t\t\t\t  <label className={styles.structureOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"checkbox\"\n// \t\t\t\t\t\t  checked={structurePrefs.showChanges}\n// \t\t\t\t\t\t  onChange={() => toggleStructurePref('showChanges')}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span className={styles.optionText}>\n// \t\t\t\t\t\t  <strong>Show changes while writing</strong> - Toggle above AI-generated text box\n// \t\t\t\t\t\t  <small className={styles.reference}>Useful for reviewing what was changed</small>\n// \t\t\t\t\t\t</span>\n// \t\t\t\t\t  </label>\n// \t\t\t\t\t</div>\n// \t\t\t\t  </div>\n\n// \t\t\t\t  {/* 3. TONE PREFERENCES */}\n// \t\t\t\t  <h3>Tone Preferences</h3>\n// \t\t\t\t  <div className={styles.toneOptions}>\n// \t\t\t\t\t{[\n// \t\t\t\t\t  { value: \"neutral\", label: \"Neutral\", default: true },\n// \t\t\t\t\t  { value: \"academic\", label: \"Academic\" },\n// \t\t\t\t\t  { value: \"formal\", label: \"Formal\" },\n// \t\t\t\t\t  { value: \"creative\", label: \"Creative\" }\n// \t\t\t\t\t].map((tone) => (\n// \t\t\t\t\t  <label key={tone.value} className={styles.toneOption}>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"radio\"\n// \t\t\t\t\t\t  name=\"tonePreference\"\n// \t\t\t\t\t\t  value={tone.value}\n// \t\t\t\t\t\t  checked={tonePreference === tone.value}\n// \t\t\t\t\t\t  onChange={(e) => setTonePreference(e.target.value)}\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t\t<span>{tone.label} {tone.default && \"<By default>\"}</span>\n// \t\t\t\t\t  </label>\n// \t\t\t\t\t))}\n// \t\t\t\t  </div>\n\t\t\t\t  \n// \t\t\t\t</div>\n// \t\t\t  </div>\n// \t\t\t</section>\n\n// \t\t\t{/*  */}\n\n// \t\t\t\t  <div className={styles.form_container}>\n// \t\t\t\t\t{/* Input Area */}\n// \t\t\t\t\t<div className={styles.input_area}>\n// \t\t\t\t\t  <div className={styles.text_container}>\n// \t\t\t\t\t\t<label className={styles.label} htmlFor=\"inputText\">\n// \t\t\t\t\t\t  Input Text\n// \t\t\t\t\t\t</label>\n// \t\t\t\t\t\t<textarea\n// \t\t\t\t\t\t  id=\"inputText\"\n// \t\t\t\t\t\t  className={`${styles.textarea} ${isLoading ? styles.disabled : \"\"}`}\n// \t\t\t\t\t\t//   className={styles.textarea}\n// \t\t\t\t\t\t  placeholder=\"Write/Paste your text here or upload a PDF document to extract content automatically.\"\n// \t\t\t\t\t\t  value={inputText}\n// \t\t\t\t\t\t  onChange={(e) => setInputText(e.target.value)}\n// \t\t\t\t\t\t  disabled={isLoading} // Disable input when loading\n// \t\t\t\t\t\t></textarea>\n\t\t\t\t\t \n// \t\t\t\t\t <p className={styles.countText}>Words: {inputWordCount} | Characters: {inputCharCount}\n// \t\t\t\t\t {pdfPageCount > 0 && ` | Pages: ${pdfPageCount}`}\n// \t\t\t\t\t </p>\n\t\t\t\t\t\t\n// \t\t\t\t\t  </div>\n\t  \n// \t\t\t\t\t  {/* OR Divider */}\n// \t\t\t\t\t  <div className={styles.or_divider}>OR</div>\n\t  \n// \t\t\t\t\t  {/* File Upload */}\n// \t\t\t\t\t  <div className={`${styles.upload_area} ${isLoading ? styles.disabled : \"\"}`}\n// \t\t\t\t\t\tonDragOver={(e) => e.preventDefault()} // Prevent default behavior\n// \t\t\t\t\t\tonDrop={(e) => {\n// \t\t\t\t\t\t\te.preventDefault();\n// \t\t\t\t\t\t\tconst file = e.dataTransfer.files[0]; // Get the first dropped file\n// \t\t\t\t\t\t\tif (file) {\n// \t\t\t\t\t\t\thandleFileUpload({ target: { files: [file] } }); // Simulate file selection event\n// \t\t\t\t\t\t\t}\n// \t\t\t\t\t\t}}>\n// \t\t\t\t\t\t<label htmlFor=\"fileUpload\" className={styles.upload_box}>\n\t\t\t\t\t\t\t\n// \t\t\t\t\t\t\t{isUploading ? (\n// \t\t\t\t\t\t\t\t<span className={styles.loadingText}>Extracting text, please wait...</span>\n// \t\t\t\t\t\t\t\t) : uploadedFileName ? (\n// \t\t\t\t\t\t\t\t<>\n// \t\t\t\t\t\t\t\t\tFile uploaded: <strong>{uploadedFileName}</strong>\n// \t\t\t\t\t\t\t\t</>\n// \t\t\t\t\t\t\t\t) : (\n// \t\t\t\t\t\t\t\t<>\n// \t\t\t\t\t\t\t\t\tClick to Upload a PDF\n// \t\t\t\t\t\t\t\t\t<br />\n// \t\t\t\t\t\t\t\t\t<span>...or drag and drop a file.</span>\n// \t\t\t\t\t\t\t\t</>\n// \t\t\t\t\t\t\t)}\n\t\t\t\t\n// \t\t\t\t\t\t</label>\n// \t\t\t\t\t\t<input\n// \t\t\t\t\t\t  type=\"file\"\n// \t\t\t\t\t\t  id=\"fileUpload\"\n// \t\t\t\t\t\t  accept=\"application/pdf\"\n// \t\t\t\t\t\t  onChange={handleFileUpload}\n// \t\t\t\t\t\t  className={styles.hidden_input}\n// \t\t\t\t\t\t  disabled={isUploading || isLoading} // Disable upload while processing\n// \t\t\t\t\t\t  //disabled={isUploading} // Disable upload while processing\n// \t\t\t\t\t\t/>\n// \t\t\t\t\t  </div>\n// \t\t\t\t\t</div>\n// \t\t\t\t  </div>\n// \t\t\t\t  {/* Submit Button */}\n// \t\t\t\t  <button\n// \t\t\t\t\tclassName={styles.submit_btn}\n// \t\t\t\t\tonClick={handleSubmit}\n// \t\t\t\t\tdisabled={!inputText.trim() || isLoading || isUploading}\n// \t\t\t\t\tid=\"simplifyBtn\"\n// \t\t\t\t\t//title={!inputText.trim() ? \"Enter text or upload a file to enable simplification.\" : \"\"}\n// \t\t\t\t  >\n// \t\t\t\t\t{isLoading ? \"Processing...\" : \"Simplify Text\"}\n// \t\t\t\t  </button>\n\t\t\n// \t\t\t\t  <p className={styles.help_text}>Need Help? <a href=\"mailto:anukumar@uw.edu\">Contact Support</a></p>\n// \t\t\t\t  <Footer />  \n// \t\t      </div>\n\n// \t\t      </div>\n\t\t\t  \n// \t\t    </>\n// \t\t  );\n// \t\t};\n\n// \t\texport default Main;\n\n\n// v3\n\nimport React, { useState, useEffect, useRef, useCallback  } from \"react\";\nimport styles from \"./styles.module.css\";\nimport { useNavigate } from \"react-router-dom\";\nimport * as pdfjsLib from \"pdfjs-dist/legacy/build/pdf\";\n// import { BrowserRouter as Router, Routes, Route, useNavigate } from \"react-router-dom\";\nimport { jwtDecode } from \"jwt-decode\";\nimport Footer from \"../Footer\";\nimport { calcMetrics } from \"../../utils/textMetrics\";\nimport StatsButton from \"../StatsButton\";\n\npdfjsLib.GlobalWorkerOptions.workerSrc = `${process.env.PUBLIC_URL}/pdf.worker.mjs`;\n\nconst prefsToPlain = (\n  inputWordCount,\n  outputLength,\n  prefs,\n  tone,\n  additionalInstructions,\n) => {\n  const sections = [];\n\n  // Calculate target word count based on slider selection\n  const lengthRatios = {\n    very_simple: 0.4,\n    much_shorter: 0.5,\n    shorter: 0.75,\n    same: 1.0,\n  };\n  const ratio = lengthRatios[outputLength] ?? 1.0;\n  const target = Math.round(inputWordCount * ratio);\n  if (outputLength !== \"same\") {\n    sections.push(`• Limit output to about **${target} words**.`);\n  }\n\n  // Structure and formatting\n  if (prefs.sectionHeadings) {\n    sections.push(\"• Add clear section headings.\");\n  } else {\n    sections.push(\"• Do not add section headings.\");\n  }\n  if (prefs.bulletLists) {\n    sections.push(\"• Use bullet points or numbered lists for steps and key points.\");\n  } else {\n    sections.push(\"• Avoid using bullet points or numbered lists.\");\n  }\n  if (prefs.shortParagraphs) {\n    sections.push(\"• Keep paragraphs to 2–3 sentences.\");\n  } else {\n    sections.push(\"• Paragraph length may remain as in the original text.\");\n  }\n\n  // Sentence style\n  if (prefs.breakLongSentences) {\n    sections.push(\"• Break long sentences into shorter ones.\");\n  } else {\n    sections.push(\"• Preserve original sentence lengths when possible.\");\n  }\n  if (prefs.activeVoice) {\n    sections.push(\"• Use active voice instead of passive.\");\n  } else {\n    sections.push(\"• Passive voice is acceptable.\");\n  }\n  if (prefs.simplifyClauses) {\n    sections.push(\"• Simplify nested clauses and complex sentence structures.\");\n  } else {\n    sections.push(\"• Do not simplify nested clauses.\");\n  }\n\n  // Vocabulary and clarity\n  if (prefs.useSimpleLanguage) {\n    sections.push(\"• Replace complex words with simple, everyday language.\");\n  } else {\n    sections.push(\"• Keep original vocabulary complexity.\");\n  }\n  if (prefs.defineTerms) {\n    sections.push(\"• Define unavoidable complex terms in parentheses.\");\n  } else {\n    sections.push(\"• Do not define complex terms.\");\n  }\n  if (prefs.expandAcronyms) {\n    sections.push(\"• Expand acronyms and abbreviations.\");\n  } else {\n    sections.push(\"• Leave acronyms and abbreviations unchanged.\");\n  }\n  if (prefs.avoidJargon) {\n    sections.push(\"• Avoid jargon, idioms, and culturally specific references.\");\n  } else {\n    sections.push(\"• Keep original jargon and idioms.\");\n  }\n\n  // Tone\n  if (tone && tone !== \"neutral\") {\n    sections.push(`• Use a **${tone}** tone while maintaining accessibility.`);\n  }\n\n  // Additional user instructions\n  if (additionalInstructions && additionalInstructions.trim().length > 0) {\n    sections.push(`• ${additionalInstructions.trim()}`);\n  }\n\n  return sections.join(\"\\n\");\n};\n\n\n  \nconst Main = () => {\n\n\tconst [inputText, setInputText] = useState(\"\");\n\tconst [outputText, setOutputText] = useState(\"\");\n\tconst [isLoading, setIsLoading] = useState(false);\n\tconst [isSubmitted, setIsSubmitted] = useState(false);\n\tconst [isEditable, setIsEditable] = useState(false); // For toggling edit mode\n\tconst [uploadedFileName, setUploadedFileName] = useState(\"\"); // State for file name\n\tconst [isSaveButtonVisible, setIsSaveButtonVisible] = useState(true);\n\tconst [showSurveyPrompt, setShowSurveyPrompt] = useState(false); // State for survey prompt\n\n\tconst [documents, setDocuments] = useState([]); // Store user documents\n\tconst [selectedDocument, setSelectedDocument] = useState(null); // Selected doc\n\tconst [isSidebarVisible, setIsSidebarVisible] = useState(false); // Sidebar toggle\n\n\tconst navigate = useNavigate();\n\tconst [isUploading, setIsUploading] = useState(false); // State for showing buffer\n\n\tconst user = JSON.parse(localStorage.getItem(\"user\"));\n\tconst email = user?.email;\n\n\tconst [inputWordCount, setInputWordCount] = useState(0);\n\tconst [inputCharCount, setInputCharCount] = useState(0);\n\tconst [pdfPageCount, setPdfPageCount] = useState(0);\n\tconst [showCustom,  setShowCustom]  = useState(false);  \n\n\tconst inputTextSnapshot = useRef(\"\");\n\tconst [pdfPath, setPdfPath] = useState(\"\"); \n\n\t // Output length\n\n  const lengthOptions = [\"same\", \"shorter\", \"much_shorter\", \"very_simple\"];\n\n  const [outputLength, setOutputLength] = useState(\"same\");\n\n  const [customWordCount, setCustomWordCount] = useState(\"\");\n\n\n  const [prefs, setPrefs] = useState({\n\t// Structure & Formatting\n\tsectionHeadings: true,\n\tbulletLists: true,\n\tshortParagraphs: true,\n\t// Sentence Style\n\tbreakLongSentences: true,\n\tactiveVoice: true,\n\tsimplifyClauses: true,\n\t// Vocabulary & Clarity\n\tuseSimpleLanguage: true,\n\tdefineTerms: true,\n\texpandAcronyms: true,\n\tavoidJargon: true,\n  });\n\n  const [tonePreference, setTonePreference] = useState(\"neutral\");\n  const [additionalInstructions, setAdditionalInstructions] = useState(\"\");\n\n  // Toggle a preference on/off\n  const togglePref = (key) => {\n    setPrefs((prev) => ({ ...prev, [key]: !prev[key] }));\n  };\n\n\t// Helper function to calculate word counts based on input\n\tconst calculateWordCount = (inputWordCount, type) => {\n\t  switch(type) {\n\t\tcase \"shorter\": return Math.round(inputWordCount * 0.75);\n\t\tcase \"much_shorter\": return Math.round(inputWordCount * 0.5);\n\t\tcase \"custom\": return customWordCount;\n\t\tdefault: return inputWordCount;\n\t  }\n\t};\n\n\n\n  const handleLogout = () => {\n    localStorage.removeItem(\"token\");\n    navigate(\"/Login\"); \n  };\n\n    // Load user's past documents (original texts only)\n\tuseEffect(() => {\n\t\tif (!email) return;\n\t\n\t\tconst fetchDocuments = async () => {\n\t\t  try {\n\t\t\tconst response = await fetch(\n\t\t\t  `https://textsimplification12-a0a8gqfbhnhxbgbv.westus-01.azurewebsites.net/api/simplifications/user/${email}`\n\t\t\t);\n\t\t\tconst result = await response.json();\n\t\n\t\t\tif (response.ok) {\n\t\t\t  const sortedDocs = result.data.sort(\n\t\t\t\t(a, b) => new Date(b.createdAt) - new Date(a.createdAt)\n\t\t\t  );\n\t\t\t  setDocuments(sortedDocs);\n\t\t\t} else {\n\t\t\t  console.error(\"Error fetching documents:\", result.message);\n\t\t\t}\n\t\t  } catch (error) {\n\t\t\tconsole.error(\"Error fetching documents:\", error);\n\t\t  }\n\t\t};\n\t\n\t\tfetchDocuments();\n\t  }, [email]);\n\n\t  // Handle document selection from history\n  const handleDocumentClick = (doc) => {\n    setSelectedDocument(doc);\n    setInputText(doc.inputText);\n  };\n\n  \tconst handleFileUpload = async (event) => {\n\t  const file = event.target.files[0];\n\t  setPdfPath(`/uploads/${file.name}`);    \n\n\t  if (!file) return;\n  \n\t  setIsUploading(true); // Show buffer while processing\n\t  setUploadedFileName(file.name); // Set file name\n\n\t  try {\n\t\t//setUploadedFileName(file.name); // Set the uploaded file name\n\t\tconst fileReader = new FileReader();\n\t\tfileReader.onload = async function () {\n\t\t  const typedArray = new Uint8Array(this.result);\n  \n\t\t  const pdf = await pdfjsLib.getDocument(typedArray).promise;\n\n\t\t  setPdfPageCount(pdf.numPages);\n\n\t\t  let text = \"\";\n  \n\t\t  // Extract text from all pages\n\t\t  for (let i = 1; i <= pdf.numPages; i++) {\n\t\t\tconst page = await pdf.getPage(i);\n\t\t\tconst textContent = await page.getTextContent();\n\t\t\ttext += textContent.items.map((item) => item.str).join(\" \");\n\t\t  }\n  \n\t\t  setInputText(text);\n\t\t};\n\t\tfileReader.readAsArrayBuffer(file);\n\t  } catch (error) {\n\t\tconsole.error(\"Error reading PDF:\", error);\n\t\talert(\"Failed to extract text from the PDF.\");\n\t  } finally {\n\t\tsetIsUploading(false); // Hide buffer once done\n\t  }\n\t};\n \n\tconst countWordsAndChars = (text) => {\n\t\tconst words = text.trim().split(/\\s+/).filter(Boolean).length;\n\t\tconst chars = text.length;\n\t\treturn { words, chars };\n\t  };\n\t  \n\t    useEffect(() => {\n\t\t  const { words: inputWords, chars: inputChars } = countWordsAndChars(inputText);\n\n\t\t  setInputWordCount(inputWords);\n\t\t  setInputCharCount(inputChars);\n\n\t\t}, [inputText]);\n\t  \n\t\tconst saveInitialSimplification = async (trimmedInput, cleanedOutput) => {\n\t\t\tconst user = JSON.parse(localStorage.getItem(\"user\"));\n\t\t\tif (!user) return;\n\n\t\t\tawait fetch(\"https://textsimplification12-a0a8gqfbhnhxbgbv.westus-01.azurewebsites.net/api/simplifications\", {\n\t\t\t\tmethod: \"POST\",\n\t\t\t\theaders: { \"Content-Type\": \"application/json\" },\n\t\t\t\tbody: JSON.stringify({\n\t\t\t\tuserId: user._id,\n\t\t\t\temail,\n\t\t\t\tinputText: trimmedInput,\n\t\t\t\toutputText: cleanedOutput,\n\t\t\t\tpdfName: uploadedFileName || null,\n\t\t\t\tpdfPath: pdfPath || null,\n\t\t\t\t}),\n\t\t\t});\n\t\t};\n\n  const generatePrompt = useCallback(\n\t(chunk) => {\n\t  const prefsText = prefsToPlain(\n\t\tinputWordCount,\n\t\toutputLength,\n\t\tprefs,\n\t\ttonePreference,\n\t\tadditionalInstructions,\n\t  );\n\t  return `You are an expert in accessible communication.\\n\\n### USER‑SPECIFIC CUSTOMISATIONS\\n${prefsText}\\n\\n Transform the input into clear, accessible language without losing information. Keep the length similar to the original and avoid hallucinations.\\n\\n\"${chunk}\"`;\n\t},\n\t[inputWordCount, outputLength, prefs, tonePreference, additionalInstructions],\n  );\n\n  const splitTextIntoChunks = (text, maxTokens) => {\n\tconst words = text.split(\" \");\n\tlet chunks = [];\n\tlet currentChunk = [];\n  \n\tfor (let word of words) {\n\t  if (currentChunk.join(\" \").length + word.length < maxTokens) {\n\t\tcurrentChunk.push(word);\n\t  } else {\n\t\tchunks.push(currentChunk.join(\" \"));\n\t\tcurrentChunk = [word];\n\t  }\n\t}\n\tif (currentChunk.length > 0) chunks.push(currentChunk.join(\" \"));\n\treturn chunks;\n  };\n\n\n  const handleSubmit = async () => {\n\n\t// const inputText = document.getElementById('inputText').value;\n\tconst trimmedInput = inputText.trim();\n\tif (!trimmedInput) return;\n\n\t// inputTextSnapshot.current = inputText; \n\tsetIsLoading(true);\n  \n\ttry {\n\t  const chunks = splitTextIntoChunks(trimmedInput, 10000);\n\t  let combinedOutput = \"\";\n  \n\t  for (let chunk of chunks) {\n\t\tconst prompt = generatePrompt(chunk);\n\t\tconst response = await fetch(\"https://textsimplification12-a0a8gqfbhnhxbgbv.westus-01.azurewebsites.net/api/gpt4\", {\n\t\t  method: \"POST\",\n\t\t  headers: { \"Content-Type\": \"application/json\" },\n\t\t  body: JSON.stringify({ prompt }),\n\t\t});\n\t\t\n\t\tif (!response.ok) {\n\t\t\tconsole.error(`API request failed with status: ${response.status}`);\n\t\t\tcontinue; // Skip this chunk if the API request failed\n\t\t  }\n\n\t\tconst data = await response.json();\n\t\tconsole.log(\"Full API Response: \", data);\n\n\n\t\tconst data1 = data?.response?.replace(/^\"|\"$/g, \"\") || \"No response received.\"; // Append results\n\t\tcombinedOutput += data1 + \" \";\n\t}\n\t  console.log(\"Final Combined Output: \", combinedOutput);\n\n\tconsole.log(\"Data: \", combinedOutput);\n\n\tconst cleanedResponse = combinedOutput.trim();\n\tsetOutputText(cleanedResponse);\n\tsetIsSubmitted(true);\n\n\tawait saveInitialSimplification(trimmedInput, cleanedResponse);\n\tnavigate(\"/review\", { state: { inputText: trimmedInput, outputText: cleanedResponse } });\n\t// navigate(\"/review\", { state: { inputText: trimmedInput, outputText: cleanedResponse } });\n\t\n\t} catch (error) {\n\t  console.error(\"Error fetching GPT-4o response:\", error);\n\t  setOutputText(\"An error occurred while simplifying the text.\");\n\t}\n  \n\tsetIsLoading(false);\n  };\n\n    return (\n\t  <>\n\t\t<nav className={styles.navbar}>\n\t\t  <h1\n\t\t\tonClick={() => (window.location.href = \"https://textsimplification12-a0a8gqfbhnhxbgbv.westus-01.azurewebsites.net/\")}\n\t\t\tstyle={{ cursor: \"pointer\" }}\n\t\t  >\n\t\t\tText Simplification Tool\n\t\t  </h1>\n\t\t  <button className={styles.white_btn} onClick={handleLogout}>\n\t\t\tLogout\n\t\t  </button>\n\t\t</nav>\n\t\t<div className={styles.container}>\n\t\t  {/* Sidebar for document history */}\n\t\t  <div className={`${styles.sidebar} ${isSidebarVisible ? styles.expanded : \"\"}`}>\n\t\t\t<button\n\t\t\t  className={styles.historyIcon}\n\t\t\t  onClick={() => setIsSidebarVisible(!isSidebarVisible)}\n\t\t\t>\n\t\t\t  🕒 <p style={{ fontSize: \"15px\" }}>History</p>\n\t\t\t</button>\n\t\t\t{isSidebarVisible && (\n\t\t\t  <div className={styles.historyContent}>\n\t\t\t\t<button className={styles.closeButton} onClick={() => setIsSidebarVisible(false)}>\n\t\t\t\t  ✖\n\t\t\t\t</button>\n\t\t\t\t<ul className={styles.historyList}>\n\t\t\t\t  {documents.map((doc, index) => (\n\t\t\t\t\t<li\n\t\t\t\t\t  key={doc._id}\n\t\t\t\t\t  onClick={() => handleDocumentClick(doc)}\n\t\t\t\t\t  className={`${styles.historyItem} ${selectedDocument?._id === doc._id ? styles.activeDoc : \"\"}`}\n\t\t\t\t\t>\n\t\t\t\t\t  <strong>Document {documents.length - index}</strong>(\n\t\t\t\t\t  {doc.inputText.substring(0, 20)}...)\n\t\t\t\t\t</li>\n\t\t\t\t  ))}\n\t\t\t\t</ul>\n\t\t\t  </div>\n\t\t\t)}\n\t\t  </div>\n\t\t  {/* Main content area */}\n\t\t  <div className={`${styles.mainContent} ${isSidebarVisible ? styles.withSidebar : \"\"}`}>\n\t\t\t<div className={styles.description}>\n\t\t\t  <p>\n\t\t\t\tThis tool helps make complex text easier to read while preserving its original meaning.\n\t\t\t\tEnter text manually or upload a PDF to get started. You can customise the simplification\n\t\t\t\tguidelines below.\n\t\t\t  </p>\n\t\t\t</div>\n\t\t\t{/* Customisation panel */}\n\t\t\t<section className={styles.customPanel}>\n\t\t\t  <button className={styles.customToggle} onClick={() => setShowCustom((s) => !s)}>\n\t\t\t\t{showCustom ? \"▲ Hide Customisation Options\" : \"▼ Show Customisation Options\"}\n\t\t\t  </button>\n\t\t\t  {showCustom && (\n\t\t\t\t<div className={styles.customBody}>\n\t\t\t\t  {/* Output length slider */}\n\t\t\t\t  <h3>Output Length</h3>\n\t\t\t\t  <input\n\t\t\t\t\ttype=\"range\"\n\t\t\t\t\tmin=\"0\"\n\t\t\t\t\tmax={lengthOptions.length - 1}\n\t\t\t\t\tvalue={lengthOptions.indexOf(outputLength)}\n\t\t\t\t\tonChange={(e) => setOutputLength(lengthOptions[e.target.value])}\n\t\t\t\t\tclassName={styles.sliderInput}\n\t\t\t\t  />\n\t\t\t\t  <div className={styles.sliderLabels}>\n\t\t\t\t\t{/* Ensure the order matches the slider positions */}\n\t\t\t\t\t<span>Very simple</span>\n\t\t\t\t\t<span>Much shorter</span>\n\t\t\t\t\t<span>Shorter</span>\n\t\t\t\t\t<span>Same</span>\n\t\t\t\t  </div>\n\t\t\t\t  {/* Structure & Formatting */}\n\t\t\t\t  <h3>Structure & Formatting</h3>\n\t\t\t\t  {[\n\t\t\t\t\t{ key: \"sectionHeadings\", label: \"Section headings\" },\n\t\t\t\t\t{ key: \"bulletLists\", label: \"Bullet/numbered lists\" },\n\t\t\t\t\t{ key: \"shortParagraphs\", label: \"Short paragraphs\" },\n\t\t\t\t  ].map((opt) => (\n\t\t\t\t\t<label key={opt.key} className={styles.structureOption}>\n\t\t\t\t\t  <input\n\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\tchecked={prefs[opt.key]}\n\t\t\t\t\t\tonChange={() => togglePref(opt.key)}\n\t\t\t\t\t  />\n\t\t\t\t\t  <span>{opt.label}</span>\n\t\t\t\t\t</label>\n\t\t\t\t  ))}\n\t\t\t\t  {/* Sentence Style */}\n\t\t\t\t  <h3>Sentence Style</h3>\n\t\t\t\t  {[\n\t\t\t\t\t{ key: \"breakLongSentences\", label: \"Break long sentences\" },\n\t\t\t\t\t{ key: \"activeVoice\", label: \"Active voice\" },\n\t\t\t\t\t{ key: \"simplifyClauses\", label: \"Simplify nested clauses\" },\n\t\t\t\t  ].map((opt) => (\n\t\t\t\t\t<label key={opt.key} className={styles.structureOption}>\n\t\t\t\t\t  <input\n\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\tchecked={prefs[opt.key]}\n\t\t\t\t\t\tonChange={() => togglePref(opt.key)}\n\t\t\t\t\t  />\n\t\t\t\t\t  <span>{opt.label}</span>\n\t\t\t\t\t</label>\n\t\t\t\t  ))}\n\t\t\t\t  {/* Vocabulary & Clarity */}\n\t\t\t\t  <h3>Vocabulary & Clarity</h3>\n\t\t\t\t  {[\n\t\t\t\t\t{ key: \"useSimpleLanguage\", label: \"Use everyday language\" },\n\t\t\t\t\t{ key: \"defineTerms\", label: \"Define complex terms\" },\n\t\t\t\t\t{ key: \"expandAcronyms\", label: \"Expand acronyms\" },\n\t\t\t\t\t{ key: \"avoidJargon\", label: \"Avoid jargon & idioms\" },\n\t\t\t\t  ].map((opt) => (\n\t\t\t\t\t<label key={opt.key} className={styles.structureOption}>\n\t\t\t\t\t  <input\n\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\tchecked={prefs[opt.key]}\n\t\t\t\t\t\tonChange={() => togglePref(opt.key)}\n\t\t\t\t\t  />\n\t\t\t\t\t  <span>{opt.label}</span>\n\t\t\t\t\t</label>\n\t\t\t\t  ))}\n\t\t\t\t  {/* Tone preferences */}\n\t\t\t\t  <h3>Tone Preference</h3>\n\t\t\t\t  <div className={styles.toneOptions}>\n\t\t\t\t\t{[\n\t\t\t\t\t  { value: \"neutral\", label: \"Neutral (default)\" },\n\t\t\t\t\t  { value: \"formal\", label: \"Professional/Formal\" },\n\t\t\t\t\t  { value: \"academic\", label: \"Academic/Instructional\" },\n\t\t\t\t\t  { value: \"casual\", label: \"Casual/Conversational\" },\n\t\t\t\t\t  { value: \"creative\", label: \"Creative/Enthusiastic\" },\n\t\t\t\t\t].map((tone) => (\n\t\t\t\t\t  <label key={tone.value} className={styles.toneOption}>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t  type=\"radio\"\n\t\t\t\t\t\t  name=\"tonePreference\"\n\t\t\t\t\t\t  value={tone.value}\n\t\t\t\t\t\t  checked={tonePreference === tone.value}\n\t\t\t\t\t\t  onChange={(e) => setTonePreference(e.target.value)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<span>{tone.label}</span>\n\t\t\t\t\t  </label>\n\t\t\t\t\t))}\n\t\t\t\t  </div>\n\t\t\t\t  {/* Additional instructions */}\n\t\t\t\t  <h3>Additional Instructions</h3>\n\t\t\t\t  <textarea\n\t\t\t\t\tclassName={styles.textarea}\n\t\t\t\t\tplaceholder=\"Enter any additional instructions or context here...\"\n\t\t\t\t\tvalue={additionalInstructions}\n\t\t\t\t\tonChange={(e) => setAdditionalInstructions(e.target.value)}\n\t\t\t\t\trows={3}\n\t\t\t\t  ></textarea>\n\t\t\t\t</div>\n\t\t\t  )}\n\t\t\t</section>\n\t\t\t{/* Input area and upload */}\n\t\t\t<div className={styles.form_container}>\n\t\t\t  <div className={styles.input_area}>\n\t\t\t\t<div className={styles.text_container}>\n\t\t\t\t  <label className={styles.label} htmlFor=\"inputText\">\n\t\t\t\t\tInput Text\n\t\t\t\t  </label>\n\t\t\t\t  <textarea\n\t\t\t\t\tid=\"inputText\"\n\t\t\t\t\tclassName={`${styles.textarea} ${isLoading ? styles.disabled : \"\"}`}\n\t\t\t\t\tplaceholder=\"Write/Paste your text here or upload a PDF document to extract content automatically.\"\n\t\t\t\t\tvalue={inputText}\n\t\t\t\t\tonChange={(e) => setInputText(e.target.value)}\n\t\t\t\t\tdisabled={isLoading}\n\t\t\t\t  ></textarea>\n\t\t\t\t  <p className={styles.countText}>\n\t\t\t\t\tWords: {inputWordCount} | Characters: {inputCharCount}\n\t\t\t\t\t{pdfPageCount > 0 && ` | Pages: ${pdfPageCount}`}\n\t\t\t\t  </p>\n\t\t\t\t</div>\n\t\t\t\t<div className={styles.or_divider}>OR</div>\n\t\t\t\t<div\n\t\t\t\t  className={`${styles.upload_area} ${isLoading ? styles.disabled : \"\"}`}\n\t\t\t\t  onDragOver={(e) => e.preventDefault()}\n\t\t\t\t  onDrop={(e) => {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tconst file = e.dataTransfer.files[0];\n\t\t\t\t\tif (file) handleFileUpload({ target: { files: [file] } });\n\t\t\t\t  }}\n\t\t\t\t>\n\t\t\t\t  <label htmlFor=\"fileUpload\" className={styles.upload_box}>\n\t\t\t\t\t{isUploading ? (\n\t\t\t\t\t  <span className={styles.loadingText}>Extracting text, please wait...</span>\n\t\t\t\t\t) : uploadedFileName ? (\n\t\t\t\t\t  <>\n\t\t\t\t\t\tFile uploaded: <strong>{uploadedFileName}</strong>\n\t\t\t\t\t  </>\n\t\t\t\t\t) : (\n\t\t\t\t\t  <>\n\t\t\t\t\t\tClick to Upload a PDF\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<span>...or drag and drop a file.</span>\n\t\t\t\t\t  </>\n\t\t\t\t\t)}\n\t\t\t\t  </label>\n\t\t\t\t  <input\n\t\t\t\t\ttype=\"file\"\n\t\t\t\t\tid=\"fileUpload\"\n\t\t\t\t\taccept=\"application/pdf\"\n\t\t\t\t\tonChange={handleFileUpload}\n\t\t\t\t\tclassName={styles.hidden_input}\n\t\t\t\t\tdisabled={isUploading || isLoading}\n\t\t\t\t  />\n\t\t\t\t</div>\n\t\t\t  </div>\n\t\t\t</div>\n\t\t\t<button\n\t\t\t  className={styles.submit_btn}\n\t\t\t  onClick={handleSubmit}\n\t\t\t  disabled={!inputText.trim() || isLoading || isUploading}\n\t\t\t  id=\"simplifyBtn\"\n\t\t\t>\n\t\t\t  {isLoading ? \"Processing...\" : \"Simplify Text\"}\n\t\t\t</button>\n\t\t\t<p className={styles.help_text}>\n\t\t\t  Need Help? <a href=\"mailto:anukumar@uw.edu\">Contact Support</a>\n\t\t\t</p>\n\t\t\t<Footer />\n\t\t  </div>\n\t\t</div>\n\t  </>\n\t);\n\n\t\t};\n\n\t\texport default Main;\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAGA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAEA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAGA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AAIA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAGA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAEA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAGA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AAIA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}