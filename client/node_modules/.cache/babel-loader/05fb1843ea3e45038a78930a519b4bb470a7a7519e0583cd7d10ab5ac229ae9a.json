{"ast":null,"code":"import React,{useState,useEffect,useRef}from\"react\";import{useLocation,useNavigate}from\"react-router-dom\";import DiffMatchPatch from\"diff-match-patch\";import{FaRegCopy,FaDownload}from\"react-icons/fa\";// Import FontAwesome icons\nimport{saveAs}from\"file-saver\";import styles from\"./styles.module.css\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Review=()=>{const{state}=useLocation();const{inputText,outputText:initialOutputText,editHistory:restoredEditHistory}=state||{inputText:\"\",outputText:\"\",editHistory:[]};const[outputText,setOutputText]=useState(initialOutputText);const[editHistory,setEditHistory]=useState(restoredEditHistory||[]);const[diffHtml,setDiffHtml]=useState(\"\");const[isSaveButtonEnabled,setIsSaveButtonEnabled]=useState(false);const navigate=useNavigate();const[isEditable,setIsEditable]=useState(false);const[isSidebarVisible,setIsSidebarVisible]=useState(false);const[showDifference,setShowDifference]=useState(false);const[inputWordCount,setInputWordCount]=useState(0);const[inputCharCount,setInputCharCount]=useState(0);const[outputWordCount,setOutputWordCount]=useState(0);const[outputCharCount,setOutputCharCount]=useState(0);//   const navigate = useNavigate();\nconst[isHistoryVisible,setIsHistoryVisible]=useState(false);// Show/Hide history sidebar\nconst contentEditableRef=useRef(null);// Reference to the contentEditable div\nconst[isLoading,setIsLoading]=useState(false);const[isSaveButtonVisible,setIsSaveButtonVisible]=useState(true);const[showSurveyPrompt,setShowSurveyPrompt]=useState(false);// State for survey prompt\nconst handleLogout=()=>{localStorage.removeItem(\"token\");navigate(\"/Login\");localStorage.removeItem(\"reviewPageState\");// Clear the saved state\n// window.location.reload();\n};const countWordsAndChars=text=>{const words=text.trim().split(/\\s+/).filter(Boolean).length;const chars=text.length;return{words,chars};};// Function to format the prompt with user input\nconst generatePrompt=inputText=>{return`\n    You are an expert in accessible communication, tasked with simplifying a given text for individuals with intellectual and developmental disabilities (IDD). \n    \n    Please do not summarize or reduce the length of output content. Instead, simplify the text preserving the intended meaning or information. The output length should be similar to the input length.\n    \n    Follow these detailed guidelines to ensure the text is clear, easy to understand, and accessible:\n    \n    1. Sentence and Structure Simplification\n    - Use short sentences (8-10 words max).\n    - Keep one main idea per sentence to avoid confusion.\n    - Write in active voice (e.g., \"A doctor gives medicine\" instead of \"Medicine is given by a doctor\").\n    - Avoid bulleted lists. Instead, write short, direct sentences in paragraph form.\n    - Repeat important words instead of using synonyms to improve comprehension.\n    - Start a new paragraph when introducing a different idea.\n    \n    2. Word Choice and Vocabulary\n    - Replace complex words with simple, common words (words most people know and use every day).\n    - Use words with few syllables (e.g., \"help\" instead of \"assist\").\n    - Avoid figurative language (no metaphors, similes, or idioms).\n      - ❌ \"It’s a piece of cake.\"  \n      - ✅ \"It is easy to do.\"  \n    - If a difficult word is necessary, provide a simple definition within the text.\n    - Avoid negatives when possible (e.g., instead of \"Do not touch,\" say \"Keep hands away\").\n    \n    3. Text Organization\n    If necessary,\n    - Use headings that are short and direct (max 8 words). Example:\n      - ❌ \"Understanding the Difference Between the Flu and COVID-19\"  \n      - ✅ \"Flu vs. COVID-19\"  \n    - Keep paragraphs short.\n    \n    4. Formatting for Readability\n    - Use left-aligned text with wide spacing between lines.\n    - Ensure the text is high contrast (black text on a white background).\n    - Avoid italics, underlining, or all caps, as they can be hard to read.\n    \n    5. Instructions and Steps\n    - If the text includes instructions, keep steps short and clear.\n    - Example:\n      - ❌ \"First, you will need to open the box carefully and remove the contents before proceeding to step two, which involves assembling the parts.\"  \n      - ✅ \"Step 1: Open the box.  \n       Step 2: Take out the parts.\"  \n    \n    6. Retaining Meaning and Key Details\n    - Do not remove important information, but explain it in a simpler way.\n    - Ensure the simplified version does not change the facts.\n    - The output should remain accurate, informative, and accessible.\n  \n    7. Do not simplify unnecessarily and the output should contain only the simplified text, nothing else.\n    \n    Now, simplify the following text line-by-line according to these guidelines:\n    \"${inputText}\"\n    `;};const splitTextIntoChunks=(text,maxTokens)=>{const words=text.split(\" \");let chunks=[];let currentChunk=[];for(let word of words){if(currentChunk.join(\" \").length+word.length<maxTokens){currentChunk.push(word);}else{chunks.push(currentChunk.join(\" \"));currentChunk=[word];}}if(currentChunk.length>0)chunks.push(currentChunk.join(\" \"));return chunks;};const saveSimplification=async()=>{try{const user=JSON.parse(localStorage.getItem(\"user\"));if(!user)return;const response=await fetch(\"https://textsimplification-eecqhvdcduczf8cz.westus-01.azurewebsites.net/api/simplifications\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({userId:user._id,inputText,outputText})});if(response.ok){console.log(\"Simplification saved successfully.\");}else{const error=await response.json();console.error(\"Error saving simplification:\",error.message);}}catch(error){console.error(\"Error saving simplification:\",error);}};const handleResimplify=async()=>{if(!inputText.trim())return;setIsLoading(true);// Show loading state\ntry{const chunks=splitTextIntoChunks(inputText,30000);let combinedOutput=\"\";for(let chunk of chunks){var _data$response;const prompt=generatePrompt(chunk);const response=await fetch(\"https://textsimplification-eecqhvdcduczf8cz.westus-01.azurewebsites.net/api/gpt4\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({prompt})});if(!response.ok){console.error(\"Error with API request:\",response.status);return;}const data=await response.json();console.log(\"Full API Response: \",data);const newOutput=(data===null||data===void 0?void 0:(_data$response=data.response)===null||_data$response===void 0?void 0:_data$response.replace(/^\"|\"$/g,\"\"))||\"No response received.\";// Update System-generated Text\ncombinedOutput+=newOutput+\" \";console.log(\"Final Combined Output: \",combinedOutput);}setOutputText(combinedOutput);}catch(error){console.error(\"Error fetching GPT-4o response:\",error);setOutputText(\"An error occurred while simplifying the text.\");}setIsLoading(false);};//\nconst saveEditToHistory=async editedText=>{try{const user=JSON.parse(localStorage.getItem(\"user\"));if(!user)return;const response=await fetch(\"https://textsimplification-eecqhvdcduczf8cz.westus-01.azurewebsites.net/api/simplifications/edit\",{method:\"PUT\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({email:user.email,inputText,editedText})});if(response.ok){console.log(\"Edit saved to history.\");}else{const error=await response.json();console.error(\"Error saving edit to history:\",error.message);}}catch(error){console.error(\"Error saving edit to history:\",error);}};const saveFinalOutput=async()=>{setIsLoading(true);try{const user=JSON.parse(localStorage.getItem(\"user\"));if(!user)return;const response=await fetch(\"https://textsimplification-eecqhvdcduczf8cz.westus-01.azurewebsites.net/api/simplifications/save\",{method:\"PUT\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({email:user.email,inputText,finalText:outputText})});const timestamp=new Date().toISOString();setEditHistory(prev=>[...prev,{timestamp,text:outputText}]);if(response.ok){console.log(\"Final output saved successfully.\");setIsSaveButtonEnabled(false);// Disable save button\nsetShowSurveyPrompt(true);// Ensure survey prompt is displayed\n}else{const error=await response.json();console.error(\"Error saving final output:\",error.message);}}catch(error){console.error(\"Error saving final output:\",error);}finally{setIsLoading(false);}};const handleEditChange=event=>{const updatedText=event.target.value;setOutputText(updatedText);setIsSaveButtonEnabled(true);// Enable save button on edit\n// const timestamp = new Date().toISOString();\n// setEditHistory((prev) => [\n//   ...prev,\n//   { timestamp, text: updatedText },\n// ]);\n// Save the change to edit history in MongoDB\nsaveEditToHistory(updatedText);};const handleCopy=text=>{navigator.clipboard.writeText(text).then(()=>{alert(\"Copied to clipboard!\");},err=>{console.error(\"Failed to copy text:\",err);});};const handleDownload=(text,filename,format)=>{const blob=new Blob([text],{type:\"text/plain;charset=utf-8\"});saveAs(blob,`${filename}.${format}`);};useEffect(()=>{const reviewPageState={inputText,outputText,editHistory};localStorage.setItem(\"reviewPageState\",JSON.stringify(reviewPageState));},[outputText,editHistory,inputText]);useEffect(()=>{const savedState=JSON.parse(localStorage.getItem(\"reviewPageState\"));if(savedState){setOutputText(savedState.outputText||\"\");setEditHistory(savedState.editHistory||[]);}else{setOutputText(initialOutputText);setEditHistory(restoredEditHistory||[]);}saveSimplification();// Save the initial inputText and outputText\nsetIsSaveButtonEnabled(true);},[initialOutputText,restoredEditHistory]);// useEffect(() => {\n//   // Save initial input and output text in MongoDB\n//   saveSimplification();\n// }, []);\nuseEffect(()=>{const diffResult=generateDiff(inputText,outputText);setDiffHtml(diffResult);// saveSimplification();\n},[inputText,outputText]);useEffect(()=>{saveSimplification();// Save the initial inputText and outputText\nsetIsSaveButtonEnabled(true);const savedState=JSON.parse(localStorage.getItem(\"reviewPageState\"));if(savedState){setOutputText(savedState.outputText||\"\");setEditHistory(savedState.editHistory||[]);}},[]);useEffect(()=>{const{words:inputWords,chars:inputChars}=countWordsAndChars(inputText);const{words:outputWords,chars:outputChars}=countWordsAndChars(outputText);setInputWordCount(inputWords);setInputCharCount(inputChars);setOutputWordCount(outputWords);setOutputCharCount(outputChars);},[inputText,outputText]);const handleHistoryClick=edit=>{setOutputText(edit.text);const diffResult=generateDiff(inputText,edit.text);setDiffHtml(diffResult);setIsEditable(false);};// Function to calculate and render diff\nconst generateDiff=(input,output)=>{const dmp=new DiffMatchPatch();const diffs=dmp.diff_main(input,output);dmp.diff_cleanupSemantic(diffs);// Optional cleanup for better readability\nreturn dmp.diff_prettyHtml(diffs);};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"nav\",{className:styles.navbar,children:[/*#__PURE__*/_jsx(\"h1\",{onClick:()=>window.location.href=\"https://textsimplification-eecqhvdcduczf8cz.westus-01.azurewebsites.net/\",style:{cursor:\"pointer\"}// Makes it look clickable\n,children:\"Text Simplification Tool\"}),/*#__PURE__*/_jsx(\"button\",{className:styles.white_btn,onClick:handleLogout,children:\"Logout\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.container,children:[/*#__PURE__*/_jsxs(\"div\",{className:`${styles.sidebar} ${isSidebarVisible?styles.expanded:\"\"}`,children:[/*#__PURE__*/_jsxs(\"button\",{className:styles.historyIcon,onClick:()=>setIsSidebarVisible(!isSidebarVisible),children:[\"\\uD83D\\uDD52   \",/*#__PURE__*/_jsx(\"p\",{style:{fontSize:\"15px\"},children:\" History \"}),\" \"]}),isSidebarVisible&&/*#__PURE__*/_jsxs(\"div\",{className:styles.historyContent,children:[/*#__PURE__*/_jsx(\"button\",{className:styles.closeButton,onClick:()=>setIsSidebarVisible(false),children:\"\\u2716\"}),/*#__PURE__*/_jsx(\"ul\",{className:styles.historyList,children:editHistory.map((edit,index)=>/*#__PURE__*/_jsx(\"li\",{className:styles.historyItem,onClick:()=>handleHistoryClick(edit),children:edit.timestamp},index))})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:`${styles.mainContent} ${isSidebarVisible?styles.withSidebar:\"\"}`,children:[/*#__PURE__*/_jsx(\"div\",{className:styles.description,children:/*#__PURE__*/_jsx(\"p\",{children:\"Please review the simplified text carefully and make any edits as needed to suit your requirements. Once you are satisfied with your revisions, submit the final version and complete the short survey to provide your feedback.\"})}),/*#__PURE__*/_jsxs(\"div\",{className:styles.textareas_container,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.text_container,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.labelWrapper,children:[/*#__PURE__*/_jsx(\"label\",{className:styles.label,htmlFor:\"inputText\",children:\"Input Text\"}),/*#__PURE__*/_jsxs(\"div\",{className:styles.actions,children:[/*#__PURE__*/_jsx(\"div\",{className:styles.copyIcon,onClick:()=>handleCopy(inputText),title:\"Copy to Clipboard\",children:\"\\uD83D\\uDCCB \"}),/*#__PURE__*/_jsx(\"div\",{className:styles.copyIcon,onClick:()=>handleDownload(inputText,\"InputText\",\"txt\"),title:\"Download as .txt file\",children:\"\\uD83D\\uDCE5 \"}),/*#__PURE__*/_jsx(\"div\",{className:styles.copyIcon,onClick:handleResimplify,title:\"Re-simplify Text\",style:{cursor:\"pointer\"},children:\"\\uD83D\\uDD04 \"})]})]}),/*#__PURE__*/_jsxs(\"p\",{className:styles.countText,children:[\"Words: \",inputWordCount,\" | Characters: \",inputCharCount]}),/*#__PURE__*/_jsx(\"textarea\",{id:\"inputText\",className:`${styles.textarea} ${styles.side_by_side}`,value:inputText,readOnly:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.text_container,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.labelWrapper,children:[/*#__PURE__*/_jsx(\"label\",{className:styles.label,htmlFor:\"outputText\",children:\"System-generated Text\"}),/*#__PURE__*/_jsxs(\"div\",{className:styles.actions,children:[/*#__PURE__*/_jsx(\"div\",{className:styles.copyIcon,onClick:()=>handleCopy(outputText),title:\"Copy to Clipboard\",children:\"\\uD83D\\uDCCB \"}),/*#__PURE__*/_jsx(\"div\",{className:styles.copyIcon,onClick:()=>handleDownload(outputText,\"GeneratedText\",\"txt\"),title:\"Download as .txt file\",children:\"\\uD83D\\uDCE5 \"}),/*#__PURE__*/_jsx(\"button\",{className:styles.toggleDiffBtn,onClick:()=>setShowDifference(!showDifference),children:showDifference?\"Hide Difference with input text\":\"Show Difference with input text\"})]})]}),/*#__PURE__*/_jsxs(\"p\",{className:styles.countText,children:[\"Words: \",outputWordCount,\" | Characters: \",outputCharCount]}),/*#__PURE__*/_jsx(\"textarea\",{id:\"outputText\",className:`${styles.output_box} ${styles.side_by_side}`,value:outputText,onChange:handleEditChange,readOnly:isEditable,placeholder:\"Output\"})]}),showDifference&&/*#__PURE__*/_jsxs(\"div\",{className:styles.text_container,children:[/*#__PURE__*/_jsx(\"div\",{className:styles.labelWrapper,children:/*#__PURE__*/_jsx(\"label\",{className:styles.label,htmlFor:\"outputText\",children:\"Difference from input text\"})}),/*#__PURE__*/_jsx(\"div\",{id:\"diffText\",className:`${styles.output_box} ${styles.side_by_side}`,dangerouslySetInnerHTML:{__html:diffHtml}})]})]}),/*#__PURE__*/_jsx(\"div\",{className:styles.button_container,children:/*#__PURE__*/_jsx(\"button\",{className:styles.submit_btn,onClick:saveFinalOutput,disabled:!isSaveButtonEnabled||isLoading,title:!isSaveButtonEnabled?\"Please make an edit before submitting.\":\"\",children:\"Submit\"})}),/*#__PURE__*/_jsxs(\"p\",{className:styles.help_text,children:[\"Need Help? \",/*#__PURE__*/_jsx(\"a\",{href:\"mailto:anukumar@uw.edu\",children:\"Contact Support\"})]}),showSurveyPrompt&&/*#__PURE__*/_jsx(\"div\",{className:styles.survey_prompt,children:/*#__PURE__*/_jsxs(\"p\",{className:styles.survey_text,children:[\"Please take the survey to help us improve.\",/*#__PURE__*/_jsx(\"button\",{className:styles.survey_btn,onClick:()=>{const reviewPageState={inputText,outputText,editHistory};localStorage.setItem(\"reviewPageState\",JSON.stringify(reviewPageState));navigate(\"/survey\",{state:{email:JSON.parse(localStorage.getItem(\"user\")).email,inputText,outputText,editHistory}});},children:\"\\uD83D\\uDCD1 Take the Survey\"})]})})]})]})]});};export default Review;// import React, { useState, useEffect, useRef } from \"react\";\n// import { useLocation, useNavigate } from \"react-router-dom\";\n// import DiffMatchPatch from \"diff-match-patch\";\n// import { FaRegCopy, FaDownload } from \"react-icons/fa\"; // Import FontAwesome copy icon\n// import { FaCopy } from \"react-icons/fa\";\n// import { saveAs } from \"file-saver\";\n// import styles from \"./styles.module.css\";\n// const Review = () => {\n//   const { state } = useLocation();\n//   const { inputText, outputText: initialOutputText } = state || {\n//     inputText: \"\",\n//     outputText: \"\",\n//   };\n//   const [outputText, setOutputText] = useState(initialOutputText);\n//   const [diffHtml, setDiffHtml] = useState(\"\");\n//   const [isEditable, setIsEditable] = useState(false);\n//   const [editHistory, setEditHistory] = useState([]);\n//   const [isSidebarVisible, setIsSidebarVisible] = useState(false);\n//   const [showDifference, setShowDifference] = useState(false);\n//   const navigate = useNavigate();\n//   const [isHistoryVisible, setIsHistoryVisible] = useState(false); // Show/Hide history sidebar\n//   const contentEditableRef = useRef(null); // Reference to the contentEditable div\n// \tconst [isLoading, setIsLoading] = useState(false);\n// \tconst [isSaveButtonVisible, setIsSaveButtonVisible] = useState(true);\n// \tconst [showSurveyPrompt, setShowSurveyPrompt] = useState(false); // State for survey prompt\n//   // Function to calculate and render diff\n//   const generateDiff = (input, output) => {\n//     const dmp = new DiffMatchPatch();\n//     const diffs = dmp.diff_main(input, output);\n//     dmp.diff_cleanupSemantic(diffs); // Optional cleanup for better readability\n//     return dmp.diff_prettyHtml(diffs);\n//   };\n//   const handleLogout = () => {\n//     localStorage.removeItem(\"token\");\n// \tnavigate(\"/Login\"); \n//    // window.location.reload();\n//   };\n//    // Function to save the original input and output text to MongoDB\n//    const saveSimplification = async () => {\n//     try {\n//       const user = JSON.parse(localStorage.getItem(\"user\"));\n//       const response = await fetch(\"https://textsimplification-eecqhvdcduczf8cz.westus-01.azurewebsites.net/api/simplifications\", {\n//         method: \"POST\",\n//         headers: { \"Content-Type\": \"application/json\" },\n//         body: JSON.stringify({\n//           userId: user._id,\n//           inputText,\n//           outputText,\n//         }),\n//       });\n//       if (response.ok) {\n//         console.log(\"Simplification saved successfully.\");\n//       } else {\n//         const data = await response.json();\n//         console.error(\"Error saving simplification:\", data.message);\n//       }\n//     } catch (error) {\n//       console.error(\"Error saving simplification:\", error);\n//     }\n//   };\n//   // Function to save an edit to MongoDB\n//   const saveEdit = async (editedText) => {\n//     try {\n//       const user = JSON.parse(localStorage.getItem(\"user\"));\n//       const response = await fetch(\"https://textsimplification-eecqhvdcduczf8cz.westus-01.azurewebsites.net/api/simplifications/edit\", {\n//         method: \"PUT\",\n//         headers: { \"Content-Type\": \"application/json\" },\n//         body: JSON.stringify({\n//           email: user.email,\n//           inputText,\n//           editedText,\n//         }),\n//       });\n//       if (response.ok) {\n//         console.log(\"Edit saved successfully.\");\n//       } else {\n//         const data = await response.json();\n//         console.error(\"Error saving edit:\", data.message);\n//       }\n//     } catch (error) {\n//       console.error(\"Error saving edit:\", error);\n//     }\n//   };\n//   // Effect to calculate diff whenever text changes\n//   // useEffect(() => {\n//   //   const diffResult = generateDiff(inputText, outputText);\n//   //   setDiffHtml(diffResult);\n//   // }, [inputText, outputText]);\n//     // Effect to calculate diff and save the initial data\n//     useEffect(() => {\n//       const diffResult = generateDiff(inputText, outputText);\n//       setDiffHtml(diffResult);\n//       // Save the original input and output text to MongoDB\n//       saveSimplification();\n//     }, [inputText, outputText]);\n//   const handleCopy = (text) => {\n// \tnavigator.clipboard.writeText(text).then(\n// \t  () => {\n// \t\talert(\"Copied to clipboard!\");\n// \t  },\n// \t  (err) => {\n// \t\tconsole.error(\"Failed to copy text: \", err);\n// \t  }\n// \t);\n//   };\n//   // Function to handle download\n//   const handleDownload = (text, filename, format) => {\n//     const blob = new Blob([text], { type: \"text/plain;charset=utf-8\" });\n//     const link = document.createElement(\"a\");\n//     link.href = URL.createObjectURL(blob);\n//     link.download = `${filename}.${format}`;\n//     link.click();\n//   };\n// //   const handleEdit = () => {\n// //     setIsEditable(true);\n// //   };\n// //   const handleSave = () => {\n// //     // Save the current state to history\n// //     setEditHistory((prev) => [\n// //       ...prev,\n// //       { timestamp: new Date().toLocaleString(), text: outputText },\n// //     ]);\n// //     alert(\"Saved successfully!\");\n// //     setIsEditable(false);\n// //   };\n// const handleSave = async () => {\n//   const editedText = outputText;\n//   // Save the edit to MongoDB\n//   await saveEdit(editedText);\n//   // Update the edit history\n//   setEditHistory((prev) => [\n//     ...prev,\n//     { timestamp: new Date().toLocaleString(), text: editedText },\n//   ]);\n//   setIsEditable(false);\n//   alert(\"Edited text saved successfully.\");\n// };\n// //     const handleSave = async (isAuto = false) => {\n// // //\t\tsetIsSaveButtonVisible(false);\n// // if (isAuto && isAuto.nativeEvent) {\n// // \tisAuto = false; // Default behavior if called by an event\n// // }\n// // \t\ttry {\n// // \t\t  const user = JSON.parse(localStorage.getItem(\"user\")); // Retrieve user info\n// // \t\t  if (!user) {\n// // \t\t\talert(\"User not logged in!\");\n// // \t\t\treturn;\n// // \t\t  }\n// // \t\t  const payload = {\n// // \t\t\tuserId: user._id,\n// // \t\t\temail: user.email,\n// // \t\t\tinputText,\n// // \t\t\t...(isEditable ? { editedText: outputText } : { outputText, editableText: outputText }),\n// // \t\t  };\n// // \t\t  const endpoint = isEditable\n// // \t\t\t? \"https://textsimplification-eecqhvdcduczf8cz.westus-01.azurewebsites.net/api/simplifications/edit\" // Endpoint for updating\n// // \t\t\t: \"https://textsimplification-eecqhvdcduczf8cz.westus-01.azurewebsites.net/api/simplifications\"; // Endpoint for initial save\n// // \t\t  const method = isEditable ? \"PUT\" : \"POST\"; // Use PUT for updates, POST for saves\n// // \t\t  const response = await fetch(endpoint, {\n// // \t\t\tmethod,\n// // \t\t\theaders: { \"Content-Type\": \"application/json\" },\n// // \t\t\tbody: JSON.stringify(payload),\n// // \t\t  });\n// // \t\t  if (response.ok) {\n// // \t\t\tconst data = await response.json();\n// // \t\t\talert(isEditable ? \"Edited text saved successfully!\" : \"Simplification saved successfully!\");\n// // \t\t\t//setShowSurveyPrompt(true); \n// // \t\t\tconsole.log(\"isSaveButtonVisible\", isSaveButtonVisible);\n// // \t\t\tconsole.log(\"isEditable\", isEditable);\n// // \t\t\tconsole.log(\"isAuto\", isAuto);\n// // \t\t\tif (!isSaveButtonVisible) {  //edit, save, edit\n// // \t\t\t\tsetShowSurveyPrompt(false); // Show the survey prompt\n// // \t\t\t  }\n// // \t\t\telse if (isSaveButtonVisible && !isEditable && isAuto)  //true false -- first time save or edit button clicked\n// // \t\t\t{\n// // \t\t\t\tsetShowSurveyPrompt(false);\n// // \t\t\t}\n// // \t\t\telse if (isSaveButtonVisible && isEditable)\n// // \t\t\t{\n// // \t\t\t\tsetShowSurveyPrompt(true);\n// // \t\t\t} \n// // \t\t\telse if (isSaveButtonVisible && !isEditable && !isAuto)  //true false -- first time save or edit button clicked\n// // \t\t\t{\n// // \t\t\t\tsetShowSurveyPrompt(true);\n// // \t\t\t}\n// // \t\t\tsetEditHistory((prev) => [\n// // \t\t\t\t...prev,\n// // \t\t\t\t{ timestamp: new Date().toLocaleString(), text: outputText },\n// // \t\t\t  ]);\n// // \t\t\tif (isEditable) {\n// // \t\t\t {\n// // \t\t\t\tsetIsEditable(false); // Exit editing mode after saving edits\n// // \t\t\t  // disable saving button\n// // \t\t\t  setIsSaveButtonVisible(false); // Hide the save button\n// // \t\t\t   // Show the survey prompt\n// // \t\t\t // setShowSurveyPrompt(true); \n// // \t\t\t }\n// // \t\t  }} else {\n// // \t\t\tconst error = await response.json();\n// // \t\t\talert(error.message || \"Failed to save simplification.\");\n// // \t\t  }\n// // \t\t} catch (error) {\n// // \t\t  console.error(\"Error saving simplification:\", error);\n// // \t\t  alert(\"An error occurred. Please try again.\");\n// // \t\t}\n// // \t  };\n// const handleEdit = () => {\n//   setIsEditable(true);\n// };\n// \t// const handleEdit = () => {\n// \t//   let isAuto = true;\n// \t//   handleSave(isAuto); // Save the current output text\n// \t//   setIsEditable(true); // Enable editing mode\n// \t//   setIsSaveButtonVisible(true);\n// \t// };\n//   const handleHistoryClick = (edit) => {\n//     setOutputText(edit.text);\n//     const diffResult = generateDiff(inputText, edit.text);\n//     setDiffHtml(diffResult);\n//     setIsEditable(false);\n//   };\n//   return (\n//     <>\n//       <nav className={styles.navbar}>\n//         <h1>Text Simplification Study</h1>\n//         <button className={styles.white_btn} onClick={handleLogout}>\n//           Logout\n//         </button>\n//       </nav>\n//       <div className={styles.container}>\n//         {/* Sidebar */}\n//         <div\n//           className={`${styles.sidebar} ${\n//             isSidebarVisible ? styles.expanded : \"\"\n//           }`}\n//         >\n//           <button\n//             className={styles.historyIcon}\n//             onClick={() => setIsSidebarVisible(!isSidebarVisible)}\n//           >\n//              🕒   <p style={{ fontSize: \"15px\" }}> History </p> {/* History Icon */}\n//           </button>\n//           {isSidebarVisible && (\n//             <div className={styles.historyContent}>\n//               <button\n//                 className={styles.closeButton}\n//                 onClick={() => setIsSidebarVisible(false)}\n//               >\n//                ✖\n//               </button>\n//               {/* <h3>History</h3> */}\n//               <ul className={styles.historyList}>\n//                 {editHistory.map((edit, index) => (\n//                   <li\n//                     key={index}\n//                     className={styles.historyItem}\n//                     onClick={() => handleHistoryClick(edit)}\n//                   >\n//                     {edit.timestamp}\n//                   </li>\n//                 ))}\n//               </ul>\n//             </div>\n//           )}\n//         </div>\n//         {/* Main Content */}\n//         <div\n//           className={`${styles.mainContent} ${\n//             isSidebarVisible ? styles.withSidebar : \"\"\n//           }`}\n//         >\n// \t\t\t<div className={styles.description}>\n// \t\t\t<p>\n// \t\t\t\tReview the generated output and make any necessary edits. Changes\n// \t\t\t\tare highlighted in real-time for easy visualization.\n// \t\t\t</p>\n// \t\t\t</div>\n// \t\t\t<div className={styles.textareas_container}>\n//   {/* Input Text */}\n//   <div className={styles.text_container}>\n//     <div className={styles.labelWrapper}>\n//       <label className={styles.label} htmlFor=\"inputText\">\n//         Input Text\n//       </label>\n//       <div className={styles.actions}>\n//       <div\n//         className={styles.copyIcon}\n//         onClick={() => handleCopy(inputText)}\n//         title=\"Copy to Clipboard\"\n//       >\n//         </div>\n//         📋 {/* Clipboard Emoji */}\n//         <div\n//         className={styles.copyIcon}\n//         onClick={() => handleDownload(inputText, \"InputText\", \"txt\")}\n//         title=\"Download as TXT\"\n//       >\n//         📥 {/* Download Icon */}\n//       </div>\n//       </div>\n//     </div>\n//     <textarea\n//       id=\"inputText\"\n//       className={`${styles.textarea} ${styles.side_by_side}`}\n//       value={inputText}\n//       readOnly\n//     ></textarea>\n//   </div>\n// \t\t\t{/* Output Text Box */}\n// \t\t\t{/* Output Text Box */}\n// <div className={styles.text_container}>\n//   <div className={styles.labelWrapper}>\n//     <label className={styles.label} htmlFor=\"outputText\">\n//       System-generated Text\n//     </label>\n//     <div className={styles.actions}>\n//       <div\n//         className={styles.copyIcon}\n//         onClick={() => handleCopy(outputText)}\n//         title=\"Copy to Clipboard\"\n//       >\n//         📋 {/* Clipboard Emoji */}\n//       </div>\n//       <div\n//         className={styles.copyIcon}\n//         onClick={() => handleDownload(outputText, \"GeneratedText\", \"txt\")}\n//         title=\"Download as TXT\"\n//       >\n//         📥 {/* Download Icon */}\n//       </div>\n//       <button\n//         className={styles.toggleDiffBtn}\n//         onClick={() => setShowDifference(!showDifference)}\n//       >\n//         {showDifference ? \"Hide Difference\" : \"Show Difference\"}\n//       </button>\n//     </div>\n//   </div>\n//   <textarea\n//     id=\"outputText\"\n//     className={`${styles.output_box} ${styles.side_by_side}`}\n//     value={outputText}\n//     onChange={(e) => setOutputText(e.target.value)}\n//     readOnly={isEditable}\n//     placeholder=\"Output\"\n//   ></textarea>\n// </div>\n//             {/* Difference Text */}\n// \t\t\t{showDifference && (\n// \t\t\t\t<div className={styles.text_container}>\n// \t\t\t\t<label className={styles.label} htmlFor=\"outputText\">\n// \t\t\t\t\tDifference from original text\n// \t\t\t\t</label>\n// \t\t\t\t\t<div\n// \t\t\t\t\tid=\"diffText\"\n// \t\t\t\t\tclassName={`${styles.output_box} ${styles.side_by_side}`}\n// \t\t\t\t\tdangerouslySetInnerHTML={{ __html: diffHtml }}\n// \t\t\t\t\t></div>\n// \t\t\t\t {/* )} */}\n// \t\t\t\t</div>\n// \t\t\t)}\n// \t\t\t</div>\n//           {/* Buttons */}\n// \t\t\t<div className={styles.button_container}>\n//     \t\t\t\t{isSaveButtonVisible && (\n//     \t\t\t\t<button\n//     \t\t\t\t\tclassName={`${styles.save_btn} ${styles.text_btn}`}\n//     \t\t\t\t\tonClick={handleSave}\n//     \t\t\t\t\tdisabled={isLoading}\n//     \t\t\t\t>\n//     \t\t\t\t\tSave\n//     \t\t\t\t</button>\n//     \t\t\t\t)}\n//     \t\t\t\t{!isEditable && (\n//     \t\t\t\t\t<button\n//     \t\t\t\t\tclassName={`${styles.edit_btn} ${styles.text_btn}`}\n//     \t\t\t\t\tonClick={handleEdit}\n//     \t\t\t\t\t>\n//     \t\t\t\t\tEdit\n//     \t\t\t\t\t</button>\n//     \t\t\t\t)}\n//     \t\t\t\t</div>\n//           {/* Survey Prompt */}\n//     \t  {showSurveyPrompt && (\n//                   <div className={styles.survey_prompt}>\n//                     <p>\n//                       Please take the survey to help us improve {\" \"}\n//                       <button\n//                         className={styles.link_btn}\n//                         onClick={() =>\n//                           navigate(\"/survey\", {\n//                             state: { email: JSON.parse(localStorage.getItem(\"user\")).email, inputText },\n//                           })\n//                         }\n//                       >\n//                         Take the Survey\n//                       </button>\n//                     </p>\n//                   </div>\n//                 )}\n//         </div>\n//       </div>\n//     </>\n//   );\n// };\n// export default Review;\n// import React from \"react\";\n// import { useState, useEffect, useRef } from \"react\";\n// import { useLocation, useNavigate } from \"react-router-dom\";\n// import DiffMatchPatch from \"diff-match-patch\";\n// import styles from \"./styles.module.css\";\n// const Review = () => {\n//   const { state } = useLocation();\n//   const { inputText, outputText: initialOutputText } = state || {\n//     inputText: \"\",\n//     outputText: \"\",\n//   };\n//   const [outputText, setOutputText] = useState(initialOutputText);\n//   const [diffHtml, setDiffHtml] = useState(\"\"); // State for storing diff HTML\n//   const [isEditable, setIsEditable] = useState(false);\n//   const [editHistory, setEditHistory] = useState([]); // Array to store edit history\n//   const [isHistoryVisible, setIsHistoryVisible] = useState(false); // Show/Hide history sidebar\n//   const navigate = useNavigate();\n//   const contentEditableRef = useRef(null); // Reference to the contentEditable div\n// \tconst [isLoading, setIsLoading] = useState(false);\n// \tconst [isSaveButtonVisible, setIsSaveButtonVisible] = useState(true);\n// \tconst [showSurveyPrompt, setShowSurveyPrompt] = useState(false); // State for survey prompt\n//   // Function to calculate and render diff\n//   const generateDiff = (input, output) => {\n//     const dmp = new DiffMatchPatch();\n//     const diffs = dmp.diff_main(input, output);\n//     dmp.diff_cleanupSemantic(diffs); // Optional cleanup for better readability\n//     return dmp.diff_prettyHtml(diffs); // Generate diff HTML\n//   };\n//   // Effect to calculate diff whenever text changes\n//   useEffect(() => {\n//     const diffResult = generateDiff(inputText, outputText);\n//     setDiffHtml(diffResult);\n//   }, [inputText, outputText]);\n//   const handleLogout = () => {\n//     localStorage.removeItem(\"token\");\n//     window.location.reload();\n//   };\n//   \tconst handleSave = async (isAuto = false) => {\n// //\t\tsetIsSaveButtonVisible(false);\n// if (isAuto && isAuto.nativeEvent) {\n// \tisAuto = false; // Default behavior if called by an event\n// }\n// \t\ttry {\n// \t\t  const user = JSON.parse(localStorage.getItem(\"user\")); // Retrieve user info\n// \t\t  if (!user) {\n// \t\t\talert(\"User not logged in!\");\n// \t\t\treturn;\n// \t\t  }\n// \t\t  const payload = {\n// \t\t\tuserId: user._id,\n// \t\t\temail: user.email,\n// \t\t\tinputText,\n// \t\t\t...(isEditable ? { editedText: outputText } : { outputText, editableText: outputText }),\n// \t\t  };\n// \t\t  const endpoint = isEditable\n// \t\t\t? \"https://textsimplification-eecqhvdcduczf8cz.westus-01.azurewebsites.net/api/simplifications/edit\" // Endpoint for updating\n// \t\t\t: \"https://textsimplification-eecqhvdcduczf8cz.westus-01.azurewebsites.net/api/simplifications\"; // Endpoint for initial save\n// \t\t  const method = isEditable ? \"PUT\" : \"POST\"; // Use PUT for updates, POST for saves\n// \t\t  const response = await fetch(endpoint, {\n// \t\t\tmethod,\n// \t\t\theaders: { \"Content-Type\": \"application/json\" },\n// \t\t\tbody: JSON.stringify(payload),\n// \t\t  });\n// \t\t  if (response.ok) {\n// \t\t\tconst data = await response.json();\n// \t\t\talert(isEditable ? \"Edited text saved successfully!\" : \"Simplification saved successfully!\");\n// \t\t\t//setShowSurveyPrompt(true); \n// \t\t\tconsole.log(\"isSaveButtonVisible\", isSaveButtonVisible);\n// \t\t\tconsole.log(\"isEditable\", isEditable);\n// \t\t\tconsole.log(\"isAuto\", isAuto);\n// \t\t\tif (!isSaveButtonVisible) {  //edit, save, edit\n// \t\t\t\tsetShowSurveyPrompt(false); // Show the survey prompt\n// \t\t\t  }\n// \t\t\telse if (isSaveButtonVisible && !isEditable && isAuto)  //true false -- first time save or edit button clicked\n// \t\t\t{\n// \t\t\t\tsetShowSurveyPrompt(false);\n// \t\t\t}\n// \t\t\telse if (isSaveButtonVisible && isEditable)\n// \t\t\t{\n// \t\t\t\tsetShowSurveyPrompt(true);\n// \t\t\t} \n// \t\t\telse if (isSaveButtonVisible && !isEditable && !isAuto)  //true false -- first time save or edit button clicked\n// \t\t\t{\n// \t\t\t\tsetShowSurveyPrompt(true);\n// \t\t\t}\n// \t\t\tsetEditHistory((prev) => [\n// \t\t\t\t...prev,\n// \t\t\t\t{ timestamp: new Date().toLocaleString(), text: outputText },\n// \t\t\t  ]);\n// \t\t\tif (isEditable) {\n// \t\t\t {\n// \t\t\t\tsetIsEditable(false); // Exit editing mode after saving edits\n// \t\t\t  // disable saving button\n// \t\t\t  setIsSaveButtonVisible(false); // Hide the save button\n// \t\t\t   // Show the survey prompt\n// \t\t\t // setShowSurveyPrompt(true); \n// \t\t\t }\n// \t\t  }} else {\n// \t\t\tconst error = await response.json();\n// \t\t\talert(error.message || \"Failed to save simplification.\");\n// \t\t  }\n// \t\t} catch (error) {\n// \t\t  console.error(\"Error saving simplification:\", error);\n// \t\t  alert(\"An error occurred. Please try again.\");\n// \t\t}\n// \t  };\n// \t  const handleHistoryClick = (edit) => {\n// \t\tsetOutputText(edit.text);\n// \t\tconst diffResult = generateDiff(inputText, edit.text);\n// \t\tsetDiffHtml(diffResult);\n// \t\tsetIsEditable(false);\n// \t  };\n// \tconst handleEdit = () => {\n// \t  let isAuto = true;\n// \t  handleSave(isAuto); // Save the current output text\n// \t  setIsEditable(true); // Enable editing mode\n// \t  setIsSaveButtonVisible(true);\n// \t};\n//   return (\n//     <>\n//       <nav className={styles.navbar}>\n//         <h1>Text Simplification Study</h1>\n//         <button className={styles.white_btn} onClick={handleLogout}>\n//           Logout\n//         </button>\n//       </nav>\n//       <div className={styles.main_container}>\n//         <div className={styles.description}>\n//           <p>\n//             Review the generated output and make any necessary edits. Changes\n//             are highlighted in real-time for easy visualization.\n//           </p>\n//       {/* Sidebar */}\n//       <div className={styles.sidebar}>\n//         <button\n//           className={styles.historyIcon}\n//           onClick={() => setIsHistoryVisible(!isHistoryVisible)}\n//         >\n//           🕒 {/* History Icon */}\n//         </button>\n//         {isHistoryVisible && (\n//           <div className={styles.historyPanel}>\n//             <h3>Edit History</h3>\n//             <ul className={styles.historyList}>\n//               {editHistory.map((edit, index) => (\n//                 <li\n//                   key={index}\n//                   className={styles.historyItem}\n//                   onClick={() => handleHistoryClick(edit)}\n//                 >\n//                   {edit.timestamp}\n//                 </li>\n//               ))}\n//             </ul>\n//           </div>\n//         )}\n//       </div>\n//           <div className={styles.form_container}>\n//             {/* Input and Diff Boxes */}\n//             <div className={styles.textareas_container}>\n//               {/* Input Text Box */}\n//               <div className={styles.text_container}>\n//                 <label className={styles.label} htmlFor=\"inputText\">\n//                   Input Text\n//                 </label>\n//                 <textarea\n//                   id=\"inputText\"\n//                   className={`${styles.textarea} ${styles.side_by_side}`}\n//                   value={inputText}\n//                   readOnly\n//                 ></textarea>\n//               </div>\n// <div className={styles.text_container}>\n//   <label className={styles.label} htmlFor=\"outputText\">\n//     System-generated Text\n//   </label>\n// {isEditable ? (\n//     <>\n//       <textarea\n//         id=\"outputText\"\n//         className={`${styles.textarea} ${styles.side_by_side}`}\n//         value={outputText}\n//         onChange={(e) => {\n//           const updatedText = e.target.value;\n//           setOutputText(updatedText); // Update the output text state\n//           const updatedDiff = generateDiff(inputText, updatedText); // Recalculate the diff\n//           setDiffHtml(updatedDiff); // Update the diff HTML in real-time\n//         }}\n//         placeholder=\"Output\"\n//       ></textarea>\n//     </>\n//   ) : (\n//     <div\n//       id=\"diffText\"\n//       className={`${styles.output_box} ${styles.side_by_side}`}\n//       dangerouslySetInnerHTML={{ __html: diffHtml }}\n//     ></div>\n//   )} \n// </div>\n//             </div>\n//     \t\t\t\t<div className={styles.button_container}>\n//     \t\t\t\t{isSaveButtonVisible && (\n//     \t\t\t\t<button\n//     \t\t\t\t\tclassName={`${styles.save_btn} ${styles.text_btn}`}\n//     \t\t\t\t\tonClick={handleSave}\n//     \t\t\t\t\tdisabled={isLoading}\n//     \t\t\t\t>\n//     \t\t\t\t\tSave\n//     \t\t\t\t</button>\n//     \t\t\t\t)}\n//     \t\t\t\t{!isEditable && (\n//     \t\t\t\t\t<button\n//     \t\t\t\t\tclassName={`${styles.edit_btn} ${styles.text_btn}`}\n//     \t\t\t\t\tonClick={handleEdit}\n//     \t\t\t\t\t>\n//     \t\t\t\t\tEdit\n//     \t\t\t\t\t</button>\n//     \t\t\t\t)}\n//     \t\t\t\t</div>\n//           {/* Survey Prompt */}\n//     \t  {showSurveyPrompt && (\n//                   <div className={styles.survey_prompt}>\n//                     <p>\n//                       Please take the survey to help us improve {\" \"}\n//                       <button\n//                         className={styles.link_btn}\n//                         onClick={() =>\n//                           navigate(\"/survey\", {\n//                             state: { email: JSON.parse(localStorage.getItem(\"user\")).email, inputText },\n//                           })\n//                         }\n//                       >\n//                         Take the Survey\n//                       </button>\n//                     </p>\n//                   </div>\n//                 )}\n//     \t\t\t</div>\n//     \t\t</div> \n//     \t\t</div>\n//     \t  </>\n//   );\n// };\n// export default Review;\n{/* \n\t\t\t  <div className={styles.text_container}>\n  <label className={styles.label} htmlFor=\"outputText\">\n    System-generated Text\n  </label>\n  {isEditable ? (\n    <textarea\n      id=\"outputText\"\n      className={`${styles.textarea} ${styles.side_by_side}`}\n      value={outputText}\n      onChange={(e) => setOutputText(e.target.value)} // Handle user edits\n      placeholder=\"Output\"\n    ></textarea>\n  ) : (\n    <div\n      id=\"diffText\"\n      className={`${styles.output_box} ${styles.side_by_side}`}\n      dangerouslySetInnerHTML={{ __html: diffHtml }}\n    ></div>\n  )}\n</div> */}// import React from \"react\";\n// import { useState, useEffect } from \"react\";\n// import { useLocation, useNavigate } from \"react-router-dom\";\n// import DiffMatchPatch from \"diff-match-patch\";\n// import styles from \"./styles.module.css\";\n// const Review = () => {\n//   const { state } = useLocation();\n// //   const { inputText, outputText } = state || { inputText: \"\", outputText: \"\" };\n// //   const navigate = useNavigate();\n// const { inputText, outputText: initialOutputText } = state || {\n//     inputText: \"\",\n//     outputText: \"\",\n//   };\n//   const [outputText, setOutputText] = useState(initialOutputText);\n// \tconst [isLoading, setIsLoading] = useState(false);\n// \tconst [isEditable, setIsEditable] = useState(false); // For toggling edit mode\n// \tconst [diffHtml, setDiffHtml] = useState(\"\"); \n// \tconst [isSaveButtonVisible, setIsSaveButtonVisible] = useState(true);\n// \tconst [showSurveyPrompt, setShowSurveyPrompt] = useState(false); // State for survey prompt\n//     const navigate = useNavigate();\n// \tconst handleLogout = () => {\n// \t  localStorage.removeItem(\"token\");\n// \t  window.location.reload();\n// \t};\n// \t// Function to calculate and render diff\n// \tconst generateDiff = (input, output) => {\n// \tconst dmp = new DiffMatchPatch();\n// \tconst diffs = dmp.diff_main(input, output);\n// \tdmp.diff_cleanupSemantic(diffs); // Optional cleanup for better readability\n// \treturn dmp.diff_prettyHtml(diffs); // Generate diff HTML\n// \t};\n// \t// Effect to calculate diff whenever text changes\n// \tuseEffect(() => {\n// \tconst diffResult = generateDiff(inputText, outputText);\n// \tsetDiffHtml(diffResult);\n// \t}, [inputText, outputText]);\n//   \tconst handleSave = async (isAuto = false) => {\n// //\t\tsetIsSaveButtonVisible(false);\n// if (isAuto && isAuto.nativeEvent) {\n// \tisAuto = false; // Default behavior if called by an event\n// }\n// \t\ttry {\n// \t\t  const user = JSON.parse(localStorage.getItem(\"user\")); // Retrieve user info\n// \t\t  if (!user) {\n// \t\t\talert(\"User not logged in!\");\n// \t\t\treturn;\n// \t\t  }\n// \t\t  const payload = {\n// \t\t\tuserId: user._id,\n// \t\t\temail: user.email,\n// \t\t\tinputText,\n// \t\t\t...(isEditable ? { editedText: outputText } : { outputText, editableText: outputText }),\n// \t\t  };\n// \t\t  const endpoint = isEditable\n// \t\t\t? \"https://textsimplification-eecqhvdcduczf8cz.westus-01.azurewebsites.net/api/simplifications/edit\" // Endpoint for updating\n// \t\t\t: \"https://textsimplification-eecqhvdcduczf8cz.westus-01.azurewebsites.net/api/simplifications\"; // Endpoint for initial save\n// \t\t  const method = isEditable ? \"PUT\" : \"POST\"; // Use PUT for updates, POST for saves\n// \t\t  const response = await fetch(endpoint, {\n// \t\t\tmethod,\n// \t\t\theaders: { \"Content-Type\": \"application/json\" },\n// \t\t\tbody: JSON.stringify(payload),\n// \t\t  });\n// \t\t  if (response.ok) {\n// \t\t\tconst data = await response.json();\n// \t\t\talert(isEditable ? \"Edited text saved successfully!\" : \"Simplification saved successfully!\");\n// \t\t\t//setShowSurveyPrompt(true); \n// \t\t\tconsole.log(\"isSaveButtonVisible\", isSaveButtonVisible);\n// \t\t\tconsole.log(\"isEditable\", isEditable);\n// \t\t\tconsole.log(\"isAuto\", isAuto);\n// \t\t\tif (!isSaveButtonVisible) {  //edit, save, edit\n// \t\t\t\tsetShowSurveyPrompt(false); // Show the survey prompt\n// \t\t\t  }\n// \t\t\telse if (isSaveButtonVisible && !isEditable && isAuto)  //true false -- first time save or edit button clicked\n// \t\t\t{\n// \t\t\t\tsetShowSurveyPrompt(false);\n// \t\t\t}\n// \t\t\telse if (isSaveButtonVisible && isEditable)\n// \t\t\t{\n// \t\t\t\tsetShowSurveyPrompt(true);\n// \t\t\t} \n// \t\t\telse if (isSaveButtonVisible && !isEditable && !isAuto)  //true false -- first time save or edit button clicked\n// \t\t\t{\n// \t\t\t\tsetShowSurveyPrompt(true);\n// \t\t\t}\n// \t\t\tif (isEditable) {\n// \t\t\t {\n// \t\t\t\tsetIsEditable(false); // Exit editing mode after saving edits\n// \t\t\t  // disable saving button\n// \t\t\t  setIsSaveButtonVisible(false); // Hide the save button\n// \t\t\t   // Show the survey prompt\n// \t\t\t // setShowSurveyPrompt(true); \n// \t\t\t }\n// \t\t  }} else {\n// \t\t\tconst error = await response.json();\n// \t\t\talert(error.message || \"Failed to save simplification.\");\n// \t\t  }\n// \t\t} catch (error) {\n// \t\t  console.error(\"Error saving simplification:\", error);\n// \t\t  alert(\"An error occurred. Please try again.\");\n// \t\t}\n// \t  };\n// \tconst handleEdit = () => {\n// \t  let isAuto = true;\n// \t  handleSave(isAuto); // Save the current output text\n// \t  setIsEditable(true); // Enable editing mode\n// \t  setIsSaveButtonVisible(true);\n// \t  //navigate(\"/edit\"); // Navigate to edit page\n// \t  //setShowSurveyPrompt(false);\n// \t  // Add back button\n// \t};\n//   return (\n//     <>\n//     <nav className={styles.navbar}>\n//       <h1>Text Simplification Study</h1>\n//       <button className={styles.white_btn} onClick={handleLogout}>\n//         Logout\n//       </button>\n//     </nav>\n//     <div className={styles.main_container}>\n//         <div className={styles.description}>\n// \t\t\t  <p>\n// \t\t\t\tReview the generated output and make any necessary edits. Click the \"Edit\" button to make changes to the text. Once you are satisfied with the text, click the \"Save\" button to save your changes.\n// \t\t\t  </p>\n//             <br></br>\n//      \t\t\t<div className={styles.form_container}>\n//      \t\t\t  {/* Input and Output Boxes */}\n//      \t\t\t  <div className={styles.textareas_container}>\n//      \t\t\t\t{/* Input Text Box */}\n//      \t\t\t\t<div className={styles.text_container}>\n//      \t\t\t\t  <label className={styles.label} htmlFor=\"inputText\">\n//      \t\t\t\t\tInput Text\n//      \t\t\t\t  </label>\n//     \t\t\t\t  <textarea\n//     \t\t\t\t\tid=\"inputText\"\n//     \t\t\t\t\tclassName={`${styles.textarea} ${styles.side_by_side}`}\n//     \t\t\t\t\tvalue={inputText}\n//     \t\t\t\t\t//onChange={(e) => setInputText(e.target.value)}\n//     \t\t\t\t\treadOnly\n//     \t\t\t\t  ></textarea>\n//     \t\t\t\t</div>\n//     \t\t\t\t{/* Output Text Box */}\n//     \t\t\t\t<div className={styles.text_container}>\n//     \t\t\t\t  <label className={styles.label} htmlFor=\"diffText\">\n//     \t\t\t\t\tSystem-generated Text\n//     \t\t\t\t  </label>\n//     \t\t\t\t  <textarea\n//     \t\t\t\t\tid=\"diffText\"\n//     \t\t\t\t\tclassName={`${styles.output_box} ${styles.side_by_side}`}\n//     \t\t\t\t\tvalue={outputText}\n//     \t\t\t\t\tonChange={(e) => setOutputText(e.target.value)}\n// \t\t\t\t\t\tdangerouslySetInnerHTML={{ __html: diffHtml }}\n//     \t\t\t\t\treadOnly={!isEditable}\n//     \t\t\t\t\tplaceholder=\"Output\"\n//     \t\t\t\t  ></textarea>\n//     \t\t\t\t</div>\n//     \t\t\t  </div>\n//     \t\t\t\t{/* Save and Edit Buttons */}\n//     \t\t\t\t<div className={styles.button_container}>\n//     \t\t\t\t{isSaveButtonVisible && (\n//     \t\t\t\t<button\n//     \t\t\t\t\tclassName={`${styles.save_btn} ${styles.text_btn}`}\n//     \t\t\t\t\tonClick={handleSave}\n//     \t\t\t\t\tdisabled={isLoading}\n//     \t\t\t\t>\n//     \t\t\t\t\tSave\n//     \t\t\t\t</button>\n//     \t\t\t\t)}\n//     \t\t\t\t{!isEditable && (\n//     \t\t\t\t\t<button\n//     \t\t\t\t\tclassName={`${styles.edit_btn} ${styles.text_btn}`}\n//     \t\t\t\t\tonClick={handleEdit}\n//     \t\t\t\t\t>\n//     \t\t\t\t\tEdit\n//     \t\t\t\t\t</button>\n//     \t\t\t\t)}\n//     \t\t\t\t</div>\n//           {/* Survey Prompt */}\n//     \t  {showSurveyPrompt && (\n//                   <div className={styles.survey_prompt}>\n//                     <p>\n//                       Please take the survey to help us improve {\" \"}\n//                       <button\n//                         className={styles.link_btn}\n//                         onClick={() =>\n//                           navigate(\"/survey\", {\n//                             state: { email: JSON.parse(localStorage.getItem(\"user\")).email, inputText },\n//                           })\n//                         }\n//                       >\n//                         Take the Survey\n//                       </button>\n//                     </p>\n//                   </div>\n//                 )}\n//     \t\t\t</div>\n//     \t\t</div> \n//     \t\t</div>\n//     \t  </>\n//   );\n// };\n// export default Review;","map":{"version":3,"names":["React","useState","useEffect","useRef","useLocation","useNavigate","DiffMatchPatch","FaRegCopy","FaDownload","saveAs","styles","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Review","state","inputText","outputText","initialOutputText","editHistory","restoredEditHistory","setOutputText","setEditHistory","diffHtml","setDiffHtml","isSaveButtonEnabled","setIsSaveButtonEnabled","navigate","isEditable","setIsEditable","isSidebarVisible","setIsSidebarVisible","showDifference","setShowDifference","inputWordCount","setInputWordCount","inputCharCount","setInputCharCount","outputWordCount","setOutputWordCount","outputCharCount","setOutputCharCount","isHistoryVisible","setIsHistoryVisible","contentEditableRef","isLoading","setIsLoading","isSaveButtonVisible","setIsSaveButtonVisible","showSurveyPrompt","setShowSurveyPrompt","handleLogout","localStorage","removeItem","countWordsAndChars","text","words","trim","split","filter","Boolean","length","chars","generatePrompt","splitTextIntoChunks","maxTokens","chunks","currentChunk","word","join","push","saveSimplification","user","JSON","parse","getItem","response","fetch","method","headers","body","stringify","userId","_id","ok","console","log","error","json","message","handleResimplify","combinedOutput","chunk","_data$response","prompt","status","data","newOutput","replace","saveEditToHistory","editedText","email","saveFinalOutput","finalText","timestamp","Date","toISOString","prev","handleEditChange","event","updatedText","target","value","handleCopy","navigator","clipboard","writeText","then","alert","err","handleDownload","filename","format","blob","Blob","type","reviewPageState","setItem","savedState","diffResult","generateDiff","inputWords","inputChars","outputWords","outputChars","handleHistoryClick","edit","input","output","dmp","diffs","diff_main","diff_cleanupSemantic","diff_prettyHtml","children","className","navbar","onClick","window","location","href","style","cursor","white_btn","container","sidebar","expanded","historyIcon","fontSize","historyContent","closeButton","historyList","map","index","historyItem","mainContent","withSidebar","description","textareas_container","text_container","labelWrapper","label","htmlFor","actions","copyIcon","title","countText","id","textarea","side_by_side","readOnly","toggleDiffBtn","output_box","onChange","placeholder","dangerouslySetInnerHTML","__html","button_container","submit_btn","disabled","help_text","survey_prompt","survey_text","survey_btn"],"sources":["/Users/anukumar/Desktop/Autumn 2024/Text Simplification/textsimplification/client/src/components/Review/index.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef  } from \"react\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport DiffMatchPatch from \"diff-match-patch\";\nimport { FaRegCopy, FaDownload } from \"react-icons/fa\"; // Import FontAwesome icons\nimport { saveAs } from \"file-saver\";\nimport styles from \"./styles.module.css\";\n\nconst Review = () => {\n\n\n  const { state } = useLocation();\n  const { inputText, outputText: initialOutputText, editHistory: restoredEditHistory } = state || {\n    inputText: \"\",\n    outputText: \"\",\n    editHistory: [],\n  };\n\n  const [outputText, setOutputText] = useState(initialOutputText);\n  const [editHistory, setEditHistory] = useState(restoredEditHistory || []);\n\n  const [diffHtml, setDiffHtml] = useState(\"\");\n  const [isSaveButtonEnabled, setIsSaveButtonEnabled] = useState(false);\n  const navigate = useNavigate();\n\n\n  const [isEditable, setIsEditable] = useState(false);\n  const [isSidebarVisible, setIsSidebarVisible] = useState(false);\n  const [showDifference, setShowDifference] = useState(false);\n\n  const [inputWordCount, setInputWordCount] = useState(0);\n  const [inputCharCount, setInputCharCount] = useState(0);\n\n  const [outputWordCount, setOutputWordCount] = useState(0);\n  const [outputCharCount, setOutputCharCount] = useState(0);\n\n\n\n//   const navigate = useNavigate();\n\n\n  const [isHistoryVisible, setIsHistoryVisible] = useState(false); // Show/Hide history sidebar\n  const contentEditableRef = useRef(null); // Reference to the contentEditable div\n\n\tconst [isLoading, setIsLoading] = useState(false);\n\n\tconst [isSaveButtonVisible, setIsSaveButtonVisible] = useState(true);\n\tconst [showSurveyPrompt, setShowSurveyPrompt] = useState(false); // State for survey prompt\n\n    const handleLogout = () => {\n    localStorage.removeItem(\"token\");\n\tnavigate(\"/Login\"); \n\n  localStorage.removeItem(\"reviewPageState\"); // Clear the saved state\n\n   // window.location.reload();\n  };\n\n  const countWordsAndChars = (text) => {\n    const words = text.trim().split(/\\s+/).filter(Boolean).length;\n    const chars = text.length;\n    return { words, chars };\n  };\n  \n\t// Function to format the prompt with user input\n  const generatePrompt = (inputText) => {\n    return `\n    You are an expert in accessible communication, tasked with simplifying a given text for individuals with intellectual and developmental disabilities (IDD). \n    \n    Please do not summarize or reduce the length of output content. Instead, simplify the text preserving the intended meaning or information. The output length should be similar to the input length.\n    \n    Follow these detailed guidelines to ensure the text is clear, easy to understand, and accessible:\n    \n    1. Sentence and Structure Simplification\n    - Use short sentences (8-10 words max).\n    - Keep one main idea per sentence to avoid confusion.\n    - Write in active voice (e.g., \"A doctor gives medicine\" instead of \"Medicine is given by a doctor\").\n    - Avoid bulleted lists. Instead, write short, direct sentences in paragraph form.\n    - Repeat important words instead of using synonyms to improve comprehension.\n    - Start a new paragraph when introducing a different idea.\n    \n    2. Word Choice and Vocabulary\n    - Replace complex words with simple, common words (words most people know and use every day).\n    - Use words with few syllables (e.g., \"help\" instead of \"assist\").\n    - Avoid figurative language (no metaphors, similes, or idioms).\n      - ❌ \"It’s a piece of cake.\"  \n      - ✅ \"It is easy to do.\"  \n    - If a difficult word is necessary, provide a simple definition within the text.\n    - Avoid negatives when possible (e.g., instead of \"Do not touch,\" say \"Keep hands away\").\n    \n    3. Text Organization\n    If necessary,\n    - Use headings that are short and direct (max 8 words). Example:\n      - ❌ \"Understanding the Difference Between the Flu and COVID-19\"  \n      - ✅ \"Flu vs. COVID-19\"  \n    - Keep paragraphs short.\n    \n    4. Formatting for Readability\n    - Use left-aligned text with wide spacing between lines.\n    - Ensure the text is high contrast (black text on a white background).\n    - Avoid italics, underlining, or all caps, as they can be hard to read.\n    \n    5. Instructions and Steps\n    - If the text includes instructions, keep steps short and clear.\n    - Example:\n      - ❌ \"First, you will need to open the box carefully and remove the contents before proceeding to step two, which involves assembling the parts.\"  \n      - ✅ \"Step 1: Open the box.  \n       Step 2: Take out the parts.\"  \n    \n    6. Retaining Meaning and Key Details\n    - Do not remove important information, but explain it in a simpler way.\n    - Ensure the simplified version does not change the facts.\n    - The output should remain accurate, informative, and accessible.\n  \n    7. Do not simplify unnecessarily and the output should contain only the simplified text, nothing else.\n    \n    Now, simplify the following text line-by-line according to these guidelines:\n    \"${inputText}\"\n    `;\n    };\n  \n    const splitTextIntoChunks = (text, maxTokens) => {\n    const words = text.split(\" \");\n    let chunks = [];\n    let currentChunk = [];\n    \n    for (let word of words) {\n      if (currentChunk.join(\" \").length + word.length < maxTokens) {\n      currentChunk.push(word);\n      } else {\n      chunks.push(currentChunk.join(\" \"));\n      currentChunk = [word];\n      }\n    }\n    if (currentChunk.length > 0) chunks.push(currentChunk.join(\" \"));\n    return chunks;\n    };\n\n  const saveSimplification = async () => {\n    try {\n      const user = JSON.parse(localStorage.getItem(\"user\"));\n      if (!user) return;\n\n      const response = await fetch(\"https://textsimplification-eecqhvdcduczf8cz.westus-01.azurewebsites.net/api/simplifications\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          userId: user._id,\n          inputText,\n          outputText,\n        }),\n      });\n\n      if (response.ok) {\n        console.log(\"Simplification saved successfully.\");\n        \n      } else {\n        const error = await response.json();\n        console.error(\"Error saving simplification:\", error.message);\n      }\n    } catch (error) {\n      console.error(\"Error saving simplification:\", error);\n    }\n  };\n\n  const handleResimplify = async () => {\n    if (!inputText.trim()) return;\n  \n    setIsLoading(true); // Show loading state\n  \n    try {\n\n      const chunks = splitTextIntoChunks(inputText, 30000);\n      let combinedOutput = \"\";\n    \n      for (let chunk of chunks) {\n      const prompt = generatePrompt(chunk);\n      const response = await fetch(\"https://textsimplification-eecqhvdcduczf8cz.westus-01.azurewebsites.net/api/gpt4\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ prompt }),\n      });\n      \n  \n      if (!response.ok) {\n        console.error(\"Error with API request:\", response.status);\n        return;\n      }\n  \n      const data = await response.json();\n      console.log(\"Full API Response: \", data);\n      const newOutput = data?.response?.replace(/^\"|\"$/g, \"\") || \"No response received.\";\n  \n      // Update System-generated Text\n      combinedOutput += newOutput + \" \";\n      console.log(\"Final Combined Output: \", combinedOutput);\n    \n      }\n      setOutputText(combinedOutput);\n    } catch (error) {\n      console.error(\"Error fetching GPT-4o response:\", error);\n      setOutputText(\"An error occurred while simplifying the text.\");\n    }\n  \n    setIsLoading(false);\n  };\n\n\n  \n  //\n  const saveEditToHistory = async (editedText) => {\n    try {\n      const user = JSON.parse(localStorage.getItem(\"user\"));\n      if (!user) return;\n\n      const response = await fetch(\"https://textsimplification-eecqhvdcduczf8cz.westus-01.azurewebsites.net/api/simplifications/edit\", {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          email: user.email,\n          inputText,\n          editedText,\n        }),\n      });\n\n      if (response.ok) {\n        console.log(\"Edit saved to history.\");\n      } else {\n        const error = await response.json();\n        console.error(\"Error saving edit to history:\", error.message);\n      }\n    } catch (error) {\n      console.error(\"Error saving edit to history:\", error);\n    }\n  };\n\n  const saveFinalOutput = async () => {\n    setIsLoading(true);\n\n    try {\n      const user = JSON.parse(localStorage.getItem(\"user\"));\n      if (!user) return;\n\n      const response = await fetch(\"https://textsimplification-eecqhvdcduczf8cz.westus-01.azurewebsites.net/api/simplifications/save\", {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          email: user.email,\n          inputText,\n          finalText: outputText,\n        }),\n      });\n\n    const timestamp = new Date().toISOString();\n    setEditHistory((prev) => [\n      ...prev,\n      { timestamp, text: outputText },\n    ]);\n\n      if (response.ok) {\n        console.log(\"Final output saved successfully.\");\n        setIsSaveButtonEnabled(false); // Disable save button\n        setShowSurveyPrompt(true);    // Ensure survey prompt is displayed\n      } else {\n        const error = await response.json();\n        console.error(\"Error saving final output:\", error.message);\n      }\n    } catch (error) {\n      console.error(\"Error saving final output:\", error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleEditChange = (event) => {\n    const updatedText = event.target.value;\n    setOutputText(updatedText);\n    setIsSaveButtonEnabled(true); // Enable save button on edit\n\n    // const timestamp = new Date().toISOString();\n    // setEditHistory((prev) => [\n    //   ...prev,\n    //   { timestamp, text: updatedText },\n    // ]);\n\n    // Save the change to edit history in MongoDB\n    saveEditToHistory(updatedText);\n  };\n\n  const handleCopy = (text) => {\n    navigator.clipboard.writeText(text).then(\n      () => {\n        alert(\"Copied to clipboard!\");\n      },\n      (err) => {\n        console.error(\"Failed to copy text:\", err);\n      }\n    );\n  };\n\n  const handleDownload = (text, filename, format) => {\n    const blob = new Blob([text], { type: \"text/plain;charset=utf-8\" });\n    saveAs(blob, `${filename}.${format}`);\n  };\n\n  useEffect(() => {\n    const reviewPageState = {\n      inputText,\n      outputText,\n      editHistory,\n    };\n    localStorage.setItem(\"reviewPageState\", JSON.stringify(reviewPageState));\n  }, [outputText, editHistory, inputText]);\n  \n  useEffect(() => {\n    const savedState = JSON.parse(localStorage.getItem(\"reviewPageState\"));\n    if (savedState) {\n      setOutputText(savedState.outputText || \"\");\n      setEditHistory(savedState.editHistory || []);\n    } else {\n      setOutputText(initialOutputText);\n      setEditHistory(restoredEditHistory || []);\n    }\n  \n    saveSimplification(); // Save the initial inputText and outputText\n    setIsSaveButtonEnabled(true);\n  }, [initialOutputText, restoredEditHistory]);\n  \n  // useEffect(() => {\n  //   // Save initial input and output text in MongoDB\n  //   saveSimplification();\n  // }, []);\n  useEffect(() => {\n    const diffResult = generateDiff(inputText, outputText);\n    setDiffHtml(diffResult);\n   // saveSimplification();\n  }, [inputText, outputText]);\n\n  useEffect(() => {\n    saveSimplification(); // Save the initial inputText and outputText\n    setIsSaveButtonEnabled(true);\n\n    const savedState = JSON.parse(localStorage.getItem(\"reviewPageState\"));\n    if (savedState) {\n      setOutputText(savedState.outputText || \"\");\n      setEditHistory(savedState.editHistory || []);\n    }\n  }, []);\n  \n  useEffect(() => {\n    const { words: inputWords, chars: inputChars } = countWordsAndChars(inputText);\n    const { words: outputWords, chars: outputChars } = countWordsAndChars(outputText);\n  \n    setInputWordCount(inputWords);\n    setInputCharCount(inputChars);\n    setOutputWordCount(outputWords);\n    setOutputCharCount(outputChars);\n  }, [inputText, outputText]);\n\n  \n  const handleHistoryClick = (edit) => {\n    setOutputText(edit.text);\n    const diffResult = generateDiff(inputText, edit.text);\n    setDiffHtml(diffResult);\n    setIsEditable(false);\n  };\n\n    // Function to calculate and render diff\n  const generateDiff = (input, output) => {\n    const dmp = new DiffMatchPatch();\n    const diffs = dmp.diff_main(input, output);\n    dmp.diff_cleanupSemantic(diffs); // Optional cleanup for better readability\n    return dmp.diff_prettyHtml(diffs);\n  };\n\n  return (\n    <>\n      <nav className={styles.navbar}>\n        {/* <h1>Text Simplification Tool</h1> */}\n        <h1 \n    onClick={() => window.location.href = \"https://textsimplification-eecqhvdcduczf8cz.westus-01.azurewebsites.net/\"}\n    style={{ cursor: \"pointer\" }} // Makes it look clickable\n \t\t>\n\t\tText Simplification Tool</h1>\n        <button className={styles.white_btn} onClick={handleLogout}>\n          Logout\n        </button>\n      </nav>\n\n      <div className={styles.container}>\n        {/* Sidebar */}\n        <div\n          className={`${styles.sidebar} ${\n            isSidebarVisible ? styles.expanded : \"\"\n          }`}\n        >\n          <button\n            className={styles.historyIcon}\n            onClick={() => setIsSidebarVisible(!isSidebarVisible)}\n          >\n             🕒   <p style={{ fontSize: \"15px\" }}> History </p> {/* History Icon */}\n          </button>\n          {isSidebarVisible && (\n            <div className={styles.historyContent}>\n              <button\n                className={styles.closeButton}\n                onClick={() => setIsSidebarVisible(false)}\n              >\n               ✖\n              </button>\n              {/* <h3>History</h3> */}\n              <ul className={styles.historyList}>\n                {editHistory.map((edit, index) => (\n                  <li\n                    key={index}\n                    className={styles.historyItem}\n                    onClick={() => handleHistoryClick(edit)}\n                  >\n                    {edit.timestamp}\n                  </li>\n                ))}\n              </ul>\n            </div>\n          )}\n        </div>\n\n        {/* Main Content */}\n        <div\n          className={`${styles.mainContent} ${\n            isSidebarVisible ? styles.withSidebar : \"\"\n          }`}\n        >\n\t\t\t<div className={styles.description}>\n\t\t\t<p>\n\t\n        Please review the simplified text carefully and make any edits as needed to suit your requirements. Once you are satisfied with your revisions, submit the final version and complete the short survey to provide your feedback.\n      </p>\n\t\t\t</div>\n\n\t\t\t<div className={styles.textareas_container}>\n\n  {/* Input Text */}\n  <div className={styles.text_container}>\n    <div className={styles.labelWrapper}>\n      <label className={styles.label} htmlFor=\"inputText\">\n        Input Text\n      </label>\n      <div className={styles.actions}>\n      <div\n        className={styles.copyIcon}\n        onClick={() => handleCopy(inputText)}\n        title=\"Copy to Clipboard\"\n      >\n        \n        📋 {/* Clipboard Emoji */}\n        </div>\n\n        <div\n        className={styles.copyIcon}\n        onClick={() => handleDownload(inputText, \"InputText\", \"txt\")}\n        title=\"Download as .txt file\"\n      >\n        📥 {/* Download Icon */}\n      </div>\n\n            {/* New Re-simplify Button */}\n      <div\n        className={styles.copyIcon}\n        onClick={handleResimplify}\n        title=\"Re-simplify Text\"\n        style={{ cursor: \"pointer\" }}\n      >\n        🔄 {/* Re-simplify Icon */}\n      </div>\n\n      </div>\n    </div>\n    <p className={styles.countText}>Words: {inputWordCount} | Characters: {inputCharCount}</p>\n\n    <textarea\n      id=\"inputText\"\n      className={`${styles.textarea} ${styles.side_by_side}`}\n      value={inputText}\n      readOnly\n    ></textarea>\n  </div>\n\n\t\t\t{/* Output Text Box */}\n<div className={styles.text_container}>\n  <div className={styles.labelWrapper}>\n    <label className={styles.label} htmlFor=\"outputText\">\n      System-generated Text\n    </label>\n    <div className={styles.actions}>\n      <div\n        className={styles.copyIcon}\n        onClick={() => handleCopy(outputText)}\n        title=\"Copy to Clipboard\"\n      >\n        📋 {/* Clipboard Emoji */}\n      </div>\n\n      <div\n        className={styles.copyIcon}\n        onClick={() => handleDownload(outputText, \"GeneratedText\", \"txt\")}\n        title=\"Download as .txt file\"\n      >\n        📥 {/* Download Icon */}\n      </div>\n      <button\n        className={styles.toggleDiffBtn}\n        onClick={() => setShowDifference(!showDifference)}\n      >\n        {showDifference ? \"Hide Difference with input text\" : \"Show Difference with input text\"}\n      </button>\n    </div>\n  </div>\n    {/* Word and Character Count */}\n    <p className={styles.countText}>Words: {outputWordCount} | Characters: {outputCharCount}</p>\n\n  <textarea\n    id=\"outputText\"\n    className={`${styles.output_box} ${styles.side_by_side}`}\n    value={outputText}\n    onChange={handleEditChange}\n    readOnly={isEditable}\n    placeholder=\"Output\"\n\n  ></textarea>\n</div>\n\n            {/* Difference Text */}\n\t\t\t{showDifference && (\n\t\t\t\t<div className={styles.text_container}>\n           <div className={styles.labelWrapper}>\n\t\t\t\t<label className={styles.label} htmlFor=\"outputText\">\n\t\t\t\t\tDifference from input text\n\t\t\t\t</label>\n        </div>   \n         \n\t\t\t\t\t<div\n\t\t\t\t\tid=\"diffText\"\n\t\t\t\t\tclassName={`${styles.output_box} ${styles.side_by_side}`}\n\t\t\t\t\tdangerouslySetInnerHTML={{ __html: diffHtml }}\n\t\t\t\t\t></div>\n\t\t\t\t {/* )} */}\n\t\t\t\t</div>\n\t\t\t)}\n\t\t\t\n\t\t\t</div>\n\n\n\n          {/* Buttons */}\n\t\t\t<div className={styles.button_container}>\n\n    \n    \t\t\t\t{/* <button\n    \t\t\t\t\tclassName={`${styles.save_btn} ${styles.text_btn}`}\n              onClick={saveFinalOutput}\n              disabled={!isSaveButtonEnabled || isLoading}\n              title={!isSaveButtonEnabled ? \"Please make an edit before submitting.\" : \"\"}\n\n    \t\t\t\t>\n    \t\t\t\t\tSubmit\n    \t\t\t\t</button> */}\n\n            <button\n            className={styles.submit_btn}\n            onClick={saveFinalOutput}\n            disabled={!isSaveButtonEnabled || isLoading}\n            title={!isSaveButtonEnabled ? \"Please make an edit before submitting.\" : \"\"}\n            >\n            Submit\n            </button>\n      </div>\n            <p className={styles.help_text}>Need Help? <a href=\"mailto:anukumar@uw.edu\">Contact Support</a></p>\n\n  {/* Survey Prompt (Appears Only After Submitting) */}\n  {showSurveyPrompt && (\n    <div className={styles.survey_prompt}>\n      <p className={styles.survey_text}>\n        Please take the survey to help us improve.\n        <button\n          className={styles.survey_btn}\n          onClick={() => {\n            const reviewPageState = { inputText, outputText, editHistory };\n            localStorage.setItem(\"reviewPageState\", JSON.stringify(reviewPageState));\n            navigate(\"/survey\", {\n              state: {\n                email: JSON.parse(localStorage.getItem(\"user\")).email,\n                inputText,\n                outputText,\n                editHistory,\n              },\n            });\n          }}\n        >\n          📑 Take the Survey\n        </button>\n      </p>\n    </div>\n  )}\n\n\n\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default Review;\n\n\n\n// import React, { useState, useEffect, useRef } from \"react\";\n// import { useLocation, useNavigate } from \"react-router-dom\";\n// import DiffMatchPatch from \"diff-match-patch\";\n// import { FaRegCopy, FaDownload } from \"react-icons/fa\"; // Import FontAwesome copy icon\n// import { FaCopy } from \"react-icons/fa\";\n// import { saveAs } from \"file-saver\";\n// import styles from \"./styles.module.css\";\n\n// const Review = () => {\n//   const { state } = useLocation();\n//   const { inputText, outputText: initialOutputText } = state || {\n//     inputText: \"\",\n//     outputText: \"\",\n//   };\n//   const [outputText, setOutputText] = useState(initialOutputText);\n//   const [diffHtml, setDiffHtml] = useState(\"\");\n//   const [isEditable, setIsEditable] = useState(false);\n//   const [editHistory, setEditHistory] = useState([]);\n//   const [isSidebarVisible, setIsSidebarVisible] = useState(false);\n//   const [showDifference, setShowDifference] = useState(false);\n\n//   const navigate = useNavigate();\n\n\n//   const [isHistoryVisible, setIsHistoryVisible] = useState(false); // Show/Hide history sidebar\n//   const contentEditableRef = useRef(null); // Reference to the contentEditable div\n\n// \tconst [isLoading, setIsLoading] = useState(false);\n\n// \tconst [isSaveButtonVisible, setIsSaveButtonVisible] = useState(true);\n// \tconst [showSurveyPrompt, setShowSurveyPrompt] = useState(false); // State for survey prompt\n\n\n//   // Function to calculate and render diff\n//   const generateDiff = (input, output) => {\n//     const dmp = new DiffMatchPatch();\n//     const diffs = dmp.diff_main(input, output);\n//     dmp.diff_cleanupSemantic(diffs); // Optional cleanup for better readability\n//     return dmp.diff_prettyHtml(diffs);\n//   };\n\n//   const handleLogout = () => {\n//     localStorage.removeItem(\"token\");\n// \tnavigate(\"/Login\"); \n//    // window.location.reload();\n//   };\n\n//    // Function to save the original input and output text to MongoDB\n//    const saveSimplification = async () => {\n//     try {\n//       const user = JSON.parse(localStorage.getItem(\"user\"));\n\n//       const response = await fetch(\"https://textsimplification-eecqhvdcduczf8cz.westus-01.azurewebsites.net/api/simplifications\", {\n//         method: \"POST\",\n//         headers: { \"Content-Type\": \"application/json\" },\n//         body: JSON.stringify({\n//           userId: user._id,\n//           inputText,\n//           outputText,\n//         }),\n//       });\n\n//       if (response.ok) {\n//         console.log(\"Simplification saved successfully.\");\n//       } else {\n//         const data = await response.json();\n//         console.error(\"Error saving simplification:\", data.message);\n//       }\n//     } catch (error) {\n//       console.error(\"Error saving simplification:\", error);\n//     }\n//   };\n\n//   // Function to save an edit to MongoDB\n//   const saveEdit = async (editedText) => {\n//     try {\n//       const user = JSON.parse(localStorage.getItem(\"user\"));\n\n//       const response = await fetch(\"https://textsimplification-eecqhvdcduczf8cz.westus-01.azurewebsites.net/api/simplifications/edit\", {\n//         method: \"PUT\",\n//         headers: { \"Content-Type\": \"application/json\" },\n//         body: JSON.stringify({\n//           email: user.email,\n//           inputText,\n//           editedText,\n//         }),\n//       });\n\n//       if (response.ok) {\n//         console.log(\"Edit saved successfully.\");\n//       } else {\n//         const data = await response.json();\n//         console.error(\"Error saving edit:\", data.message);\n//       }\n//     } catch (error) {\n//       console.error(\"Error saving edit:\", error);\n//     }\n//   };\n\n//   // Effect to calculate diff whenever text changes\n//   // useEffect(() => {\n//   //   const diffResult = generateDiff(inputText, outputText);\n//   //   setDiffHtml(diffResult);\n//   // }, [inputText, outputText]);\n\n//     // Effect to calculate diff and save the initial data\n//     useEffect(() => {\n//       const diffResult = generateDiff(inputText, outputText);\n//       setDiffHtml(diffResult);\n  \n//       // Save the original input and output text to MongoDB\n//       saveSimplification();\n//     }, [inputText, outputText]);\n\n//   const handleCopy = (text) => {\n// \tnavigator.clipboard.writeText(text).then(\n// \t  () => {\n// \t\talert(\"Copied to clipboard!\");\n// \t  },\n// \t  (err) => {\n// \t\tconsole.error(\"Failed to copy text: \", err);\n// \t  }\n// \t);\n//   };\n  \n//   // Function to handle download\n//   const handleDownload = (text, filename, format) => {\n//     const blob = new Blob([text], { type: \"text/plain;charset=utf-8\" });\n//     const link = document.createElement(\"a\");\n//     link.href = URL.createObjectURL(blob);\n//     link.download = `${filename}.${format}`;\n//     link.click();\n//   };\n  \n// //   const handleEdit = () => {\n// //     setIsEditable(true);\n// //   };\n\n// //   const handleSave = () => {\n// //     // Save the current state to history\n// //     setEditHistory((prev) => [\n// //       ...prev,\n// //       { timestamp: new Date().toLocaleString(), text: outputText },\n// //     ]);\n// //     alert(\"Saved successfully!\");\n// //     setIsEditable(false);\n// //   };\n// const handleSave = async () => {\n//   const editedText = outputText;\n\n//   // Save the edit to MongoDB\n//   await saveEdit(editedText);\n\n//   // Update the edit history\n//   setEditHistory((prev) => [\n//     ...prev,\n//     { timestamp: new Date().toLocaleString(), text: editedText },\n//   ]);\n\n//   setIsEditable(false);\n//   alert(\"Edited text saved successfully.\");\n// };\n\n// //     const handleSave = async (isAuto = false) => {\n// // //\t\tsetIsSaveButtonVisible(false);\n// // if (isAuto && isAuto.nativeEvent) {\n// // \tisAuto = false; // Default behavior if called by an event\n// // }\n\n\t\t  \n// // \t\ttry {\n// // \t\t  const user = JSON.parse(localStorage.getItem(\"user\")); // Retrieve user info\n// // \t\t  if (!user) {\n// // \t\t\talert(\"User not logged in!\");\n// // \t\t\treturn;\n// // \t\t  }\n\t  \n// // \t\t  const payload = {\n// // \t\t\tuserId: user._id,\n// // \t\t\temail: user.email,\n// // \t\t\tinputText,\n// // \t\t\t...(isEditable ? { editedText: outputText } : { outputText, editableText: outputText }),\n// // \t\t  };\n\t  \n// // \t\t  const endpoint = isEditable\n// // \t\t\t? \"https://textsimplification-eecqhvdcduczf8cz.westus-01.azurewebsites.net/api/simplifications/edit\" // Endpoint for updating\n// // \t\t\t: \"https://textsimplification-eecqhvdcduczf8cz.westus-01.azurewebsites.net/api/simplifications\"; // Endpoint for initial save\n\t  \n// // \t\t  const method = isEditable ? \"PUT\" : \"POST\"; // Use PUT for updates, POST for saves\n\t  \n// // \t\t  const response = await fetch(endpoint, {\n// // \t\t\tmethod,\n// // \t\t\theaders: { \"Content-Type\": \"application/json\" },\n// // \t\t\tbody: JSON.stringify(payload),\n// // \t\t  });\n\t  \n// // \t\t  if (response.ok) {\n// // \t\t\tconst data = await response.json();\n            \n// // \t\t\talert(isEditable ? \"Edited text saved successfully!\" : \"Simplification saved successfully!\");\n\n// // \t\t\t//setShowSurveyPrompt(true); \n// // \t\t\tconsole.log(\"isSaveButtonVisible\", isSaveButtonVisible);\n// // \t\t\tconsole.log(\"isEditable\", isEditable);\n// // \t\t\tconsole.log(\"isAuto\", isAuto);\n// // \t\t\tif (!isSaveButtonVisible) {  //edit, save, edit\n// // \t\t\t\tsetShowSurveyPrompt(false); // Show the survey prompt\n// // \t\t\t  }\n// // \t\t\telse if (isSaveButtonVisible && !isEditable && isAuto)  //true false -- first time save or edit button clicked\n// // \t\t\t{\n// // \t\t\t\tsetShowSurveyPrompt(false);\n// // \t\t\t}\n// // \t\t\telse if (isSaveButtonVisible && isEditable)\n// // \t\t\t{\n// // \t\t\t\tsetShowSurveyPrompt(true);\n// // \t\t\t} \n// // \t\t\telse if (isSaveButtonVisible && !isEditable && !isAuto)  //true false -- first time save or edit button clicked\n// // \t\t\t{\n// // \t\t\t\tsetShowSurveyPrompt(true);\n// // \t\t\t}\n\n// // \t\t\tsetEditHistory((prev) => [\n// // \t\t\t\t...prev,\n// // \t\t\t\t{ timestamp: new Date().toLocaleString(), text: outputText },\n// // \t\t\t  ]);\n\n// // \t\t\tif (isEditable) {\n// // \t\t\t {\n// // \t\t\t\tsetIsEditable(false); // Exit editing mode after saving edits\n// // \t\t\t  // disable saving button\n// // \t\t\t  setIsSaveButtonVisible(false); // Hide the save button\n// // \t\t\t   // Show the survey prompt\n// // \t\t\t // setShowSurveyPrompt(true); \n// // \t\t\t }\n\n\n// // \t\t  }} else {\n// // \t\t\tconst error = await response.json();\n// // \t\t\talert(error.message || \"Failed to save simplification.\");\n// // \t\t  }\n// // \t\t} catch (error) {\n// // \t\t  console.error(\"Error saving simplification:\", error);\n// // \t\t  alert(\"An error occurred. Please try again.\");\n// // \t\t}\n\n// // \t  };\n// const handleEdit = () => {\n//   setIsEditable(true);\n// };\n\n\n// \t// const handleEdit = () => {\n// \t//   let isAuto = true;\n// \t//   handleSave(isAuto); // Save the current output text\n// \t//   setIsEditable(true); // Enable editing mode\n// \t//   setIsSaveButtonVisible(true);\n\n// \t// };\n\n//   const handleHistoryClick = (edit) => {\n//     setOutputText(edit.text);\n//     const diffResult = generateDiff(inputText, edit.text);\n//     setDiffHtml(diffResult);\n//     setIsEditable(false);\n//   };\n\n//   return (\n//     <>\n//       <nav className={styles.navbar}>\n//         <h1>Text Simplification Study</h1>\n//         <button className={styles.white_btn} onClick={handleLogout}>\n//           Logout\n//         </button>\n//       </nav>\n\n//       <div className={styles.container}>\n//         {/* Sidebar */}\n//         <div\n//           className={`${styles.sidebar} ${\n//             isSidebarVisible ? styles.expanded : \"\"\n//           }`}\n//         >\n//           <button\n//             className={styles.historyIcon}\n//             onClick={() => setIsSidebarVisible(!isSidebarVisible)}\n//           >\n//              🕒   <p style={{ fontSize: \"15px\" }}> History </p> {/* History Icon */}\n//           </button>\n//           {isSidebarVisible && (\n//             <div className={styles.historyContent}>\n//               <button\n//                 className={styles.closeButton}\n//                 onClick={() => setIsSidebarVisible(false)}\n//               >\n//                ✖\n//               </button>\n//               {/* <h3>History</h3> */}\n//               <ul className={styles.historyList}>\n//                 {editHistory.map((edit, index) => (\n//                   <li\n//                     key={index}\n//                     className={styles.historyItem}\n//                     onClick={() => handleHistoryClick(edit)}\n//                   >\n//                     {edit.timestamp}\n//                   </li>\n//                 ))}\n//               </ul>\n//             </div>\n//           )}\n//         </div>\n\n//         {/* Main Content */}\n//         <div\n//           className={`${styles.mainContent} ${\n//             isSidebarVisible ? styles.withSidebar : \"\"\n//           }`}\n//         >\n// \t\t\t<div className={styles.description}>\n// \t\t\t<p>\n// \t\t\t\tReview the generated output and make any necessary edits. Changes\n// \t\t\t\tare highlighted in real-time for easy visualization.\n// \t\t\t</p>\n// \t\t\t</div>\n\n// \t\t\t<div className={styles.textareas_container}>\n\n//   {/* Input Text */}\n//   <div className={styles.text_container}>\n//     <div className={styles.labelWrapper}>\n//       <label className={styles.label} htmlFor=\"inputText\">\n//         Input Text\n//       </label>\n//       <div className={styles.actions}>\n//       <div\n//         className={styles.copyIcon}\n//         onClick={() => handleCopy(inputText)}\n//         title=\"Copy to Clipboard\"\n//       >\n//         </div>\n//         📋 {/* Clipboard Emoji */}\n//         <div\n//         className={styles.copyIcon}\n//         onClick={() => handleDownload(inputText, \"InputText\", \"txt\")}\n//         title=\"Download as TXT\"\n//       >\n//         📥 {/* Download Icon */}\n//       </div>\n//       </div>\n//     </div>\n//     <textarea\n//       id=\"inputText\"\n//       className={`${styles.textarea} ${styles.side_by_side}`}\n//       value={inputText}\n//       readOnly\n//     ></textarea>\n//   </div>\n\n// \t\t\t{/* Output Text Box */}\n// \t\t\t{/* Output Text Box */}\n// <div className={styles.text_container}>\n//   <div className={styles.labelWrapper}>\n//     <label className={styles.label} htmlFor=\"outputText\">\n//       System-generated Text\n//     </label>\n//     <div className={styles.actions}>\n//       <div\n//         className={styles.copyIcon}\n//         onClick={() => handleCopy(outputText)}\n//         title=\"Copy to Clipboard\"\n//       >\n//         📋 {/* Clipboard Emoji */}\n//       </div>\n\n//       <div\n//         className={styles.copyIcon}\n//         onClick={() => handleDownload(outputText, \"GeneratedText\", \"txt\")}\n//         title=\"Download as TXT\"\n//       >\n//         📥 {/* Download Icon */}\n//       </div>\n//       <button\n//         className={styles.toggleDiffBtn}\n//         onClick={() => setShowDifference(!showDifference)}\n//       >\n//         {showDifference ? \"Hide Difference\" : \"Show Difference\"}\n//       </button>\n//     </div>\n//   </div>\n//   <textarea\n//     id=\"outputText\"\n//     className={`${styles.output_box} ${styles.side_by_side}`}\n//     value={outputText}\n//     onChange={(e) => setOutputText(e.target.value)}\n//     readOnly={isEditable}\n//     placeholder=\"Output\"\n//   ></textarea>\n// </div>\n\n//             {/* Difference Text */}\n// \t\t\t{showDifference && (\n// \t\t\t\t<div className={styles.text_container}>\n// \t\t\t\t<label className={styles.label} htmlFor=\"outputText\">\n// \t\t\t\t\tDifference from original text\n// \t\t\t\t</label>\n\n// \t\t\t\t\t<div\n// \t\t\t\t\tid=\"diffText\"\n// \t\t\t\t\tclassName={`${styles.output_box} ${styles.side_by_side}`}\n// \t\t\t\t\tdangerouslySetInnerHTML={{ __html: diffHtml }}\n// \t\t\t\t\t></div>\n// \t\t\t\t {/* )} */}\n// \t\t\t\t</div>\n// \t\t\t)}\n\t\t\t\n// \t\t\t</div>\n\n\n\n//           {/* Buttons */}\n// \t\t\t<div className={styles.button_container}>\n\n    \n//     \t\t\t\t{isSaveButtonVisible && (\n//     \t\t\t\t<button\n//     \t\t\t\t\tclassName={`${styles.save_btn} ${styles.text_btn}`}\n//     \t\t\t\t\tonClick={handleSave}\n//     \t\t\t\t\tdisabled={isLoading}\n//     \t\t\t\t>\n//     \t\t\t\t\tSave\n//     \t\t\t\t</button>\n//     \t\t\t\t)}\n    \n//     \t\t\t\t{!isEditable && (\n//     \t\t\t\t\t<button\n//     \t\t\t\t\tclassName={`${styles.edit_btn} ${styles.text_btn}`}\n//     \t\t\t\t\tonClick={handleEdit}\n//     \t\t\t\t\t>\n//     \t\t\t\t\tEdit\n//     \t\t\t\t\t</button>\n//     \t\t\t\t)}\n//     \t\t\t\t</div>\n//           {/* Survey Prompt */}\n//     \t  {showSurveyPrompt && (\n//                   <div className={styles.survey_prompt}>\n//                     <p>\n//                       Please take the survey to help us improve {\" \"}\n//                       <button\n//                         className={styles.link_btn}\n//                         onClick={() =>\n//                           navigate(\"/survey\", {\n//                             state: { email: JSON.parse(localStorage.getItem(\"user\")).email, inputText },\n//                           })\n//                         }\n//                       >\n//                         Take the Survey\n//                       </button>\n//                     </p>\n//                   </div>\n//                 )}\n    \n\n\n\n//         </div>\n//       </div>\n//     </>\n//   );\n// };\n\n// export default Review;\n\n\n// import React from \"react\";\n// import { useState, useEffect, useRef } from \"react\";\n// import { useLocation, useNavigate } from \"react-router-dom\";\n// import DiffMatchPatch from \"diff-match-patch\";\n// import styles from \"./styles.module.css\";\n\n// const Review = () => {\n//   const { state } = useLocation();\n//   const { inputText, outputText: initialOutputText } = state || {\n//     inputText: \"\",\n//     outputText: \"\",\n//   };\n//   const [outputText, setOutputText] = useState(initialOutputText);\n//   const [diffHtml, setDiffHtml] = useState(\"\"); // State for storing diff HTML\n//   const [isEditable, setIsEditable] = useState(false);\n//   const [editHistory, setEditHistory] = useState([]); // Array to store edit history\n//   const [isHistoryVisible, setIsHistoryVisible] = useState(false); // Show/Hide history sidebar\n//   const navigate = useNavigate();\n//   const contentEditableRef = useRef(null); // Reference to the contentEditable div\n\n// \tconst [isLoading, setIsLoading] = useState(false);\n\n// \tconst [isSaveButtonVisible, setIsSaveButtonVisible] = useState(true);\n// \tconst [showSurveyPrompt, setShowSurveyPrompt] = useState(false); // State for survey prompt\n\n\n\n//   // Function to calculate and render diff\n//   const generateDiff = (input, output) => {\n//     const dmp = new DiffMatchPatch();\n//     const diffs = dmp.diff_main(input, output);\n//     dmp.diff_cleanupSemantic(diffs); // Optional cleanup for better readability\n//     return dmp.diff_prettyHtml(diffs); // Generate diff HTML\n\t\n//   };\n\n\n  \n\n//   // Effect to calculate diff whenever text changes\n//   useEffect(() => {\n//     const diffResult = generateDiff(inputText, outputText);\n//     setDiffHtml(diffResult);\n//   }, [inputText, outputText]);\n\n//   const handleLogout = () => {\n//     localStorage.removeItem(\"token\");\n//     window.location.reload();\n//   };\n\n//   \tconst handleSave = async (isAuto = false) => {\n// //\t\tsetIsSaveButtonVisible(false);\n// if (isAuto && isAuto.nativeEvent) {\n// \tisAuto = false; // Default behavior if called by an event\n// }\n\n\t\t  \n// \t\ttry {\n// \t\t  const user = JSON.parse(localStorage.getItem(\"user\")); // Retrieve user info\n// \t\t  if (!user) {\n// \t\t\talert(\"User not logged in!\");\n// \t\t\treturn;\n// \t\t  }\n\t  \n// \t\t  const payload = {\n// \t\t\tuserId: user._id,\n// \t\t\temail: user.email,\n// \t\t\tinputText,\n// \t\t\t...(isEditable ? { editedText: outputText } : { outputText, editableText: outputText }),\n// \t\t  };\n\t  \n// \t\t  const endpoint = isEditable\n// \t\t\t? \"https://textsimplification-eecqhvdcduczf8cz.westus-01.azurewebsites.net/api/simplifications/edit\" // Endpoint for updating\n// \t\t\t: \"https://textsimplification-eecqhvdcduczf8cz.westus-01.azurewebsites.net/api/simplifications\"; // Endpoint for initial save\n\t  \n// \t\t  const method = isEditable ? \"PUT\" : \"POST\"; // Use PUT for updates, POST for saves\n\t  \n// \t\t  const response = await fetch(endpoint, {\n// \t\t\tmethod,\n// \t\t\theaders: { \"Content-Type\": \"application/json\" },\n// \t\t\tbody: JSON.stringify(payload),\n// \t\t  });\n\t  \n// \t\t  if (response.ok) {\n// \t\t\tconst data = await response.json();\n            \n// \t\t\talert(isEditable ? \"Edited text saved successfully!\" : \"Simplification saved successfully!\");\n\n// \t\t\t//setShowSurveyPrompt(true); \n// \t\t\tconsole.log(\"isSaveButtonVisible\", isSaveButtonVisible);\n// \t\t\tconsole.log(\"isEditable\", isEditable);\n// \t\t\tconsole.log(\"isAuto\", isAuto);\n// \t\t\tif (!isSaveButtonVisible) {  //edit, save, edit\n// \t\t\t\tsetShowSurveyPrompt(false); // Show the survey prompt\n// \t\t\t  }\n// \t\t\telse if (isSaveButtonVisible && !isEditable && isAuto)  //true false -- first time save or edit button clicked\n// \t\t\t{\n// \t\t\t\tsetShowSurveyPrompt(false);\n// \t\t\t}\n// \t\t\telse if (isSaveButtonVisible && isEditable)\n// \t\t\t{\n// \t\t\t\tsetShowSurveyPrompt(true);\n// \t\t\t} \n// \t\t\telse if (isSaveButtonVisible && !isEditable && !isAuto)  //true false -- first time save or edit button clicked\n// \t\t\t{\n// \t\t\t\tsetShowSurveyPrompt(true);\n// \t\t\t}\n\n// \t\t\tsetEditHistory((prev) => [\n// \t\t\t\t...prev,\n// \t\t\t\t{ timestamp: new Date().toLocaleString(), text: outputText },\n// \t\t\t  ]);\n\n// \t\t\tif (isEditable) {\n// \t\t\t {\n// \t\t\t\tsetIsEditable(false); // Exit editing mode after saving edits\n// \t\t\t  // disable saving button\n// \t\t\t  setIsSaveButtonVisible(false); // Hide the save button\n// \t\t\t   // Show the survey prompt\n// \t\t\t // setShowSurveyPrompt(true); \n// \t\t\t }\n\n\n// \t\t  }} else {\n// \t\t\tconst error = await response.json();\n// \t\t\talert(error.message || \"Failed to save simplification.\");\n// \t\t  }\n// \t\t} catch (error) {\n// \t\t  console.error(\"Error saving simplification:\", error);\n// \t\t  alert(\"An error occurred. Please try again.\");\n// \t\t}\n\n// \t  };\n\n// \t  const handleHistoryClick = (edit) => {\n// \t\tsetOutputText(edit.text);\n// \t\tconst diffResult = generateDiff(inputText, edit.text);\n// \t\tsetDiffHtml(diffResult);\n// \t\tsetIsEditable(false);\n// \t  };\n\n// \tconst handleEdit = () => {\n// \t  let isAuto = true;\n// \t  handleSave(isAuto); // Save the current output text\n// \t  setIsEditable(true); // Enable editing mode\n// \t  setIsSaveButtonVisible(true);\n\n// \t};\n  \n//   return (\n//     <>\n//       <nav className={styles.navbar}>\n//         <h1>Text Simplification Study</h1>\n//         <button className={styles.white_btn} onClick={handleLogout}>\n//           Logout\n//         </button>\n//       </nav>\n\n//       <div className={styles.main_container}>\n//         <div className={styles.description}>\n//           <p>\n//             Review the generated output and make any necessary edits. Changes\n//             are highlighted in real-time for easy visualization.\n//           </p>\n\n//       {/* Sidebar */}\n//       <div className={styles.sidebar}>\n//         <button\n//           className={styles.historyIcon}\n//           onClick={() => setIsHistoryVisible(!isHistoryVisible)}\n//         >\n//           🕒 {/* History Icon */}\n//         </button>\n//         {isHistoryVisible && (\n//           <div className={styles.historyPanel}>\n//             <h3>Edit History</h3>\n//             <ul className={styles.historyList}>\n//               {editHistory.map((edit, index) => (\n//                 <li\n//                   key={index}\n//                   className={styles.historyItem}\n//                   onClick={() => handleHistoryClick(edit)}\n//                 >\n//                   {edit.timestamp}\n//                 </li>\n//               ))}\n//             </ul>\n//           </div>\n//         )}\n//       </div>\n\n//           <div className={styles.form_container}>\n//             {/* Input and Diff Boxes */}\n//             <div className={styles.textareas_container}>\n//               {/* Input Text Box */}\n//               <div className={styles.text_container}>\n//                 <label className={styles.label} htmlFor=\"inputText\">\n//                   Input Text\n//                 </label>\n//                 <textarea\n//                   id=\"inputText\"\n//                   className={`${styles.textarea} ${styles.side_by_side}`}\n//                   value={inputText}\n//                   readOnly\n//                 ></textarea>\n//               </div>\n// <div className={styles.text_container}>\n//   <label className={styles.label} htmlFor=\"outputText\">\n//     System-generated Text\n//   </label>\n\n// {isEditable ? (\n//     <>\n//       <textarea\n//         id=\"outputText\"\n//         className={`${styles.textarea} ${styles.side_by_side}`}\n//         value={outputText}\n//         onChange={(e) => {\n//           const updatedText = e.target.value;\n//           setOutputText(updatedText); // Update the output text state\n//           const updatedDiff = generateDiff(inputText, updatedText); // Recalculate the diff\n//           setDiffHtml(updatedDiff); // Update the diff HTML in real-time\n\t\t\n//         }}\n//         placeholder=\"Output\"\n//       ></textarea>\n\n//     </>\n//   ) : (\n//     <div\n//       id=\"diffText\"\n//       className={`${styles.output_box} ${styles.side_by_side}`}\n//       dangerouslySetInnerHTML={{ __html: diffHtml }}\n//     ></div>\n//   )} \n// </div>\n\n\n\n\n//             </div>\n\n\n//     \t\t\t\t<div className={styles.button_container}>\n\n    \n//     \t\t\t\t{isSaveButtonVisible && (\n//     \t\t\t\t<button\n//     \t\t\t\t\tclassName={`${styles.save_btn} ${styles.text_btn}`}\n//     \t\t\t\t\tonClick={handleSave}\n//     \t\t\t\t\tdisabled={isLoading}\n//     \t\t\t\t>\n//     \t\t\t\t\tSave\n//     \t\t\t\t</button>\n//     \t\t\t\t)}\n    \n//     \t\t\t\t{!isEditable && (\n//     \t\t\t\t\t<button\n//     \t\t\t\t\tclassName={`${styles.edit_btn} ${styles.text_btn}`}\n//     \t\t\t\t\tonClick={handleEdit}\n//     \t\t\t\t\t>\n//     \t\t\t\t\tEdit\n//     \t\t\t\t\t</button>\n//     \t\t\t\t)}\n//     \t\t\t\t</div>\n//           {/* Survey Prompt */}\n//     \t  {showSurveyPrompt && (\n//                   <div className={styles.survey_prompt}>\n//                     <p>\n//                       Please take the survey to help us improve {\" \"}\n//                       <button\n//                         className={styles.link_btn}\n//                         onClick={() =>\n//                           navigate(\"/survey\", {\n//                             state: { email: JSON.parse(localStorage.getItem(\"user\")).email, inputText },\n//                           })\n//                         }\n//                       >\n//                         Take the Survey\n//                       </button>\n//                     </p>\n//                   </div>\n//                 )}\n    \n//     \t\t\t</div>\n\n//     \t\t</div> \n//     \t\t</div>\n//     \t  </>\n//   );\n// };\n\n\n// export default Review;\n\n{/* \n\t\t\t  <div className={styles.text_container}>\n  <label className={styles.label} htmlFor=\"outputText\">\n    System-generated Text\n  </label>\n  {isEditable ? (\n    <textarea\n      id=\"outputText\"\n      className={`${styles.textarea} ${styles.side_by_side}`}\n      value={outputText}\n      onChange={(e) => setOutputText(e.target.value)} // Handle user edits\n      placeholder=\"Output\"\n    ></textarea>\n  ) : (\n    <div\n      id=\"diffText\"\n      className={`${styles.output_box} ${styles.side_by_side}`}\n      dangerouslySetInnerHTML={{ __html: diffHtml }}\n    ></div>\n  )}\n</div> */}\n\n\n\n// import React from \"react\";\n// import { useState, useEffect } from \"react\";\n// import { useLocation, useNavigate } from \"react-router-dom\";\n// import DiffMatchPatch from \"diff-match-patch\";\n// import styles from \"./styles.module.css\";\n\n// const Review = () => {\n//   const { state } = useLocation();\n// //   const { inputText, outputText } = state || { inputText: \"\", outputText: \"\" };\n// //   const navigate = useNavigate();\n// const { inputText, outputText: initialOutputText } = state || {\n//     inputText: \"\",\n//     outputText: \"\",\n//   };\n//   const [outputText, setOutputText] = useState(initialOutputText);\n// \tconst [isLoading, setIsLoading] = useState(false);\n// \tconst [isEditable, setIsEditable] = useState(false); // For toggling edit mode\n// \tconst [diffHtml, setDiffHtml] = useState(\"\"); \n// \tconst [isSaveButtonVisible, setIsSaveButtonVisible] = useState(true);\n// \tconst [showSurveyPrompt, setShowSurveyPrompt] = useState(false); // State for survey prompt\n//     const navigate = useNavigate();\n\n// \tconst handleLogout = () => {\n// \t  localStorage.removeItem(\"token\");\n// \t  window.location.reload();\n// \t};\n\n// \t// Function to calculate and render diff\n// \tconst generateDiff = (input, output) => {\n// \tconst dmp = new DiffMatchPatch();\n// \tconst diffs = dmp.diff_main(input, output);\n// \tdmp.diff_cleanupSemantic(diffs); // Optional cleanup for better readability\n// \treturn dmp.diff_prettyHtml(diffs); // Generate diff HTML\n// \t};\n\n// \t// Effect to calculate diff whenever text changes\n// \tuseEffect(() => {\n// \tconst diffResult = generateDiff(inputText, outputText);\n// \tsetDiffHtml(diffResult);\n// \t}, [inputText, outputText]);\n\t\n\n\n//   \tconst handleSave = async (isAuto = false) => {\n// //\t\tsetIsSaveButtonVisible(false);\n// if (isAuto && isAuto.nativeEvent) {\n// \tisAuto = false; // Default behavior if called by an event\n// }\n\n\t\t  \n// \t\ttry {\n// \t\t  const user = JSON.parse(localStorage.getItem(\"user\")); // Retrieve user info\n// \t\t  if (!user) {\n// \t\t\talert(\"User not logged in!\");\n// \t\t\treturn;\n// \t\t  }\n\t  \n// \t\t  const payload = {\n// \t\t\tuserId: user._id,\n// \t\t\temail: user.email,\n// \t\t\tinputText,\n// \t\t\t...(isEditable ? { editedText: outputText } : { outputText, editableText: outputText }),\n// \t\t  };\n\t  \n// \t\t  const endpoint = isEditable\n// \t\t\t? \"https://textsimplification-eecqhvdcduczf8cz.westus-01.azurewebsites.net/api/simplifications/edit\" // Endpoint for updating\n// \t\t\t: \"https://textsimplification-eecqhvdcduczf8cz.westus-01.azurewebsites.net/api/simplifications\"; // Endpoint for initial save\n\t  \n// \t\t  const method = isEditable ? \"PUT\" : \"POST\"; // Use PUT for updates, POST for saves\n\t  \n// \t\t  const response = await fetch(endpoint, {\n// \t\t\tmethod,\n// \t\t\theaders: { \"Content-Type\": \"application/json\" },\n// \t\t\tbody: JSON.stringify(payload),\n// \t\t  });\n\t  \n// \t\t  if (response.ok) {\n// \t\t\tconst data = await response.json();\n            \n// \t\t\talert(isEditable ? \"Edited text saved successfully!\" : \"Simplification saved successfully!\");\n\n// \t\t\t//setShowSurveyPrompt(true); \n// \t\t\tconsole.log(\"isSaveButtonVisible\", isSaveButtonVisible);\n// \t\t\tconsole.log(\"isEditable\", isEditable);\n// \t\t\tconsole.log(\"isAuto\", isAuto);\n// \t\t\tif (!isSaveButtonVisible) {  //edit, save, edit\n// \t\t\t\tsetShowSurveyPrompt(false); // Show the survey prompt\n// \t\t\t  }\n// \t\t\telse if (isSaveButtonVisible && !isEditable && isAuto)  //true false -- first time save or edit button clicked\n// \t\t\t{\n// \t\t\t\tsetShowSurveyPrompt(false);\n// \t\t\t}\n// \t\t\telse if (isSaveButtonVisible && isEditable)\n// \t\t\t{\n// \t\t\t\tsetShowSurveyPrompt(true);\n// \t\t\t} \n// \t\t\telse if (isSaveButtonVisible && !isEditable && !isAuto)  //true false -- first time save or edit button clicked\n// \t\t\t{\n// \t\t\t\tsetShowSurveyPrompt(true);\n// \t\t\t}\n\n\n// \t\t\tif (isEditable) {\n// \t\t\t {\n// \t\t\t\tsetIsEditable(false); // Exit editing mode after saving edits\n// \t\t\t  // disable saving button\n// \t\t\t  setIsSaveButtonVisible(false); // Hide the save button\n// \t\t\t   // Show the survey prompt\n// \t\t\t // setShowSurveyPrompt(true); \n// \t\t\t }\n// \t\t  }} else {\n// \t\t\tconst error = await response.json();\n// \t\t\talert(error.message || \"Failed to save simplification.\");\n// \t\t  }\n// \t\t} catch (error) {\n// \t\t  console.error(\"Error saving simplification:\", error);\n// \t\t  alert(\"An error occurred. Please try again.\");\n// \t\t}\n\n// \t  };\n\t  \n\t\n  \n// \tconst handleEdit = () => {\n// \t  let isAuto = true;\n// \t  handleSave(isAuto); // Save the current output text\n// \t  setIsEditable(true); // Enable editing mode\n// \t  setIsSaveButtonVisible(true);\n\n// \t  //navigate(\"/edit\"); // Navigate to edit page\n\n// \t  //setShowSurveyPrompt(false);\n\n// \t  // Add back button\n// \t};\n  \n//   return (\n//     <>\n//     <nav className={styles.navbar}>\n//       <h1>Text Simplification Study</h1>\n//       <button className={styles.white_btn} onClick={handleLogout}>\n//         Logout\n//       </button>\n//     </nav>\n\n//     <div className={styles.main_container}>\n//         <div className={styles.description}>\n// \t\t\t  <p>\n// \t\t\t\tReview the generated output and make any necessary edits. Click the \"Edit\" button to make changes to the text. Once you are satisfied with the text, click the \"Save\" button to save your changes.\n// \t\t\t  </p>\n\t\t\t\n//             <br></br>\n            \n//      \t\t\t<div className={styles.form_container}>\n//      \t\t\t  {/* Input and Output Boxes */}\n//      \t\t\t  <div className={styles.textareas_container}>\n//      \t\t\t\t{/* Input Text Box */}\n//      \t\t\t\t<div className={styles.text_container}>\n//      \t\t\t\t  <label className={styles.label} htmlFor=\"inputText\">\n//      \t\t\t\t\tInput Text\n//      \t\t\t\t  </label>\n//     \t\t\t\t  <textarea\n//     \t\t\t\t\tid=\"inputText\"\n//     \t\t\t\t\tclassName={`${styles.textarea} ${styles.side_by_side}`}\n//     \t\t\t\t\tvalue={inputText}\n//     \t\t\t\t\t//onChange={(e) => setInputText(e.target.value)}\n//     \t\t\t\t\treadOnly\n//     \t\t\t\t  ></textarea>\n//     \t\t\t\t</div>\n      \n//     \t\t\t\t{/* Output Text Box */}\n//     \t\t\t\t<div className={styles.text_container}>\n//     \t\t\t\t  <label className={styles.label} htmlFor=\"diffText\">\n//     \t\t\t\t\tSystem-generated Text\n//     \t\t\t\t  </label>\n//     \t\t\t\t  <textarea\n//     \t\t\t\t\tid=\"diffText\"\n//     \t\t\t\t\tclassName={`${styles.output_box} ${styles.side_by_side}`}\n//     \t\t\t\t\tvalue={outputText}\n//     \t\t\t\t\tonChange={(e) => setOutputText(e.target.value)}\n// \t\t\t\t\t\tdangerouslySetInnerHTML={{ __html: diffHtml }}\n//     \t\t\t\t\treadOnly={!isEditable}\n//     \t\t\t\t\tplaceholder=\"Output\"\n//     \t\t\t\t  ></textarea>\n//     \t\t\t\t</div>\n\n//     \t\t\t  </div>\n    \n    \n//     \t\t\t\t{/* Save and Edit Buttons */}\n//     \t\t\t\t<div className={styles.button_container}>\n\n    \n//     \t\t\t\t{isSaveButtonVisible && (\n//     \t\t\t\t<button\n//     \t\t\t\t\tclassName={`${styles.save_btn} ${styles.text_btn}`}\n//     \t\t\t\t\tonClick={handleSave}\n//     \t\t\t\t\tdisabled={isLoading}\n//     \t\t\t\t>\n//     \t\t\t\t\tSave\n//     \t\t\t\t</button>\n//     \t\t\t\t)}\n    \n//     \t\t\t\t{!isEditable && (\n//     \t\t\t\t\t<button\n//     \t\t\t\t\tclassName={`${styles.edit_btn} ${styles.text_btn}`}\n//     \t\t\t\t\tonClick={handleEdit}\n//     \t\t\t\t\t>\n//     \t\t\t\t\tEdit\n//     \t\t\t\t\t</button>\n//     \t\t\t\t)}\n//     \t\t\t\t</div>\n//           {/* Survey Prompt */}\n//     \t  {showSurveyPrompt && (\n//                   <div className={styles.survey_prompt}>\n//                     <p>\n//                       Please take the survey to help us improve {\" \"}\n//                       <button\n//                         className={styles.link_btn}\n//                         onClick={() =>\n//                           navigate(\"/survey\", {\n//                             state: { email: JSON.parse(localStorage.getItem(\"user\")).email, inputText },\n//                           })\n//                         }\n//                       >\n//                         Take the Survey\n//                       </button>\n//                     </p>\n//                   </div>\n//                 )}\n    \n//     \t\t\t</div>\n//     \t\t</div> \n//     \t\t</div>\n//     \t  </>\n//   );\n// };\n\n// export default Review;"],"mappings":"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KAAA,MAAGsI,SAAS,CAAE1I,MAAM,CAACyL,WAAY,CAAAhD,QAAA,EAAC,4CAEhC,cAAAvI,IAAA,WACEwI,SAAS,CAAE1I,MAAM,CAAC0L,UAAW,CAC7B9C,OAAO,CAAEA,CAAA,GAAM,CACb,KAAM,CAAArB,eAAe,CAAG,CAAE9G,SAAS,CAAEC,UAAU,CAAEE,WAAY,CAAC,CAC9DiC,YAAY,CAAC2E,OAAO,CAAC,iBAAiB,CAAEtD,IAAI,CAACQ,SAAS,CAAC6C,eAAe,CAAC,CAAC,CACxEnG,QAAQ,CAAC,SAAS,CAAE,CAClBZ,KAAK,CAAE,CACLsF,KAAK,CAAE5B,IAAI,CAACC,KAAK,CAACtB,YAAY,CAACuB,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC0B,KAAK,CACrDrF,SAAS,CACTC,UAAU,CACVE,WACF,CACF,CAAC,CAAC,CACJ,CAAE,CAAA6H,QAAA,CACH,8BAED,CAAQ,CAAC,EACR,CAAC,CACD,CACN,EAIU,CAAC,EACH,CAAC,EACN,CAAC,CAEP,CAAC,CAED,cAAe,CAAAlI,MAAM,CAIrB;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAGA;AACA;AAEA;AAEA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAIA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAKA;AACA;AACA;AACA;AACA;AAEA;AAGA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AAEA;AAKA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAKA;AAGA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAGA;AAEA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SApBC,CAwBD;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAIA;AACA;AACA;AACA;AACA;AAEA;AAEA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAGA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}